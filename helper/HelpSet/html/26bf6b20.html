<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" href="style.css" type="text/css"></link>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="date" content="20181124222015" />
<!-- created with HelpSetMaker, ID=26bf6b20 -->
<title>Samples</title>
</head>
<body class="doc">
<h1>Samples</h1>

<p>Samples and sample playing code is generated in vedi, using the popup on the project file tree. By chosing the entry "build vectrex samples" the dialog for sample generation is displayed. (see also the vedi&rarr;Samples documentation)</p>
<br/><p align="center">
<img src="pics/SampleCodeGen0.png" width="303" height="362" /><br/>
<em>build samples in vedi</em></p><br/>
<br/><p align="center">
<img src="pics/SampleCodeGen1.png" width="639" height="653" /><br/>
<em>samples dialog</em></p><br/>

<p>Exiting the above dialog with "create source" will (...hm...) create sources in the current project directory. <br />
(After asking for a name for the file which is to be generated. In the following it is assumed that the name given is <tt>"TestSample"</tt>.) <br />
The generated sources are accompanied by an example player program. </p>

<p>Following sources are generated:
<ul><li>
<p><tt>digitalPlayer.i</tt><br />
the subroutines which do the actual playing of samples</p>
</li><li>
<p><tt>VECTREX.I</tt> <br />
which is needed by the player</p>
</li><li>
<p><tt>TestSample.asm</tt><br />
a file with the actual sample data </p>
</li><li>
<p><tt>TestSampleMain.asm</tt><br />
a "main" file, with an example vectrex runnable "cartridge" file</p>
</li></ul>
</p>

<p>A vectrex playable binary file can be generated by setting the generate SampleMain file as the main file in the project.</p>
<br/><p align="center">
<img src="pics/SampleCodeGen2.png" width="371" height="407" /><br/>
<em>set example player as main</em></p><br/>

<p>The format and the actual play routines are documented in the source code. Just a few bullet points...
<ul><li>
<p>the provided sample player routines do not use the PSG chip</p>
</li><li>
<p>the digital audio data is send through the DAC, the resulting analog voltages are transfered by the correct MUX settings directly to the sound hardware</p>
</li><li>
<p>playing samples this way on (what I think) new vectri (3rd generation) results in very low volumes, this seems to be hardware related</p>
</li><li>
<p>the provided sample routines play the data backwards</p>
</li><li>
<p>the sample "generator" can build samples in different sample rates. The higher the sample rate the better the quality. The higher the sample rate, the more memory is used. The higher the sample rate, the more cycles the player routines must use. So - you have to experiment yourself what is your threshold for quality.</p>
</li><li>
<p>the provided sample routines are "general" if you plan to do your own game with samples, you probably should fit them to your specific needs.</p>
</li><li>
<p>the general idea is, that you have to feed the audio hardware with samples in respect to the current sample rate (you get the idea, sample rate of 5000 &rarr; you have to update the audio hardware 5000 times per second)</p>
</li><li>
<p>the best quality is provided if your routines concentrate only on feeding the audio hardware</p>
</li><li>
<p>but: most of the time you also want to draw something<br />
some routines are provided (String printing, and vectorlist drawings) which also do screen updates and (roughly) update the audio hardware in time</p>
</li><li>
<p>this updating - depending on the stuff that is written or drawn - does not always come "in time" for that reason the quality is not "perfect", but most of the time at least "ok"</p>
</li></ul>
</p>

<p>Provided subroutines, that also play sample data "in between" when needed:<br />
<tt>
<ul><li>
<p>wait_recal_digitj </p>
</li><li>
<p>intensity_a_digitj</p>
</li><li>
<p>move_to&nbsp;d_digitj</p>
</li><li>
<p>draw_vlc_digitj</p>
</li><li>
<p>Print_Str_digit</p>
</li></ul>
</tt></p>

<p>The sample generator generates:</p>

<p><i>Data - <tt>TestSample.asm</tt></i><br />

<ul><li>
<p>the data of the sample (backwards) and labels for the data<br />
LabelNames: <tt>TestSample_data, TestSample_data_start, TestSample_data_end</tt></p>
</li><li>
<p>a memory word location with the length of the sample<br />
LabelName: <tt>TestSample_length</tt></p>
</li><li>
<p>a constant which defines the sample rate:<br />
ConstantName: <tt>TESTSAMPLE_SAMPLERATE</tt></p>
</li></ul>
</p>

<p><i>Subroutines - <tt>digitalPlayer.i</tt></i><br />

<ul><li>
<p>this file contains above mentioned routines</p>
</li><li>
<p>also included are macro definitions and calculations in respect to the sample rate of the data</p>
</li><li>
<p>in the file there are also RAM locations used, for the default example these start at $c880. 12 bytes are needed. You can easily change these values - see top of the file.</p>
</li><li>
<p>sample setup is done by the subroutine, <tt>init_digit_sound</tt> with parameters D = sample start, and X pointer to sample length</p>
</li><li>
<p>subsequent calling of any of the <tt>"..._digit"</tt> functions plays the sample</p>
</li><li>
<p>there is one other flag that can be set: &rarr; the RAM location <tt>digit_looping</tt> if set to 1 than the sample will be looped, if 0 than not</p>
</li></ul>
</p>

<p><i>Example - <tt>TestSampleMain.asm</tt></i><br />

<ul><li>
<p>this is the main program, that can be assembled to a vectrex binary</p>
</li><li>
<p>this is pretty straight forward - just read it...</p>
</li></ul>
</p>

<p>(not further mentioned, but also generated: "VECTREX.I")</p>
<br/><p align="center">
<img src="pics/SampleCodeGen3.png" width="795" height="495" /><br/>
<em>sample data that is generated</em></p><br/>
<br/><p align="center">
<img src="pics/SampleCodeGen4.png" width="401" height="505" /><br/>
<em>example that is generated (sample is looping)</em></p><br/>
<br/><p align="center">
<img src="pics/SampleCodeGen5.png" width="840" height="1048" /><br/>
<em>start of digitalPlayer.i</em></p><br/>
</body>
</html>
