<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'></meta>
<title>VIDE</title>
<link rel="stylesheet" href="style.css" type="text/css"></link>
</head>
<body>
<hr />
<h1>VIDE</h1>
<br/><p align="center">
<img src="pics/VideNameNormal.png" width="546" height="250" /><br/>
<em>Vide</em></p><br/>

<p>Vide is a collection of different sources - and some new creations - in a single application.<br />
It is a <b>V</b>ectrex <b>I</b>ntegrated <b>D</b>evelopement <b>E</b>nvironment.</p>

<p>I do not intend to make VIDE an "emulator of choice".</p>

<p>It will not be as pretty as ParaJVE, it will not be as fast as VecX and it won't be as "elegant" as the MAME/MESS emulation.</p>

<p>I am a pragmatic guy not one for beauty or aesthetics.</p>
<hr />
<h1>Thanks!</h1>

<p>Vide is a collection of different sources - and some new creations - in a single application. It is a <b>V</b>ectrex <b>I</b>ntegrated <b>D</b>evelopement <b>E</b>nvironment.</p>

<p>It as of now consists of:
<ul><li>
<p>a java port of the vecx emulator (by me - Malban)<br />
The port is a port of a port and reaches back to the original author: <i>Valavan Manohararajah</i> of whom I can't find a valid homepage. Copyright status to me unkown, but as often as that code was used, I guess it is "freely distributable".<br />
 <br />
The port also has some enhancements, as you will notice.<br />
 <br />
This part will be called <b>vecxi</b> further on.<br />
 <br />
</p>
</li><li>
<p>a java port (by me - Malban) (or should I say a complete rewrite? - not much of the original code is left) of DASM6809, which I am sure also is a port of a port of a rewrite. Originally developed by <i>Sean Riddle</i>, Copyright (c)1995 Sean Riddle (freely distributable... see source files).<br />
 <br />
  The port also has some enhancements/changes, as you will notice.<br />
 <br />
This part will be called <b>dissi</b> further on.<br />
 <br />
 </p>
</li><li>
<p>a code adaption of a java 6809 assembler called "asmj".<br />
 (sourceforge: <a target="_blank" href="http://sourceforge.net/projects/asmj/">http://sourceforge.net/projects/asmj/</a>) developed by <i>Bill Yakowenko</i>. <br />
The sources in the sourceforge zip, the svn version and the binaries are not complete nor compatible. I tried reaching out to the author, but have received no feedback yet. I fixed the part I am interested in - so that it works for me. The source is public domain. <br />
 <br />
This part will be called <b>assi</b> further on.<br />
 <br />
 </p>
</li><li>
<p>a set of editor classes, done by me. Syntax highlighting uses a modified version of "Syntax", a package done by (c) <i>Stephen Ostermiller</i> (<a target="_blank" href="http://ostermiller.org/syntax/">http://ostermiller.org/syntax/</a> ), the source is distributed under GNU V2 or later license (... see source files). M6809 Syntax JFlexed by me - Malban.  <br />
 <br />
This part will be called <b>vedi</b> further on.<br />
 <br />
 </p>
</li><li>
<p>a set of vector editor classes, done by me. Hm... didn't really reuse any other software here... something is wrong. <br />
 <br />
This part will be called <b>vecci</b> further on.<br />
 <br />
 </p>
</li><li>
<p>and many small utilities that may or may not make the live of a vectrex developer more easy.</p>
</li></ul>
</p>

<p>The icons on display are taken from "famfamfam.com" a website of Mark James, a web developer from Birmingham, UK. <br />
<a target="_blank" href="http://www.famfamfam.com/lab/icons/silk/">http://www.famfamfam.com/lab/icons/silk/</a><br />
<br />
The icons can also be used under Creative Commons Attribution 3.0 License (Hi Debian folks!) with the following requirements:</p>

<div class="gray">
<p>As an author, I would appreciate a reference to my authorship of the Silk icon set contents within a readme file or equivalent documentation for the software which includes the set or a subset of the icons contained within. </p>
</div>
<br />

<p>Thanks a lot Mark!</p>
<hr />
<h1>In general!</h1>

<p>The application "state" VIDE is in, is more or less persistent (if development keeps up).</p>

<p>As of now, VIDE remembers its open windows their size and their positions.</p>

<p>There are a few "main" windows and quite a few "child windows". Once any window is open - the gui makes no difference between main and child.</p>

<p>"My" difference between main- and child- windows is the place where they can be opened. Main Windows can be opened from the Menubar, there from the menu: "Tools":</p>
<br/><p align="center">
<img src="pics/menubar.png" width="234" height="189" /><br/>
<em>menubar</em></p><br/>

<p>All other (child) windows are opened from the "main" windows.</p>
<h3>Navigation</h3>

<ul><li>
<p>Each window is accessable (uniconify/bring to front), via the window menu</p>
</li><li>
<p>Using CTRL/TAB gives access to a "quick" Window switcher</p>
</li><li>
<p>Windows can be iconified to the desktop</p>
</li><li>
<p>Thru tinylaf, themes are supported</p>
</li></ul>
<hr />
<h1>Starter</h1>
<br/><p align="center">
<img src="pics/starter.png" width="1045" height="836" /><br/>
<em>Starter window</em></p><br/>

<p>Here all configured cartridges are listed (along with their properties). The starter is split into two halfes, the upper part a list of all "games", and the lower half an information panel. The list has some "excel-qualities" you can filter/sort the list right mouseclick for a popup with other configurations and even export it to excel (or whatever your favourite table application may be).</p>

<p>A double click on a table entry starts the rom image behind the entry (or initiates a download first).</p>

<p>You can add/change entries for the starter using the "Cartridge Information" (utility).</p>
<hr />
<h1>vecxi</h1>
<br/><p align="center">
<img src="pics/vecxi.png" width="531" height="678" /><br/>
<em>vecxi emulation window</em></p><br/>

<p>Emulation wise this is the heart of VIDE.  In the above example you can see  Cleansweep running in the emulator.</p>

<p>The shown window is a preliminary version, I am sure the final output will be different!</p>

<p>In short: <br />

<ul><li>
<p><img src="pics/folder_go.png" alt="folder_go.png" /> <b>&nbsp;&nbsp;load</b><br />
 a new vectrex file (doesn't start the emulation)</p>
</li><li>
<p><img src="pics/control_play.png" alt="control_play.png" /> <b>&nbsp;&nbsp;start</b><br />
 running (if in debug mode, do a single step) (if SHIFT is held, it resets the current loaded rom)</p>
</li><li>
<p><img src="pics/control_pause.png" alt="control_pause.png" /> <b>&nbsp;&nbsp;pause</b><br />
</p>
</li><li>
<p><img src="pics/control_stop.png" alt="control_stop.png" /> <b>&nbsp;&nbsp;stop</b><br />
 (unloads the current rom)</p>
</li><li>
<p><b>load</b><br />
 well - load a state (only one savestate possible as of now)</p>
</li><li>
<p><b>save</b> <br />
 save a state</p>
</li></ul>
</p>

<p>Emulation and debugging wise, vecxi is the center of VIDE. Once you load a rom and start emulation, a "dissi" window will pop up (if not already open - or might "pop" into an iconified state).</p>

<p>From dissi you can access all other debugging utilities VIDE has to offer. . .</p>

<p>Some features:
<ul><li>
<p>If in debug mode, vecxi will display the "current" drawn vector in yellow, rather than white.</p>
</li><li>
<p>If in debug mode, vecxi will display the drawn vectors in the "current" refresh cycle in BRIGHTER white than "older" vectors.</p>
</li><li>
<p>vecxi can be told (mainly usable in debug mode, otherwise there is just a "blur") to draw a small circle at the current "integrator position", so you can follow the virtual beam</p>
</li><li>
<p>vecxi can be told to draw "arrows" rather than vectors, so you can see the direction of all vectors</p>
</li><li>
<p>and much more...</p>
</li><li>
<p>keyboard shortcuts:<br />
  "P" Pause/unpause<br />
  "O" Overlay/no Overlay (if available)</p>
</li></ul>
</p>
<hr />
<h1>dissi</h1>
<br/><p align="center">
<img src="pics/dissi.png" width="1549" height="665" /><br/>
<em>dissi window</em></p><br/>

<p>Dissi only shows sensible data that was <b>LOADED</b> from a file, dissi does <b>NOT</b> read data from the emulator, all addresses not loaded are marked as "unkown" and contain for the purpose of dissi only a "0" (null). That means it is not possible to look at RAM or IO locations and per default these are hidden from view! </p>
<h2>Disassembly in general</h2>

<p>If no help is given (in form of information, see below) dissi tries to disassemble the given file as follows:
<ul><li>
<p>it assumes the file is a valid vectrex file, meaning it searches the start of the file for a vectrex header:<br />

<ul><li>
<p>copyright string</p>
</li><li>
<p>music</p>
</li><li>
<p>text display list (with size and position information)</p>
</li><li>
<p>0 (zero)</p>
</li><li>
<p>assumes code therafter</p>
</li></ul>
</p>
</li><li>
<p>"assuming code therafter" in <i>general</i> is kind of difficult, because if data is encountered dissy tries to interprete data as code and that looks most of the time pretty silly - so please help dissi!</p>
</li><li>
<p>dissi allways tries to disassemble the file so that assi can compile the generated source code to be 100% the same binary as was given in the first place</p>
</li><li>
<p>for that at all to be possible (see bulletpoint 2) dissi even without help <i>must</i> generate data, because there are data bytes that have no representation as an assembler mnemonic, or a postbyte is illegal for a correct mnemonic</p>
</li><li>
<p>dissi generates DB data values for those occasions and provides a line comment for its reasoning</p>
</li><li>
<p>in general dissi would be grateful, if you discover "bunches" of such generated DB-Data, that you provide help and mark these ranges as DATA (which is just a drag, a click and another click to save them for next time)</p>
</li></ul>
</p>
<h2>Debugging using dissi</h2>

<p>Using vide there will only be one "instance" of dissi and its children be available - usually that will be "enough". In the seldom cases when it might be usefull [debugging link cable connected vectri] to debug two vecxi instances at the same time (in opposite to the non usefull cases, where the user just wants to play around) you can switch dissi from one vecxi to another vecxi by pressing the <img src="pics/bug_go.png" alt="bug_go.png" /> button on the <b>vecxi</b> instance. Pressing that button ensures that dissi is connected to THAT vecxi instance. Pressing the button also clears all breakpoints (only if dissi realy was connected to a different vecxi instance), after all - where should the debugging be done for a breakpoint - if there is no dissi anymore...</p>

<p><b>Buttons</b><br />
</p>

<p>For dissi and its "children" you can often find the following icon in the uper left corner:<br />
 <br />
<img src="pics/webcam.png" alt="webcam.png" />&nbsp;&nbsp;<b>always update</b><br />
 (that is a "switch" button!) which means the contents of this window will be updated "always". This mainly refers to when not in debug mode.  The term "always" is a bit misleading. Always here means after each "emulator call". This does not mean "after each emulated instruction". The later is only true, when in single step or continuous mode.  When the emulator is in "play" mode, each emulator call approximately emulates 30000 cycles worth of instructions. <br />
</p>

<p>Following buttons are available for dissi:</p>

<ul><li>
<p><img src="pics/bug_go.png" alt="bug_go.png" />&nbsp;&nbsp;<b>debug</b><br />
 start debuging (program halts for now), also opens a "regi" window</p>
</li><li>
<p><img src="pics/bullet_go.png" alt="bullet_go.png" />&nbsp;&nbsp;<b>single step</b><br />
 perform one single step, all output/status windows are updated</p>
</li><li>
<p><img src="pics/arrow_refresh.png" alt="arrow_refresh.png" />&nbsp;&nbsp;<b>overstep</b><br />
 the next "one time" breakpoint is set after the address of the next instruction. This means, the next instruction <b>is</b> emulated, and e.g. if that one is a JSR to some other place, that whole subroutine is executed and the program will be halted after returning.</p>
</li><li>
<p><img src="pics/arrow_out.png" alt="arrow_out.png" />&nbsp;&nbsp;<b>step out</b><br />
 if the program is performing a subroutine, the next "one time" breakpoint is set to the top most callstack address</p>
</li><li>
<p><img src="pics/stop.png" alt="stop.png" />&nbsp;&nbsp;<b>breakpoint</b><br />
 a breakpoint is set at the current selected address in "dissi".<br />
Breakpoints are ALWAYS active, even when not in debug mode!</p>
</li><li>
<p><img src="pics/arrow_rotate_clockwise.png" alt="arrow_rotate_clockwise.png" />&nbsp;&nbsp;<b>continuous single step</b><br />
 single step until breakpoint is hit, or the user interferes <br />
 <br />
</p>
</li><li>
<p><img src="pics/arrow_turn_left.png" alt="arrow_turn_left.png" />&nbsp;&nbsp;<b>undo</b><br />
 undo the last emulated instruction. Currently the undo-buffer is set to "2000", after that no undo is possible. This will be configurable at a later point.</p>
</li><li>
<p><img src="pics/arrow_turn_right.png" alt="arrow_turn_right.png" />&nbsp;&nbsp;<b>redo</b><br />
 the next "state" in the ringbuffer of undoable state is set. If I did everything correct, this should be exactly the same as performing a single step. Although, performing a "real" single step "resets" the redo "pointer". <br />
 <br />
</p>
</li><li>
<p><img src="pics/chart_curve_edit.png" alt="chart_curve_edit.png" />&nbsp;&nbsp;<b>tracki</b><br />
 opens a tracki window</p>
</li><li>
<p><img src="pics/monitor_add.png" alt="monitor_add.png" />&nbsp;&nbsp;<b>viai</b><br />
 open a monitor window for the 6522</p>
</li><li>
<p><img src="pics/application_view_list.png" alt="application_view_list.png" />&nbsp;&nbsp;<b>dumpi</b><br />
 opens a memory dump window</p>
</li><li>
<p><img src="pics/table_refresh.png" alt="table_refresh.png" />&nbsp;&nbsp;<b>vari</b><br />
 opens a variable listing window</p>
</li><li>
<p><img src="pics/table_relationship.png" alt="table_relationship.png" />&nbsp;&nbsp;<b>labi</b><br />
 opens a label listing window <br />
 </p>
</li><li>
<p><img src="pics/sound_add.png" alt="sound_add.png" />&nbsp;&nbsp;<b>ayi</b><br />
 opens an ayi window <br />
 </p>
</li><li>
<p><img src="pics/application_lightning.png" alt="application_lightning.png" />&nbsp;&nbsp;<b>breaki</b><br />
 opens a breaki window <br />
 <br />
</p>
</li><li>
<p><img src="pics/mouse_error.png" alt="mouse_error.png" />&nbsp;&nbsp;<b>vinfi</b><br />
 this will enable a mouse pointer in the emulation window. You can select any displayed vector and get information about it. Upon selecting a vector a "vinfi" window opens. <br />
 <br />
</p>
</li><li>
<p><img src="pics/page_save.png" alt="page_save.png" />&nbsp;&nbsp;<b> write file</b><br />
 This writes a source file of the current dissi contents to your hard drive. The file generated will save to the location the current bin file was loaded from and has a file extenstion of *.dasm.asm". <br />
Shift click will save a "clean" assembler file. Clean, as in no variables, defines, equ or whatever. Just plain assembler with lots of numbers! <br />
If the current cartridge has more than one bank, a file is generated for EACH bank.</p>
</li><li>
<p><img src="pics/page_code.png" alt="page_code.png" />&nbsp;&nbsp;<b> write cnt file</b><br />
  This writes the current collected or individually gained information of dissi to a cnt file (or more than one if banks are used). This is the only way to persist your comments and insights. Use it! <br />
</p>
</li><li>
<p><img src="pics/vectorCam.png" alt="vectorCam.png" />&nbsp;&nbsp;<b> save vector screenshot</b><br />
  Saves the current vectrex display as a vectorlist to use in vecci. <br />
<br />
</p>
</li><li>
<p><img src="pics/resultset_previous.png" alt="resultset_previous.png" /> <b>history back</b><br />
 Within dissi you can easily "jump" from one address to the next, dissi keeps a history of these "jumps", with these buttons you can navigate your history </p>
</li><li>
<p><img src="pics/resultset_next.png" alt="resultset_next.png" /> <b>history forward</b><br />
 ...</p>
</li></ul>
<h2>The table...</h2>

<p>The main part of "dissi" is occupied by a "memory" table. Each line represents one memory location of your vectrex. Per default unkown locations are hidden. Addresses which are "part of other" addresses are also per default hidden (both can be viewed toggling the two checkboxes in the upper right area). </p>

<p>It is worth mentioning, that if a dumpi window is displayed, and on dumpi the switches "data display" and "active" are activated, that each selection in dissi is also taken as selection in dumpi. This way you can select regions (vectorlists or bitmap data) also in dissi and use dumpi as a "preview" window for the selected data!</p>

<p>The columns of the table are more or less self explainatory, here some more information:<br />

<ul><li>
<p><b>Column 1 - Address</b><br />
This is the memory location where this line starts. Machine code instructions can occupy more than one memory location, as do "groups" of bytes, words or chars. Per default one group of such data is displayed per line. The next address will be the one <i>after</i> the grouped memory locations.<br />
SHIFT-mouse click opens dumpi at address.</p>
</li><li>
<p><b>Column 2 - Label</b><br />
This column contains all known labels for that address (group). If there is more than one label, they are seperated by a ":". Single click on a label cell, will hightlight the first label in the operand entry of the table. <br />
Labels can be edited! When you enter the editor, you see all labels for <i>exactly</i> the address of that line seperated by a ":" (in opposition to when you are not editing, than you can see all labels belonging to the corresponding instruction group of that address).
<ul><li>
<p>You can enter new labels, delete old ones as you like. </p>
</li><li>
<p>The disassembly after finishing editing the labels will change accordingly.</p>
</li><li>
<p>If you "delete" any of the old labels, the reference in the source will be replaced with the first label in the list. </p>
</li><li>
<p>Changing the order does not change references. </p>
</li><li>
<p>Adding a new first label does not change references.</p>
</li><li>
<p>deleting the last label will either replace the reference with the actuall address (or offset), or generate a new label on the fly (depending on dissi configuration settings)</p>
</li><li>
<p>there is no "syntax checking" on edited labels, if they contain spaces or otherwise "bad" characters, than "bad luck" if you want to assemble exported sources</p>
</li></ul>
</p>
</li><li>
<p><b>Column 3 - Content</b><br />
This is a hex-byte representation of this memory location (group)</p>
</li><li>
<p><b>Column 4 - Mnemonic</b><br />
A Mnemonic representation of the underlying manchine language instruction - or a pseudo opcode for data (DB, DW). Double click on an instruction will open a small help for the mnemonic (stay on top window).</p>
</li><li>
<p><b>Column 5 - Operand</b><br />
Underlying operand of the machine language instruction or a representation of data. <br />
If the operand represents a BIOS (Bruce Tomlin style) routine, you can double click the operand, and a small help (stay on top window) will be displayed.</p>
</li><li>
<p><b>Column 6 - Page</b><br />
one of four possible states:<br />
&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;- page 0 opcode<br />
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;- page 1 opcode<br />
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;- page 2 opcode<br />
&nbsp;&nbsp;&nbsp;-1&nbsp;&nbsp;&nbsp;&nbsp;- data<br />
</p>
</li><li>
<p><b>Column 7 - Cycles</b><br />
The number of cycles an instruction takes (or ??? for data)</p>
</li><li>
<p><b>Column 8 - Mode</b><br />
If the instruction has an "address mode", than it is listed here (empty otherwise). Possible states are:<br />
&nbsp;&nbsp;&nbsp;&nbsp;- immediate<br />
&nbsp;&nbsp;&nbsp;&nbsp;- direct<br />
&nbsp;&nbsp;&nbsp;&nbsp;- extended<br />
&nbsp;&nbsp;&nbsp;&nbsp;- indexed<br />
&nbsp;&nbsp;&nbsp;&nbsp;- relative<br />
&nbsp;&nbsp;&nbsp;&nbsp;- inherent<br />
</p>
</li><li>
<p><b>Column 9 - &rarr;Address</b><br />
  If column 9 was one of (direct, extended, relative) the resulting "target"-address is listed here. If the resulting address is a 16bit address, the tooltip will show the contents of that location. A double click on the address will move dissi to that location (8 bit addresses are interpreted as relative jumps, 16 bit addresses as absolut jumps). In many cases this convention makes sense - not in all. A SHIFT double click opens dumpi at that address location. </p>
</li><li>
<p><b>Column 10 - Type</b><br />
  The type of the memory location. Can be one of:<br />
&nbsp;&nbsp;&nbsp;&nbsp;- DB Char<br />
&nbsp;&nbsp;&nbsp;&nbsp;- DB Byte<br />
&nbsp;&nbsp;&nbsp;&nbsp;- DB Ptr<br />
&nbsp;&nbsp;&nbsp;&nbsp;- DB Word<br />
&nbsp;&nbsp;&nbsp;&nbsp;- INS 1<br />
&nbsp;&nbsp;&nbsp;&nbsp;- INS 2<br />
&nbsp;&nbsp;&nbsp;&nbsp;- INS 3<br />
&nbsp;&nbsp;&nbsp;&nbsp;- INS 4<br />
&nbsp;&nbsp;&nbsp;&nbsp;- INS 5<br />
&nbsp;&nbsp;&nbsp;&nbsp;- INSPart 2<br />
&nbsp;&nbsp;&nbsp;&nbsp;- INSPart 3<br />
&nbsp;&nbsp;&nbsp;&nbsp;- INSPart 4<br />
&nbsp;&nbsp;&nbsp;&nbsp;- INSPart 5<br />
</p>
</li><li>
<p><b>Column 11 - Length</b><br />
Length of the instruction in bytes - or the length of the grouped data in bytes.</p>
</li><li>
<p><b>Column 12 - Comments</b><br />
All comments belonging to the address. Seperate lines are seperated by ":". All comments are displayed by the tooltip! Comments can be edited - as labels only for <i>exactly</i> the address of the current row. </p>
</li><li>
<p><b>Column 13 - DP</b><br />
Guessed or set direct page register dissi thinks appropriate for that address. <i>This is not allways correct</i></p>
</li></ul>
</p>
<h3>Popup-Menu</h3>
<br/><p align="center">
<img src="pics/dissi2.png" width="252" height="241" /><br/>
<em>popup window</em></p><br/>

<p>Selecting rows in dissi enables you to change the "display" of the data on the fly. Right clicking opens a popup. Selecting the menuitems applies the selected entry to the currently selected rows (and their represented addresses). Following options are provided:<br />

<ul><li>
<p><b>cast to code</b><br />
 casts the selected rows to be "enforced" to code</p>
</li><li>
<p><b>cast to byte</b><br />
 casts the selected rows to be "enforced" to byte data</p>
</li><li>
<p><b>cast to word</b><br />
 casts the selected rows to be "enforced" to word data</p>
</li><li>
<p><b>cast to char</b><br />
 casts the selected rows to be "enforced" to char data</p>
</li><li>
<p><b>ungroup</b> <br />
 ungroup selected rows (if possible, code e.g. can't be ungrouped or joined)</p>
</li><li>
<p><b>join</b> <br />
 groups selected rows, ALL selected (if possible, data which are not ascii e.g. can't be char-joined)</p>
</li><li>
<p><b>join #</b> <br />
 group to selected number (2-6)</p>
</li><li>
<p><b>DP</b> <br />
 set direct page register (what dissi is led to believe the dp is) to one of $c8, $c9, $d0</p>
</li><li>
<p><b>use label as data</b> You can force a label to be also be recognized as "immediate data". If you force that, dissi is able to use an address in immediate addressing. That means, if e.g.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<tt>$c880 has a label start_ram</tt><br />
and an assembler directive like:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<tt>LDU #$c880</tt><br />
  is encountered, dissi than can recognize the immediate label and output:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<tt>LDU #start_ram</tt><br />
  ... for better readability.</p>
</li></ul>
</p>
<h3>Keyboard shortcuts</h3>

<p>There are not many yet - dissi is still in development:<br />

<ul><li>
<p>"SPACE", sets or unsets a breakpoint at the current row.</p>
</li><li>
<p>"R", run (disables debugging, till a breakpoint is hit)</p>
</li></ul>
</p>
<h2>Below the table</h2>

<p>(This is not finished yet) Below the main table is a split panel, which again consists of two entities.
<ol><li>
<p>a "message" board, which at some stage might give you some feedback of what you are doing</p>
</li><li>
<p>a commandline where you can enter dissi commands without getting dizzy from all the mouse movements (although, this is a part which is not complete yet).</p>
</li></ol>
</p>
<h3>Dissi commands</h3>
<br/><p align="center">
<img src="pics/disscommands.png" width="585" height="307" /><br/>
<em>dissi commands</em></p><br/>

<ul><li>
<p>h shows a help of the current available commands, ...</p>
</li><li>
<p>these will be expanded as I need them, as of now following "written" commands are available:
<ul><li>
<p>hardreset</p>
</li><li>
<p>softreset</p>
</li><li>
<p>go</p>
</li><li>
<p>cycles (set or read)</p>
</li><li>
<p>run cycles</p>
</li><li>
<p>count cycles (between two addresses)</p>
</li><li>
<p>print (memory location)</p>
</li><li>
<p>breakpoint address, upon bankswitch, or any bit of VIA ORB</p>
</li><li>
<p>label reset (all automatically build lables)</p>
</li><li>
<p>clear ALL breakpoints</p>
</li><li>
<p>information about current cartridge</p>
</li><li>
<p>switch debugger to bank #</p>
</li><li>
<p>remove all automatically build "error" comments</p>
</li><li>
<p>toggle display about when a bankswitch occurred</p>
</li><li>
<p>cls</p>
</li><li>
<p>poke $xxxx $yy [change any memory location]</p>
</li><li>
<p>sync bank comments</p>
</li><li>
<p>carti</p>
</li><li>
<p>joyi</p>
</li><li>
<p>bankswitch debug</p>
</li><li>
<p>set xx yy</p>
</li></ul>
</p>
</li></ul>

<p>(as you see, these were commands that I at some stage needed while hacking VIDE together :-))</p>

<p>You can enter simple "expression" and use the cli as a small calculator. Conversion between decimal, binary and hex is also supported.</p>
<h3>Searching</h3>

<p>On the bottom of dissi is a search field. Searches covers all kinds of labels and commentary</p>
<h3>Searching in operands</h3>

<p>Entering any text will hightlight the operand cells, that contain a match.</p>
<h2>Hey dissi...</h2>

<p>In order to satisfy old debugging habbits (of doing a "System.out.println(...)" or a Console.writeln("...") or whatever) - I implemented a "hey dissi" routine.</p>

<p>In short, you can tell your source code to output information to the dissi message board. Everything works in form of comments. How comments are entered - see below (CNT, LST or ASSI, which of these is of no importance, as long as dissy knows the comments, when a vectrex program is executed).</p>

<p>As of now there are only two commands implemented, but if needs arise I can improvise and supply more :-).</p>

<p>The comment syntax is quite easy, dissi parses all comments and if it finds the keywords:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>hey dissi</b><br />
It knows that you are talking to it. Dissi than takes the string it finds after "hey dissi" which is expected to be in quotes and tries to interprete it as commands.<br />
Dissi as of now only knows two commands:<br />

<ul><li>
<p><b>print</b><br />
print some information</p>
</li><li>
<p><b>break</b> <br />
insert a breakpoint here</p>
</li></ul>
</p>

<p>Example 1:</p>

<div class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<p>; hey dissi "print I am great" <br />
</p>
</div>

<p>Will output <br />
<br />
"I am great" <br />
 <br />
Whenever this line is passed in emulation. The emulation is <b>not</b> stopped, only the string is printed.</p>

<p>Example 2:</p>

<div class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<p>; hey dissi "print value of $c9b5" <br />
</p>
</div>

<p>Will output <br />
<br />
"value of $c9b5 = $89" <br />
 <br />
(in case the memory location of $c95b equals $89 at the time)</p>

<p>Example 3:</p>

<div class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<p>; hey dissi "print value of $loop" <br />
</p>
</div>

<p>Will output <br />
<br />
"value of loop = $01" <br />
 <br />
(in case the memory location of the label "loop" equals $01 at the time)<br />
</p>

<p>In short:<br />

<ul><li>
<p>you can output any text after a print provided in quotes</p>
</li><li>
<p>you can give the print command a 16bit hex-number which must start with a "$", it than will print that address and the 8bit value stored in that address</p>
</li><li>
<p>you can print any known "variable" and its 8bit contents, the label must be proceded by a "$"</p>
</li><li>
<p>you can print all 6809 register and there values, write a hash before the register (e.g. #a for register a)</p>
</li><li>
<p>technically the string in the parantheses is "split("&nbsp;")" and all resulting words are interpreted with the above syntax, so in one line you can print as much as you like</p>
</li></ul>
</p>

<p>Example 4:</p>

<div class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<p>; hey dissi "break" <br />
</p>
</div>
<br />

<p>Will simply add a breakpoint to that line. Program execution will be halted.</p>
<h2>Supply dissi with information</h2>

<p>There are three (plus one) ways to supply dissy with information.
<ol><li>
<p>if you happen to use as09 from: <b>Copyright 1990-..., Frank A. Vorstenbosch, Kingswood Software.</b><br />
You can use the "LST" files that this assembler generates. If the "LST" file is in the same directory as the rom file, it will be loaded automatically.</p>
</li><li>
<p>Compile your source file with assi in VIDE.</p>
</li><li>
<p>edit dissi (not implemented yet, and this is actually the "plus one")</p>
</li><li>
<p>Supply a "CNT" file, if the "CNT" file is in the same directory as the rom, it will be loaded automatically.</p>
</li></ol>
</p>
<h3>CNT-Files</h3>

<p>You can create CNT files manually, but you will usually do is either:
<ol><li>
<p>assemble a source code with assi - than an cnt file is generated automatically</p>
</li><li>
<p>comment a "bin" cartridge in dissi - and save your comments - saving "knowledge" in dissi alays saves to a cnt file</p>
</li></ol>
</p>

<p>Saving is always done to the same directory the binary file was loaded from. In opposition to that cnt files are loaded in the following manner:
<ul><li>
<p>first dissi tries to load a cnt file in the directory the binary file as loaded from</p>
</li><li>
<p>after that a directory "cnt" is looked for and if found, a cnt file for the binary file is looked for there </p>
</li></ul>
</p>

<p>A CNT file is a description file for a rom. There are a handfull of entries you can provide. If done with enough endurance and research you can supply a whealth of information. Following entries are possible:<br />
</p>

<p><b>START&nbsp;BANK x / END&nbsp;BANK x</b><br />
All entries between those tags are only relevant for the given bank. The same CNT file can be used for different banks, but all information not belonging to the corresponding bank are ignored.<br />
If no start or end is given, all information are considered to be relevant for bank 0. <br />
After an END&nbsp;BANK x the default switches back to bank 0. <br />
(Not parsable numbers/characters are treated also as bank 0)<br />
 <br />
</p>

<p><b>END&nbsp;BANK x</b><br />
</p>

<p><b>EQU</b><br />
Defines a "constant".<br />
Example:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQU&nbsp;&nbsp;&nbsp;&nbsp;VECTOR_LENGTH&nbsp;&nbsp;&nbsp;&nbsp;0x10<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQU&nbsp;&nbsp;&nbsp;&nbsp;LENGTH_TIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$A0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQU&nbsp;&nbsp;&nbsp;&nbsp;LENGTH_POS_X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20<br />
 <br />
</p>
</div>

<p><b>LABEL</b><br />
Defines a "label".<br />
Example:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LABEL&nbsp;&nbsp;&nbsp;&nbsp;$F192&nbsp;&nbsp;&nbsp;&nbsp;Wait_Recal<br />
 <br />
</p>
</div>

<p><b>DIRECT_LABEL</b><br />
Defines a "label" for DP addressing, with this option you can assign different names to same values and have dissi enabled to discern the two.<br />
Example:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIRECT_LABEL&nbsp;&nbsp;&nbsp;&nbsp;$D0&nbsp;&nbsp;&nbsp;&nbsp;$00&nbsp;&nbsp;&nbsp;&nbsp;ORB<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIRECT_LABEL&nbsp;&nbsp;&nbsp;&nbsp;$D0&nbsp;&nbsp;&nbsp;&nbsp;$01&nbsp;&nbsp;&nbsp;&nbsp;ORA<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIRECT_LABEL&nbsp;&nbsp;&nbsp;&nbsp;$C9&nbsp;&nbsp;&nbsp;&nbsp;$00&nbsp;&nbsp;&nbsp;&nbsp;Ship_counter<br />
 <br />
</p>
</div>

<p><b>COMMENT_LINE</b><br />
Adds a complete line of commentary befor the given address.<br />
Example:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMENT_LINE&nbsp;&nbsp;&nbsp;&nbsp;$0020&nbsp;&nbsp;&nbsp;&nbsp;From here on, the wonderfull vectrex program will do ... <br />
 <br />
</p>
</div>

<p><b>COMMENT</b><br />
Adds a comment to the end of the instruction (group) beginning at the address.<br />
Example:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMENT&nbsp;&nbsp;&nbsp;&nbsp;$0022&nbsp;&nbsp;&nbsp;&nbsp;Plus 1 here because the ship exploded yesterday ... <br />
 <br />
</p>
</div>

<p><b>COMMENT_LABEL</b><br />
Adds a comment to a label (this is mainly interesting for labels in RAM).<br />
Example:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMENT_LABEL&nbsp;&nbsp;&nbsp;&nbsp;$C89F&nbsp;&nbsp;&nbsp;&nbsp;Amount of shrimps the player has eaten ... <br />
 <br />
</p>
</div>

<p><b>RANGES</b><br />
The range keyword has several subdivisions, which all work alike.<br />
First the examples, than a quick explaination.<br />
Example:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RANGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$17 - &nbsp;&nbsp;&nbsp;&nbsp;$28 &nbsp;&nbsp;&nbsp;&nbsp;CHAR_DATA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RANGE&nbsp;&nbsp;&nbsp;&nbsp;$1917 - $1943 &nbsp;&nbsp;&nbsp;&nbsp;DB_DATA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RANGE&nbsp;&nbsp;&nbsp;&nbsp;$1913 - $1917 &nbsp;&nbsp;&nbsp;&nbsp;BIN_DATA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RANGE&nbsp;&nbsp;&nbsp;&nbsp;$1913 - $1917 &nbsp;&nbsp;&nbsp;&nbsp;DW_DATA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RANGE&nbsp;&nbsp;&nbsp;&nbsp;$2913 - $2917 &nbsp;&nbsp;&nbsp;&nbsp;DWP_DATA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RANGE&nbsp;&nbsp;&nbsp;&nbsp;$1943 - $3499 &nbsp;&nbsp;&nbsp;&nbsp;CODE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RANGE&nbsp;&nbsp;&nbsp;&nbsp;$1B2D - $5255 &nbsp;&nbsp;&nbsp;DP $D0<br />
 <br />
</p>
</div>

<p>Essentially tell dissi what kind of data/code it has to expect. The example shows all six different type of ranges currently implemented.<br />
<i>CHAR_DATA<br />
</i> Are Vectrex "ASCII" chars, usually terminated by a $80. <br />
 <br />
<i>DB_DATA<br />
</i> Byte data. <br />
 <br />
<i>BIN_DATA<br />
</i> Byte data as binary. <br />
 <br />
<i>DW_DATA<br />
</i> Word data. <br />
 <br />
<i>DWP_DATA<br />
</i> Word pointer data. <br />
 <br />
<i>CODE<br />
</i> Code, here dissi should be put to work! <br />
 <br />
<i>DP<br />
</i> Tell dissi to expect DP to be set to the following value. <br />
 <br />
The first four of those ranges can have an additional value added. A number describing the maximal group length. If supplied, dissi tries to group the data found in the range into groups with that length.<br />
Example:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RANGE&nbsp;&nbsp;&nbsp;&nbsp;$1917 - $1943 &nbsp;&nbsp;&nbsp;&nbsp;DB_DATA 5<br />
 <br />
</p>
</div>

<p>Will group data into "packages" of five:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB  $10,  $ff, $03, $06, $0c<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB $10,  $ff, $18, $0c, $08<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB $10,  $ff,  $01,  $02,  $02  <br />
 <br />
</p>
</div>
<h2>Not yet done:<br />
</h2>

<ul><li>
<p>edit and save data to local "derby" database</p>
</li><li>
<p>(done!) make assi and dissi completely compatible</p>
</li></ul>
<h1>cdissi</h1>

<p>In order to test the assembler, I wrote a special version of dissi, &rarr; cdissi (compare dissi).</p>
<br/><p align="center">
<img src="pics/cdissi.png" width="1080" height="661" /><br/>
<em>compare dissi</em></p><br/>

<p>CDissi only makes sense if you have two nearly identical binary images.<br />
You can load both of them and have them displayed side by side.</p>

<p>Both lists are in sync, and can not be unsynced.</p>

<p>"Rows" in dissi are compared address wise. All that are equal have white background, all that are different are red.</p>

<p>Below the table you can enter a start and an end address for a CRC generation for both loaded files. </p>

<p>Note: <br />
Format (byte, word, char, code) of the output is <b>respected</b>, so the same data as word and byte shows as a difference.<br />
On both tables you do have the popup-menu to cast the data to anything you like.</p>
<hr />
<h1>dissi - indexed addressing</h1>
<br/><p align="center">
<img src="pics/indexadressing.png" width="780" height="539" /><br/>
<em>indexed adressing modes</em></p><br/>

<p>Dissi generates data (instead of code), if the postbyte of an indexed instruction is not as described in the above official table.</p>

<p>To be exact here an extract of the dissi corresponding source code ("DASM6809.java"):<br />
</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;reg=(pb&gt;&gt;5)&amp;0x3;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;// filter out not allowed combinations<br />
&nbsp;&nbsp;&nbsp;&nbsp;// 1xxx 0111<br />
&nbsp;&nbsp;&nbsp;&nbsp;// 1xxx 1010<br />
&nbsp;&nbsp;&nbsp;&nbsp;// 1xxx 1110<br />
&nbsp;&nbsp;&nbsp;&nbsp;if ( ((pb &amp; 0x8f) == 0x87) ||<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((pb &amp; 0x8f) == 0x8a) ||<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((pb &amp; 0x8f) == 0x8e)  )<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return incorrectDisassembleFoundAt(currentPC, "Illegal postbyte value for indexed addressing, bit combination of 4 lower bits.");                        <br />
&nbsp;&nbsp;&nbsp;&nbsp;}         <br />
        &nbsp;&nbsp;&nbsp;&nbsp;// filter out not allowed combinations<br />
&nbsp;&nbsp;&nbsp;&nbsp;// 1xx1 0010<br />
&nbsp;&nbsp;&nbsp;&nbsp;// 1xx1 0000<br />
&nbsp;&nbsp;&nbsp;&nbsp;if ( ((pb &amp; 0x9f) == 0x92) ||<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((pb &amp; 0x9f) == 0x90) )<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return incorrectDisassembleFoundAt(currentPC, "Illegal postbyte value ,-R or ,R+  not allowed for indirect indexed addressing.");   <br />
                      &nbsp;&nbsp;&nbsp;&nbsp;}    <br />
                       <br />
&nbsp;&nbsp;&nbsp;&nbsp;// filter out not allowed combinations<br />
&nbsp;&nbsp;&nbsp;&nbsp;// 1xx0 1111<br />
&nbsp;&nbsp;&nbsp;&nbsp;if ( ((pb &amp; 0x9f) == 0x8f) )<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return incorrectDisassembleFoundAt(currentPC, "Illegal postbyte value 16 bit extended not allowed in indexed (non indirect) addressing.");                        <br />
&nbsp;&nbsp;&nbsp;&nbsp;}          <br />
&nbsp;&nbsp;&nbsp;&nbsp;// filter out not allowed combinations<br />
&nbsp;&nbsp;&nbsp;&nbsp;// 1011 1111<br />
&nbsp;&nbsp;&nbsp;&nbsp;// 1101 1111<br />
&nbsp;&nbsp;&nbsp;&nbsp;// 1111 1111<br />
&nbsp;&nbsp;&nbsp;&nbsp;if ( ((pb &amp; 0xff) == 0xbf) ||<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((pb &amp; 0xff) == 0xdf) ||<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((pb &amp; 0xff) == 0xff)  )<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return incorrectDisassembleFoundAt(currentPC, "Illegal postbyte value 16 bit indirect indexed addressing expects bits 5 and 6 to be 0");                        <br />
&nbsp;&nbsp;&nbsp;&nbsp;}          <br />
                <br />
&nbsp;&nbsp;&nbsp;&nbsp;// 1xxx 1100<br />
&nbsp;&nbsp;&nbsp;&nbsp;// 1xxx 1101<br />
&nbsp;&nbsp;&nbsp;&nbsp;if (( (pb&amp;0x8f) == 0x8d) || ( (pb&amp;0x8f) == 0x8c))<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// reg == PC!<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reg = 4;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ((pb&gt;&gt;4) &amp; 0x6) != 0)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*                    <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1XX? ????<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X bits can be anything,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asmj converts "sta &lt;$30,pc"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to "ec 8c 30"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which is correct<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but "ec ec 30"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but "ec dc 30"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but "ec bc 30" are also correct, but only the first 100% ressembles old binary<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;therefor the below three variants must be converted to DB, with comment not to convert to code!<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this is true for both 16 bit or 8 bit variant!<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/                    <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return incorrectDisassembleFoundAt(currentPC, "Ambiguous pc index addressing, postbytes bit 5 and 6 are non zero (assi generates 0).");                        <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
</p>
</div>
<hr />
<h1>regi</h1>
<br/><p align="center">
<img src="pics/regi.png" width="235" height="398" /><br/>
<em>regi window</em></p><br/>

<p>All registers are displayed.<br />
</p>

<ul><li>
<p>tooltips will show the translation to decimal and hex.</p>
</li><li>
<p>double click on a "address" register will initiate jump to that address in dissi</p>
</li><li>
<p>SHIFT double click on a "address" register will initiate jump to that address in dumpi</p>
</li><li>
<p>the table under "S" shows the current callstack</p>
</li><li>
<p>double click on a callstack address will initiate jump to that address in dissi</p>
</li><li>
<p>red registers changed since last regi update</p>
</li><li>
<p>regi also display the bank (in [] after pc)</p>
</li></ul>

<p>Notice:<br />

<ul><li>
<p>the callstack is not the contents of the stack!<br />
</p>
</li><li>
<p>the callstack only has "subroutine"-return-addresses!</p>
</li><li>
<p>the callstack might also get confused if the stack is changed programmatically (like <tt>LDS&nbsp;&nbsp;&nbsp;#$C800</tt>)</p>
</li></ul>
</p>
<hr />
<h1>dumpi</h1>
<br/><p align="center">
<img src="pics/dumpi.png" width="1002" height="852" /><br/>
<em>dumpi window</em></p><br/>

<p>In the top row there are buttons to jump directly to RAM locations. Followed by 16bit register buttons. Pressing the later also jumps to the address the "pressed" register points to.</p>

<p>On the top left is a checkbox called "data display". If selected, the dumpi window is split, and in the bottom part a vector/raster display is shown.</p>

<p>This displays when "active" (a checkbox below the table) either a "raster" image (a vector representation of a bitmap) or a vectorlist.</p>
<br />

<p>These modes are selectable by the two radiobuttons.<br />
</p>
<h3>Selection</h3>

<p>The selection that is displayed can be chosen by three differen means:
<ol><li>
<p>in the dumpi window: left click on start address, shift left click on end address</p>
</li><li>
<p>the selection in dissi is taken immediately as selection in dumpi (when active)</p>
</li><li>
<p>direct editing of start/end address in textfields</p>
</li></ol>
</p>

<p>The selected values are highlighted light blue in the dumpi-table.</p>
<h3>Vectorlist</h3>

<p>The data selected can be displayed as a vectorlist. The configuration of the vectorlist types that are supported (or can be configured) are the same as described in vecci (import). For a detailed description see there...</p>
<h3>Raster data</h3>

<p>Raster data (images or fonts) can also be displayed (large amount of selected data slows down vide, remember in java to not place heavily updated windows above each other, they will trigger updating each other...).</p>

<p>The user still has to figure out:
<ul><li>
<p>start of the data</p>
</li><li>
<p>end of the data</p>
</li><li>
<p>how many bytes constitute one "line"</p>
</li></ul>
</p>

<p>For images the last one is usually not to big (10 bytes are already a 80 bit wide image).</p>

<p>For fonts the width is usually the number of characters that the font consists of. (e.g. BerzerkArena has a font with 108 characters, so the width is 108) </p>
<br/><p align="center">
<img src="pics/dumpi2.png" width="1003" height="852" /><br/>
<em>dumpi example 2 vectorlist display</em></p><br/>
<hr />
<h1>vinfi</h1>
<br/><p align="center">
<img src="pics/vinfi.png" width="117" height="390" /><br/>
<em>vinfi window</em></p><br/>

<p>Vector information window.<br />
Here you can see some data of a selected vector. The data shown are:
<ul><li>
<p>on the first line you see the currently drawn count of vectors<br />
The count is related to the display routine though â which means patterned vectors are not counted as one vector, but are counted by how many times the light is switched on or off â this will NOT be fixed â this is a feature not a bug :-)!</p>
</li><li>
<p>the coordinates </p>
</li><li>
<p>a tooltip displays the distance</p>
</li><li>
<p>intensity of the vector</p>
</li><li>
<p>the PC where the ~BLANK signal became 1 (when the vector was finished drawing)</p>
</li><li>
<p>and the callstack at that time</p>
</li><li>
<p>double click on PC will initiate jump to that address in dissi</p>
</li><li>
<p>double click on a callstack address will initiate jump to that address in dissi</p>
</li></ul>
</p>

<p>Notice:<br />
The callstack is not the contents of the stack!<br />
The callstack only has "subroutine"-return-adresses!</p>

<p><b>Mouse</b><br />
Below the callstack, while moving over the emulation window, you can see the mouse-coordinates displayed. These coordinates are calculated to represent the actual integrator values needed for that position. This means the mouse coordinates are displayed in vectrex integrator/coordinates.</p>
<hr />
<h1>viai</h1>
<br/><p align="center">
<img src="pics/viai.png" width="896" height="668" /><br/>
<em>viai window</em></p><br/>

<p>Well - also straight forward... all VIA 6522 registers and lines are shown.</p>

<p>They are displayed in hex and in binary form.</p>

<p>Some tooltips enhance the show...</p>
<hr />
<h1>ani</h1>
<br/><p align="center">
<img src="pics/ani.png" width="264" height="435" /><br/>
<em>ani window</em></p><br/>

<p>Well - also straight forward... all analog settings are shown.</p>

<p>Some tooltips enhance the show...</p>

<p><b>Why?</b><br />
You might say what is that panel usefull for, there is already a VIA panel with the same information. Well that is <b>not true</b>!<br />
</p>

<p>Here you see the values of the actual analog vectrex parts. On the VIA panel "only" the via ports and registers are shown. With the implementation of delays, these values can differ. Usually the analog values are set a few cycles later than the via counterparts!</p>

<p>On the bottom you can see the joystick input and output lines (differentiated between the two states), you can - by using a popup window - place breakpoints on these.</p>
<hr />
<h1>labi</h1>
<br/><p align="center">
<img src="pics/labi.png" width="426" height="693" /><br/>
<em>labi window</em></p><br/>

<p>Well - also straight forward... all available labels are shown.</p>

<p>On double click, dissi moves there...</p>
<hr />
<h1>vari</h1>
<br/><p align="center">
<img src="pics/vari.png" width="1034" height="298" /><br/>
<em>vari window</em></p><br/>

<p>Well - also straight forward... all known variables (named RAM-locations) are shown.</p>

<p>You can update the variables name on the fly, the disassembly in dissi will reflect the changes, all references to the variable will be updated.</p>

<p>Same with comments.</p>

<p><b>all known...</b><br />
In case you need more than all known locations, you can add locations using the  <img src="pics/add.png" alt="add.png" /> button (this mainly comes handy if RAM-locations are used via accessing with the use of the DP register)</p>

<p><b>breakpoints</b><br />
As shown in the image above, you can also set breakpoints to ram locations. 
<ul><li>
<p>read: triggered when the ram location is read</p>
</li><li>
<p>write: triggered when ram location is written to</p>
</li><li>
<p>value: triggered when ram locations is written to with a certain value</p>
</li></ul>
</p>

<p><b>use label as data</b> You can force a label to be also be recognized as "immediate data". If you force that, dissi is able to use an address in immediate addressing.</p>

<p>That means, if e.g.</p>

<p><tt>$c880 has a label start_ram</tt><br />
</p>

<p>and an assembler directive like:</p>

<p><tt>LDU #$c880</tt><br />
 </p>

<p>is encountered, dissi than can recognize the immediate label and output:</p>

<p><tt>LDU #start_ram</tt><br />
 </p>

<p>... for better readability.</p>
<hr />
<h1>tracki</h1>
<br/><p align="center">
<img src="pics/trackyNew.png" width="306" height="209" /><br/>
<em>tracki window</em></p><br/>

<p>The time in system cycles between the two memory locations is measured and shown.</p>

<p>Default are suitable memory locations for a measurement of user programs, timed between each Wait_Recal - call.</p>
<h2>How it works</h2>

<p>The cycle count is always measured between two memory locations. The locations to enter as start and end address are usually "inverse" to the natural order of memory locations.</p>

<p>For example, to do a measurement between two calls of WaitRecal, you chose as start address the "exit" of WaitRecal and as an end address the entry point of WaitRecal.</p>

<p>That way you measure all cycles IN BETWEEN two calls of WaitRecal.</p>

<p>Many original games and some homebrew stuff use the BIOS WaitRecal routine in their game loop to stabilize display, so the default setting should work fairly often.</p>

<p>Nonetheless you will find, especially if you program yourself optimzed stuff, that you will want to measure you own routines. For that you can:
<ol><li>
<p>enter start and end addresses</p>
</li><li>
<p>you can also name these and persist them, so you can easily reuse them in a later session.</p>
</li></ol>
</p>

<p>Just type in a name for your meaurement in the textbox and press the save button. The new measurement setting will be added to the combobox to chose from.</p>
<hr />
<h1>breaki</h1>
<br/><p align="center">
<img src="pics/breakpoints.png" width="822" height="587" /><br/>
<em>breaki window</em></p><br/>

<p>not finished yet!</p>
<br />
<br />

<p>This is the beginning of a breakpoint list window. Although it is functionally working I don't like the looks of it.</p>

<p>The display lists all known information of all breakpoints, although to "normal" user this information may seem cryptic.</p>

<p>It displays all known breakpoints in a list. The current "break" is highlighted red (only once, for one single "step").</p>

<p>To delete a breakpoint press the corresponding <img src="pics/delete.png" alt="delete.png" /> button. <br />
As of yet it is not possible to add new breakpoints via this panel.</p>

<p><b>Notice!<br />
</b> Not all type of breakpoints are implemented yet!<br />
<br />
</p>

<p><b>Some more cryptic information<br />
</b> Target:<br />

<ul><li>
<p>Memory<br />
All breakpoints related to memory locations</p>
</li><li>
<p>CPU<br />
All breakpoints related to CPU, there are possible sub-systems:
<ul><li>
<p>PC - implemented</p>
</li><li>
<p>A</p>
</li><li>
<p>B</p>
</li><li>
<p>D</p>
</li><li>
<p>X</p>
</li><li>
<p>Y</p>
</li><li>
<p>U</p>
</li><li>
<p>S</p>
</li><li>
<p>CC</p>
</li><li>
<p>DP</p>
</li><li>
<p>Cycles - implemented</p>
</li><li>
<p>Special - implemented [only internaly used!]</p>
</li></ul>
</p>
</li><li>
<p>Analog<br />
not implemented</p>
</li><li>
<p>VIA<br />
only VIA&nbsp;ORB implemented</p>
</li><li>
<p>PSG<br />
not implemented</p>
</li><li>
<p>Cartridge<br />
implemented bank switching breakpoint.</p>
</li><li>
<p>Port<br />
breakpoints on going high/low can be placed on the joystick IO "ports" (accessable via the ani window).</p>
</li></ul>
</p>

<p>type:<br />
A combination of following "types":
<ul><li>
<p>ONCE<br />
Breakpoint is executed once and then dicarded.</p>
</li><li>
<p>MULTI<br />
Opposite of "ONCE", breakpoint is not discarded when hit.</p>
</li><li>
<p>READ<br />
Breakpoint is triggered by some sort of "read".</p>
</li><li>
<p>WRITE<br />
Breakpoint is triggered by some sort of "write".</p>
</li><li>
<p>INFO<br />
Breakpoint does not "break" the execution, but displays some sort of information.</p>
</li><li>
<p>COMPARE<br />
Some sort of comparisson is needed for the breakpoint to be triggered</p>
</li><li>
<p>HEY<br />
Breakpoint has its origin in the comment of the source - "Hey dissi"</p>
</li><li>
<p>BANK<br />
Breakpoint is a bankswitch breakpoint.</p>
</li><li>
<p>BITCOMPARE<br />
Some sort of "bit" comparisson is needed for the breakpoint to be triggered</p>
</li><li>
<p>CYCLES<br />
Breakpoint is triggered by some sort of cycle information.</p>
</li><li>
<p>QUIET<br />
Triggered breakpoint is not shown to the user.</p>
</li></ul>
</p>

<p>target address:<br />
If a target address of some sort is provided (memory/ram...), and also the bank.</p>

<p>name:<br />
Some generated name.</p>

<p>compare value:<br />
If a comparisson of any sort is needed, this is the value the breakpoint compares its target to.</p>

<p>counter:<br />
not used (yet).</p>

<p>exit:<br />
One of:
<ul><li>
<p>break<br />
Does actually "break" execution.</p>
</li><li>
<p>info <br />
Gives out information, does not break.</p>
</li></ul>
</p>

<p>(now that I write this... this seems to be redundant with the above given type... hm...)</p>
<hr />
<h1>ayi</h1>
<br/><p align="center">
<img src="pics/aypanel.png" width="608" height="354" /><br/>
<em>ayi window</em></p><br/>

<p><b>Why?</b><br />
Does this window look different than all the other panels? <br />
Hm, no reason - I did it on a different day, or even in a different month, so I somehow decided to do it this way.</p>

<p><b>But it is bad, to have different looks in one application, the poor users...?</b><br />
Yep... I know. Still. learn to live with it, or change the sources yourself!</p>
<h2>Save as Bin/Data/YM-file</h2>

<p>There is a new option to now save the PSG output (not digital sound as of yet).</p>
<h3>YM file</h3>

<p>YM-files consist of register information of the PSG, which are (best) saved at specific intervals. The file format was developed by Arnaud CarrÃ© originally for Atari ST sound files. (See: <a target="_blank" href="http://leonard.oxg.free.fr/ymformat.html">http://leonard.oxg.free.fr/ymformat.html</a>)</p>
<h3>Data</h3>

<p>Chosing this option the PSG data will be saved to assembler compatible db-statements, 16 registers per row .</p>
<h3>Bin</h3>

<p>Chosing this option the PSG data will be saved to binary "raw" data 16 registers repeatedly.</p>
<h3>Record when?</h3>

<p>You can chose to the intervall at which data shall be recorded by two different options:
<ul><li>
<p>record when address = xxxx<br />
For example each time after a subroutine that updates sound registers is called (do&nbsp;sound)</p>
</li><li>
<p>or you can give a fixed timed intervall in 6809 cylce information (30000 cycles = 50Hz)</p>
</li></ul>
</p>
<h3>Buttons</h3>

<ul><li>
<p><img src="pics/control_record_blue.png" alt="control_record_blue.png" /> &nbsp;&nbsp;<b>start recording</b></p>
</li><li>
<p><img src="pics/control_stop_blue.png" alt="control_stop_blue.png" /> &nbsp;&nbsp;<b>stop recording</b><br />
Only after stopping properly, data files will be saved!</p>
</li></ul>
<hr />
<h1>vecci</h1>

<p>Vecci is one of the few entities in VIDE which is not based on software of other programmers, so if you are not content with what you find here - all blame belongs to Malban alone!</p>

<p>Anyway... vecci is is the part of VIDE that concerns itself with vector drawing, vector lists and other display stuff. There are many functions hidden under the complicated seeming gui. But I promise you, once you programmed vecci, you know it by heart and can do wonderfull things with it!</p>
<br/><p align="center">
<img src="pics/veccy.png" width="1184" height="946" /><br/>
<em>vecci window</em></p><br/>
<h2>Basic</h2>
<h3>Colors</h3>

<p>Using vecci you will notice different colorings in the vector display areas:
<ul><li>
<p>black<br />
 the background is always black</p>
</li><li>
<p>darkgray<br />
the grid (if enabled) is always dark gray</p>
</li><li>
<p>different shades of gray<br />
  are vectors with different intensities</p>
</li><li>
<p>blue surrounding<br />
  are selected entities</p>
</li><li>
<p>light purple<br />
  are highlighted entities</p>
</li><li>
<p>purple vectors<br />
  are vectors which have "joined" ends at both sides</p>
</li><li>
<p>red little squares<br />
  are the endpoints of vectors</p>
</li><li>
<p>pink little squares<br />
  are "joined" endpoints of vectors</p>
</li><li>
<p>dark blue vectors<br />
  are "move" vectors (pattern 0) which are made (optionally) visible  </p>
</li><li>
<p>dots/patterns<br />
  are patterned vectors (these do not fit 100% to vectrex patterns!)</p>
</li><li>
<p>orange<br />
  the ruler/crosshair is orange</p>
</li><li>
<p>green<br />
  the ruler/crosshair is green while a mouse button is pressed</p>
</li><li>
<p>dark green alpha values<br />
  is the rectangle that can be build by dragging the mouse on the editor</p>
</li><li>
<p>bright red<br />
  selected entities in the "DISPLAY" panel</p>
</li><li>
<p>bright yellow<br />
  highlight entities in the "DISPLAY" panel  </p>
</li></ul>
</p>
<h3>Entities</h3>

<p>With vecci you can handle two different entities. 
<ol><li>
<p>Vectorlists</p>
</li><li>
<p>Animations/Scenarios</p>
</li></ol>
</p>
<h3>Vectorlists</h3>

<p>Vectorlists are vectrex basic vector lists. They come in different flavors, just as there are different BIOS routines in the vectrex BIOS. In general following permutations are possible:
<ul><li>
<p>relative vector information</p>
</li><li>
<p>non relative vector information</p>
</li><li>
<p>intensity settings</p>
</li><li>
<p>pattern settings</p>
</li><li>
<p>continueous drawing &larr;&gt; position dependend drawing</p>
</li><li>
<p>with "move" or without "move" (could be a subset of pattern)</p>
</li></ul>
</p>

<p>Not all of these cases are implemented as exports as of now, but all of these factors can be edited and persisted by vecci.</p>

<p>The main "list" of vectors is displayed in the first tab named "Vector List" on the left side of the window. </p>
<h3>Animations/Scenarios</h3>

<p>Animations is what I call a collection of vectorlists which have a common "interest" this might be a rotation, a movement or a "real" animation.</p>

<p>An animation consists of an arbitrary number of vectorlists. As of now these can be saved/loaded in vecci format (and exported). Custom routines to use animations are as example provided...</p>

<p><b>Note!</b><br />
The DISPLAY panel can be switched from "vectorlist" display to "animation/scenario" display using the "play" button!</p>
<h2>Window entities in short</h2>

<ul><li>
<p>the "black" panels are vector displays or editors</p>
</li><li>
<p>editing can only be done in the upper half of vecci, in the vector editor panel(s) or in the vector table</p>
</li><li>
<p>in the middle you have a vector DISPLAY panel, and several tabs/buttons with which you can change modes or build/transform vectorlists</p>
</li><li>
<p>in the lower section of the window you have the animation/scencario settings and functions</p>
</li></ul>
<h3>Vector panels</h3>

<p>There are a number of "black" panels you see in the vecci window. These in general display vectors. The three largest (all in the upper half of the window (two are "hidden" on the tab "Y/Z") ) are "editor" panels. Here you can actually draw, select, delete and move vectors. The three largest also fathom a "grid". The grid can be toggled on/off with the small checkbox "grid" on the left of the window. You can also select the width of the grid. If the grid is enabled, vectors are placed on the current grid spacing!</p>

<p>The middle "smaller" vector display window is only a "DISPLAY", here you can see the current vectorlist:
<ol><li>
<p>as a 3d setting</p>
</li><li>
<p>as an animation</p>
</li><li>
<p>as a scenario</p>
</li></ol>
</p>

<p>depending on your current settings.</p>

<p>There are two sliders which you can see when you open vecci, both are used to change the scale of the nearby vector displays. If you center the sliders the scale value is one and you see approximatly a display with coordinates ranging from -150 to +150. You will probably also see a light blue border. This border I call "byteFrame" it can be switched on and off using the "byteFrame" checkbox in the upper left of the window. The byteFrame is drawn around the coordinates -128 to +127, this is the largest/smallest possible value a vector for vectrex should have, since it is a 8bit-machine and the values are signed.</p>
<h3>Vector table</h3>

<p>Right of the main vector editor panel you can see a table, this table holds (in vecci format) all vector information of the currently edited vectorlist. The relevant fields (coordinates, pattern, intensity) can be edited. Below the table are several buttons, with these you can persist or load single vectorlists.</p>

<ul><li>
<p><img src="pics/page_go.png" alt="page_go.png" /> &nbsp;&nbsp;<b>load vectorlist</b><br />
Load a vectorlist from a XML-file, the current is overwritten.</p>
</li><li>
<p><img src="pics/page_save.png" alt="page_save.png" /> &nbsp;&nbsp;<b>save vectorlist</b><br />
Save the current vectorlist to a XML-file.<br />
<br />
</p>
</li><li>
<p><img src="pics/arrow_undo.png" alt="arrow_undo.png" /> &nbsp;&nbsp;<b>undo</b><br />
</p>
</li><li>
<p><img src="pics/arrow_redo.png" alt="arrow_redo.png" /> &nbsp;&nbsp;<b>redo</b><br />
<br />
</p>
</li><li>
<p><img src="pics/page_copy.png" alt="page_copy.png" /> &nbsp;&nbsp;<b>copy selected vectors</b><br />
Put the current selected vectors in a buffer (this is no clipboard buffer, but can be accessed from all vecci-panels)</p>
</li><li>
<p><img src="pics/paste_plain.png" alt="paste_plain.png" /> &nbsp;&nbsp;<b>paste buffer</b><br />
Paste the current buffer into the current vectorlist. </p>
</li><li>
<p><img src="pics/cut.png" alt="cut.png" /> &nbsp;&nbsp;<b>cut selected vectors</b><br />
 The current selected vectors are deleted, but also placed in the buffer <br />
 <br />
</p>
</li><li>
<p><img src="pics/page_add.png" alt="page_add.png" /> &nbsp;&nbsp;<b>insert vectorlist file</b><br />
Insert another XML-file into the current vectorlist.</p>
</li><li>
<p><img src="pics/page_edit.png" alt="page_edit.png" /> &nbsp;&nbsp;<b>save selection as XML-file</b><br />
Save the current selected vectors as a XML-file. <br />
</p>
</li><li>
<p><img src="pics/new.png" alt="new.png" /> &nbsp;&nbsp;<b>new</b><br />
Clear vectorlist.</p>
</li><li>
<p>expanding/shrinking<br />
With the <img src="pics/add.png" alt="add.png" /> and <img src="pics/delete.png" alt="delete.png" /> buttons you can enlarge or shrink the vectorlist according to the factor given by the nearby textfield. (shrinking uses 1/value of textfield as factor)<br />
Since the value is a FACTOR you can not expand points!</p>
</li></ul>

<p>If in the "select vector" mode (see below), you can also select vectors by selecting the rows in the table, if you want to move them, remember to press shift while draging!</p>

<p>The table also shows the selection you make by selecting vectors in the edit panel.</p>

<p>Start- and end- points selections are also shown in the table.</p>
<h3>3d settings and other...</h3>

<p>The above table is part of a tabbed pane surrounding it. The other tabs are:
<ul><li>
<p>Y/Z<br />
If you want to edit 3d vectorlists, here are the other two visual displays. The "normal" display I call "Front", the second I call "Top" and the third "Sideways". All three displays are orthogonal displays. To view the actual 3d structure you have to look at the DISPLAY vector display.</p>
</li><li>
<p>3d axis settings<br />
Usually the DISPLAY display is the same as the "Front" display, but using this tab you can change the angle (camera position), the location and the axis of the DISPLAY.</p>
</li><li>
<p>import and export<br />
See extra pages for these...</p>
</li><li>
<p>vectorlist status<br />
</p>
<br/><p align="center">
<img src="pics/VeccyInfo.png" width="721" height="361" /><br/>
<em>information</em></p><br/>

<p>On this tab you can see diverse information about the current edited vectorlist. The information you can find here gives you clues in what way you can export the current list or what is right/wrong with it in its current state. The checkboxes on this page are only means to display the current status, checking/unchecking them manually does not result in any changes! Following information is provided:
<ul><li>
<p>all vectors same intensity<br />
 only information, no relevance otherwise</p>
</li><li>
<p>all vectors same pattern<br />
 some save formats will be disabled, since these have no means to convey pattern information</p>
</li><li>
<p>all pattern high bit set<br />
are all patterns &gt; 128 some vectorlist formats require that!</p>
</li><li>
<p>2d only<br />
 all z coordinates must be 0, only information, no relevance otherwise</p>
</li><li>
<p>vectors in one path<br />
are all vectors (except start and end) connected? (determined by different method &rarr; start, end point)</p>
</li><li>
<p>vectors continuous<br />
are all vectors (except start and end) connected? (determined by different method &rarr; relative)</p>
</li><li>
<p>closed polygon<br />
 same as the last two, but including start/end vectors</p>
</li><li>
<p>ordered closed polygon<br />
 as above but the vectors must also be ordered correctly</p>
</li><li>
<p>also displayed are the min/max coordinates of vectors and the maximal length found (which will be red if larger than 127)</p>
</li></ul>
</p>
</li></ul>
</p>
<h2>Drawing vectors</h2>
<h3>Mode</h3>

<p>There are as of yet three different modes, vecci can be set to. Depending on the mode settings you can do different things.   The modes can be changed by a setting nearly in the middle of the window. In a tabbed pane with the heading "Mode/Select": </p>
<br/><p align="center">
<img src="pics/VeccyMode.png" width="253" height="240" /><br/>
<em>Mode</em></p><br/>

<p>The "Set" mode, does what it is named after - it sets vectors. The other modes are "edit" modes.<br />
</p>

<p>Vecci starts of in Mode "Set".<br />
 <br />
</p>

<p><b>Quick switch!<br />
</b> While the mouse is over the vectorlist edit panel, you can use the middle mouse button to switch thru the three available modes! The selected mode is also displayed in blue letters.</p>
<h4>Mode "SET"</h4>

<p>In the "set" mode, you can actually draw vectors. Left click on the "black" panel on the upper right, dragging the mouse and releasing the button draws one single vector. Right click after you have drawn your first vector will create a new vector from the last "end" position to the current click position.</p>

<p>The draw mode can have two additional "features" which can be turned on/off with the checkboxes directly to the left of the "Set" button.
<ol><li>
<p>continue<br />
This option if enabled "continues" drawing directly to the next position. The resulting "multiple" vectors are connected (you can unconnect them later if needed - as you can also connect previously unconnected vectors later)</p>
</li><li>
<p>points ok<br />
This option allows you to set points, vectors with a length of 0, don't know if one ever needs it, but here you go as an option.</p>
</li></ol>
</p>

<p>Setting vectors is straight forward and thats all you can do in this mode!</p>
<h4>Mode "select point"</h4>

<p>In this mode you can select and move single points of vectors.</p>

<p>If you move the mouse over the vector panel, the point under the mouse is highlighted. With a click on the left mouse button you select the point (blue surrounding). You can "drag" a point with the mouse button.</p>

<p>If you shift/click you can select more than one point - draging, drags "all" selected points.</p>

<p>I you click on an "empty" spot (no highlighted point), you can drag a "rectangle" and capture points with it (select points). Shift/draging allows again to drag all of them.</p>

<p>To "unselect" a single point, keep shift pressed and click the point you want to remove with the middle mouse button.</p>

<p>Right click on a point gives you (depending on current circumstances) more options, a popup menu will be displayed.</p>

<p>For example, if you drag two points over each other AND have "continue" enabled, you can  join vectors at these points.</p>
<h4>Mode "select vector"</h4>

<p>In this mode you can select and move vectors.</p>

<p>The settings are nearly identical to the "point" section...</p>

<p>If you move the mouse over the vector panel, the vector under the mouse is highlighted. With a click on the left mouse button you select the vector (blue surrounding). You can "drag" a vector with the mouse button.</p>

<p>If you shift/click you can select more than one vector - draging, drags "all" selected vectors.</p>

<p>I you click on an "empty" spot (no highlighted vector), you can drag a "rectangle" and capture vectors with it (select vectors). Shift/draging allows again to drag all of them.</p>

<p>To "unselect" a single vector, keep shift pressed and click the vector you want to remove with the middle mouse button.</p>

<p>Right click on a vector gives you (depending on current circumstances) more options, a popup menu will be displayed.</p>
<h3>Popup / Point selection</h3>

<p><tt>Always</tt><br />

<ul><li>
<p>Set as Start<br />
Sets the current highlighted point as startpoint of the vectorlist. The vectorlist might be reordered in order to set the point. </p>
</li></ul>
</p>

<p><tt>Without continue:<br />
-----------------<br />
</tt> 2 points selected:
<ul><li>
<p>"join selected (here)"<br />
  moves both points to the highlighted location   they are not JOINED, only brought to the same location!</p>
</li><li>
<p>"connect selected"<br />
  builds a new vector between the two selected points</p>
</li><li>
<p>"Rip joined vectors"<br />
  rips two (truly) joined vectors </p>
</li></ul>
</p>

<p><tt>With continue:<br />
--------------</tt><br />
x Points selected<br />

<ul><li>
<p>"join here"<br />
  Joins all points at the current location and truly joins them!<br />
<b>NOTE</b><br />
 Joining more than two vectors in one point is usualy a bad idea and might lead to unexpected results, when using some other "shortcuts" within vecci</p>
</li></ul>
</p>

<p>2 Points selected<br />

<ul><li>
<p>"connect selected"<br />
  builds a new vector between the two selected points and joins both ends   of the new vector to their endpoints</p>
</li><li>
<p>"join selected (here)"<br />
  moves both points to the highlighted location   and truly JOINS them</p>
</li><li>
<p>"Rips joined vectors"<br />
  rips two (truly) joined vectors </p>
</li></ul>
</p>
<h3>Popup / Vector selection</h3>

<p>Here you only have two selections:
<ul><li>
<p>delete selected </p>
</li><li>
<p>delete not selected</p>
</li></ul>
</p>
<h3>Visual</h3>

<p>On the same Tab as the mode selects there are also some additional options available:
<ul><li>
<p>arrows<br />
Draw vectors as arrows, shows simply the direction of a vector.</p>
</li><li>
<p>position<br />
Draw a number on each vector which shows the ordering position in the vectorlist.</p>
</li><li>
<p>moves visible<br />
If checked move vectors (pattern = 0) are displayed using a dark blue color.</p>
</li></ul>
</p>
<h2>build animation</h2>

<p>Under this tab there are a few functions to build animations or scenarios from the current vectorlist.</p>
<h3>Rotation</h3>
<br/><p align="center">
<img src="pics/rotation.png" width="732" height="477" /><br/>
<em>Rotation example</em></p><br/>

<p>Rotations can be calculated by vecci, you can chose the axis (1 or more axis) the maximal angle and the number of steps you would like to rotate.</p>

<p>If you use "large" coordinates in your vectorlists, the rotation list values <i>can</i> be higher than the byte range vectrex allows, to prevent this you can chose the extra option "scale to byte", this ensures that the resulting list still "fits".</p>

<p>A built "animation" of a rotation always has 3 parts:
<ol><li>
<p>the origin</p>
</li><li>
<p>the final result</p>
</li><li>
<p>the steps in between</p>
</li></ol>
</p>

<p>The "steps" counter where you can enter the "steps" represents c). 0 (zero) can be used!</p>

<ol><li>
<p>is always the original vectorlist</p>
</li><li>
<p>is always the given "max angle" applied to the vectorlist</p>
</li><li>
<p>are all steps in between</p>
</li></ol>
<br/><p align="center">
<img src="pics/test.gif" /><br/>
<em>Rotation example</em></p><br/>
<h3>Morphing</h3>

<p>You can also "morph" from one vectorlist to another. The two first vectorlists in the current animation (see below) are used as input. You can chose the number of steps you wish to use.</p>
<br/><p align="center">
<img src="pics/ChrisFrog.gif" /><br/>
<em>Morph example</em></p><br/>
<h3>Scenario</h3>

<p>As of now only one function ist provided: <br />
seperate paths as scenario entries:<br />
Using this button you can split the current vectorlist in seperate vectorlists. For each "connected path" in the vectorlist one scenario entry is generated. The opposite function is the "join" function in the animation/scenario section. <br />
Example:<br />
<img src="pics/splitExample1.png" alt="splitExample1.png" /> &larr;&gt; <img src="pics/splitExample2.png" alt="splitExample2.png" /></p>
<h2>Shortcuts</h2>
<br/><p align="center">
<img src="pics/shortcuts.png" width="290" height="254" /><br/>
<em>shortcuts</em></p><br/>

<p>There are a couple of "helper" functions provided, these function on complete vectorlists (not animations(yet) ).
<ul><li>
<p>center vectorlist<br />
Well - centers the current vectorlist</p>
</li><li>
<p>connect when possible<br />
If vectors in the list have the same start/end coordinates, this functions "joins" these vectors.</p>
</li><li>
<p>order vectorlist<br />
This function orders the vectors to the best of vides automation abilities, this means there are several steps taken:
<ul><li>
<p>first it is insured that all "joined" vectors are joined to their "correct" ends, meaning startpoints are joined to endpoints vice/versa, if this is done, usualy one of the vectors changes its orientation</p>
</li><li>
<p>all joined vectors are ordered in their "natural" join order</p>
</li><li>
<p>all other vectors are ordered in their natural order</p>
</li><li>
<p>the "order" parameter of vectors is set accordingly<br />
Example:<br />
<img src="pics/OrderedWrong.png" alt="OrderedWrong.png" /> &larr;&gt; <img src="pics/OrderedCorrect.png" alt="OrderedCorrect.png" /></p>
</li></ul>
</p>
</li><li>
<p>split where needed<br />
Tests all vector lengths, if a vector is longer in any dimension than 127 "pixels" the vector is splitted in half. After processing there is no single vector that is "longer" than 127.</p>
</li><li>
<p>fill gaps (with move vectors)<br />
This ensures all points are connected (but no circular connection is formed, meaning start and end points are not connected). "Ordering" is invoked upon start, apart from reordering no vectors are changed, new vectors are inserted, where gaps were found. The new vectors are always "moves" (pattern = 0), new vectors are always smaller than 128.<br />
<img src="pics/noFilled.png" alt="noFilled.png" /> &larr;&gt; <img src="pics/gapsFilled.png" alt="gapsFilled.png" /></p>
</li><li>
<p>remove dots<br />
</p>
</li><li>
<p>fit byte<br />
enlarges/shrinks the current vectorlists to optimally fit into the byte range<br />
</p>
</li></ul>
</p>

<p><b>Note!</b><br />
There are "strange" cases of vectorlists, when above implemented shortcuts may not lead to optimal results. One simple case is a construct like:<br />
<img src="pics/polygonError.png" alt="polygonError.png" /> <br />
</p>

<p>Here you see a start vector going off in one direction and the start location is JOINED with two other vectors (a three-way join) which forms a closed polygon.<br />
This and similar constructs are not easy to analyse and handle correctly. I have not even tried very hard - if you have vectorlists like that, please optimize them by hand!</p>
<h2>Animations / Scenario</h2>

<p>(for a picture look at "Rotation")<br />
Animations/Scenarios are both a collection of different vectorlists. I differ the two entities because one displays all vectorslists at the same time (scenario) the other plays each vectorlist after another (with a delay) to create the illusion of an animation. <br />
The datastructure and the handling in vecci are identical! <br />
In short what you can see/do:<br />

<ul><li>
<p><img src="pics/page_go.png" alt="page_go.png" /> &nbsp;&nbsp;<b>load animation</b><br />
Load an animaton from a XML-file, the current is overwritten.</p>
</li><li>
<p><img src="pics/page_save.png" alt="page_save.png" /> &nbsp;&nbsp;<b>save animation</b><br />
Save the current animation to a XML-file.<br />
</p>
</li><li>
<p>"add current"<br />
 adds the current edited vectorlist (a clone actually) to the current animation</p>
</li><li>
<p>"apply" <br />
if you edit the "current" animation frame (which is a clone of the frame!) you can use the apply button to actually apply the changes to the animation</p>
</li><li>
<p>"add view"<br />
adds the current "DISPLAY" of the current edited vectorlist to the animation. If you e.g. translocated of rotated the camera (see TAB "3d axis settings") the DISPLAY differes from the current vectorlist in the editor. With this button you can "use" the DISPLAY.</p>
</li><li>
<p>"revers"<br />
 reverses all animation frames</p>
</li><li>
<p>"&larr;" and "&rarr;"<br />
sets the next animation frame as the current edited (clone!) vectorlist.<br />
SHIFT clicking the buttons MOVES one animation frame in the corresponding direction!</p>
</li><li>
<p>"delete" <br />
 delete one animation frame (the current selected)</p>
</li><li>
<p>"clear" <br />
 completely clears the current animation</p>
</li><li>
<p>"join" <br />
 This joins all vectorlist entries in the current animation/scenario into one single vectorlist</p>
</li></ul>
</p>
<h2>Vecci format (Save/Load)</h2>

<p>The vecci save format is a straight forward XML-File with all data in appropriate sub structures.</p>

<ul><li>
<p>a VectorAnimation consists of n XML-structures of the type GFXVectorList</p>
</li><li>
<p>a GFXVectorList consists of n XML-structures of the type GFXVector</p>
</li><li>
<p>a GFXVector consists of 2 XML-structures of the type Vertex (start and end) and several atomic entities (int, double, string)</p>
</li><li>
<p>all Vertexes (even joined and supposedly relative vectors) are stored with ABSOLUT positioning information.</p>
</li><li>
<p>in a vectorlist "connected" vectorlist are connected via a unique ID of vectors, the unique ID is only guranteed to be unique in ONE saved XML file (be it GFXVectorList or VectorAnimation)</p>
</li></ul>

<p>If need should arise I can also provide a "JSON" format.</p>
<h2>Other stuff</h2>
<h3>Line</h3>
<br/><p align="center">
<img src="pics/line.png" width="306" height="258" /><br/>
<em>line</em></p><br/>

<p>Per default line "settings" are off. With the checkboxes visible above you can switch line settings on. Two options are available:
<ol><li>
<p>pattern<br />
Here you can set a pattern byte for the vectors to be used. The actual pattern is a the binary representation of the entered byte (you can enter either hex or dec numbers).<br />
The default pattern for lines is "255" which is a complete line.</p>
</li><li>
<p>intensity<br />
The default intensity is 63, which is half of the available max intensity of 127 (negative values - values higher than 127 - result in non visible lines on a real vectrex)</p>
<br />
</li></ol>
</p>

<p>Note:<br />
Within vecci "moves" are represented with a pattern of 0 (zero). Vectors with an intensity of 0 (zero) are still not visible, but are not considered "move" vectors by vecci.</p>

<p>The above settings are (if switched on) always used for the next drawn vectors. If you want to change already defined vectors you can do so too. <br />
Select (multi select is supported) the vectors you want to apply the new settings to, and press "set to selected" than the given values are applied.</p>
<h3>2d-Tools</h3>
<br/><p align="center">
<img src="pics/2dtools.png" width="303" height="263" /><br/>
<em>2d-Tools</em></p><br/>

<p>The tools under this tab are all applied directly to the currently edited vectorlist. The first three are "shortcuts" to processings which can be acchieved by other means in vecci, but are a bit "cumbersume" (one has to generate rotation animations an extract single lists from those)</p>

<p>The button "image to vector" is explained in its own "Vector image" section.</p>
<h3>Figure</h3>

<p>Ignore these for now...</p>
<h3>Faces- Hidden line removal</h3>
<br/><p align="center">
<img src="pics/faces.png" width="1491" height="870" /><br/>
<em>Faces</em></p><br/>

<p>Vecci is capable of doing a HLR (Hidden line removal) from the display of 3d-"figures". In order to do HLR following steps have to be considered:
<ul><li>
<p>the result of a HLR is a two dimensional vector list, which usually is unordered, not a polygon and not continous, so the export possibilities are somewhat restrained</p>
</li><li>
<p>a HLR only makes sense on a 3d "object"</p>
</li><li>
<p>to hide anything, there must be something where it can be hidden BEHIND, behind a line or a linesegment nothing can be hidden. Therefor the "objects" must have "faces" which represents a surface, plane, region, zone or whatever you want to call it</p>
</li><li>
<p>under the tab "faces" you can define, delete and see all faces that are currently defined</p>
</li><li>
<p>the only way to define a face (apart from loading a file) is to select "points" in your vectorlist and press "add selected as face"</p>
</li><li>
<p>the selected points must all lie within one plane (coplanar), otherwise they will not be accepted as a face</p>
</li><li>
<p>the selected points must be sufficient to <i>define</i> a plane (at least three points which are not colinear), otherwise they will not be accepted as a face</p>
</li><li>
<p>in order to define faces you must be in mode "POINT" (otherwise you can not select points)</p>
</li><li>
<p>you can select points either in the vector editing "grids" or in the table. Clicking in the table on one of the columns that displays a point - selects that point</p>
</li><li>
<p>multiple selection (as always) is possible holding SHIFT (also in table)</p>
</li><li>
<p>deselecting a point is also possible using the middle mouse button (on multi selection remember to keep shift pressed) (also in table)</p>
</li><li>
<p>Note: The table (due to using shift and the resulting multi selects in the table) does not display the selection corretly. Look at the editor grids to see which points are actually currently selected</p>
</li></ul>
</p>

<p>Moving points of a face can "destroy" the face. A face gets deleted automatically from the face list, when its points are no longer coplanar.</p>

<p>The HLR is executed with the 3d-settings which result in the DISPLAY image (that enables the user to chose the point of view to on the figure - see tab 3d-settings).</p>

<p>The result of the HLR is added to the animation/scenario list.</p>
<hr />
<h1>Import</h1>

<p>There are different ways you can import vectorlists into vecci.</p>
<h2>Text import</h2>
<br/><p align="center">
<img src="pics/veccytextImport.png" width="1210" height="413" /><br/>
<em>text import</em></p><br/>

<p>On the tab "import" the first tab is called "text import".</p>

<p>As text import I summarize imports that one can do via "copy / paste" of some kind of text, sourcecode or other "text" data.</p>

<p>The first textarea is the place where you must put the "text data" that should be imported. This usually should be done via a copy (from some other place) and paste (to the said textarea).</p>

<p>The next textarea is the "interpretation" area. Here is where vecci shows what is its interpretation of the text data you supplied. This will be filled once you press the "!" button (or another interpretation mode is selected &rarr; combobox).</p>

<p>To the complete right the black area is the same interpretation shown as a vecci vectorlist-display.</p>
<h3>How does this work?</h3>

<p>The text you enter is processed the following way:
<ul><li>
<p>it is assumed that the text is some kind of source code, this means</p>
</li><li>
<p>lines starting with "*" are discarded</p>
</li><li>
<p>(assumed) comments after a ";" are discarded</p>
</li><li>
<p>whitespaces and many other non-number characters are discarded</p>
</li><li>
<p>user defined "words" are discarded (see below the %R pattern type)</p>
</li><li>
<p>the resulting "words" are "cast" to integer (decimal or hex is recognized)</p>
</li><li>
<p>if the cast resulted in a number, the number is added to a data array</p>
</li></ul>
</p>

<p>After the above procedure vecci has an array of byte data, that array needs to be interpreted as a vectorlist. Here the user has to step in and help!</p>

<p>The upper right area of the textimport tab is occupied by a combobox. Here you can select what kind of (initially only) BIOS data format the data should be interpreted with.</p>

<p>Once you select an entry, vecci goes to work and shows you the result (in the interpretation as data "statements" and in the vector display window).</p>

<p>Initially vecci is supplied with the most used BIOS vector list formats, but you can add your own formats! That is what the next 4 textfields can be used for.</p>
<h3>Patterns</h3>

<p>The data is interpreted using patterns. The user can supply these patterns so that an arbitrary number of formats can be supported. The pattern in general can have 3 entries:
<ol><li>
<p>first line <br />
(this usually might be something like a "count"), this can be empty</p>
</li><li>
<p>line x<br />
every line between the first and the last line, here usually the vector list is kept in earnest</p>
</li><li>
<p>last line<br />
the last line can have a break criteria (or can be left empty),<br />
the break criteria always refers to the first byte of the next "line x"</p>
</li></ol>
</p>

<p>For examples look at the supplied BIOS format patterns.</p>

<p>Following symbols can be used in a pattern line:
<ul><li>
<p>only in line 1:
<ul><li>
<p>%C0 &nbsp;&nbsp;&nbsp; use byte as counter</p>
</li><li>
<p>%C+ &nbsp;&nbsp;&nbsp; use byte+1 as counter</p>
</li><li>
<p>%C- &nbsp;&nbsp;&nbsp;&nbsp; use byte-1 as counter</p>
</li><li>
<p>%I &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ignore byte</p>
</li><li>
<p>%X &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; move to x coordinate (relative), pattern = 0</p>
</li><li>
<p>%Y &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; move to y coordinate (relative), pattern = 0</p>
</li><li>
<p>%R"SOMETHING"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; removes in the complete interpretation the text SOMETHING (can be inserted multiple times)</p>
</li></ul>
</p>

<p>it only makes sense to have one of the "%C" statements in line 1!<br />
<br />
</p>
</li><li>
<p>only in line x:
<ul><li>
<p>%X &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x coordinate (relative)</p>
</li><li>
<p>%Y &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y coordinate (relative)</p>
</li><li>
<p>%X0 &nbsp;&nbsp;&nbsp; start x coordinate (absolut)</p>
</li><li>
<p>%Y0 &nbsp;&nbsp;&nbsp; start y coordinate (absolut)</p>
</li><li>
<p>%X1 &nbsp;&nbsp;&nbsp; end x coordinate (absolut)</p>
</li><li>
<p>%Y1 &nbsp;&nbsp;&nbsp; end y coordinate (absolut)</p>
</li><li>
<p>%P &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pattern</p>
</li><li>
<p>%B &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; brightness (intensity)</p>
</li><li>
<p>%M &nbsp;&nbsp;&nbsp;&nbsp; mode (see bios explanation)</p>
</li><li>
<p>%I &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ignore</p>
</li></ul>
</p>
</li><li>
<p>only in last line:
<ul><li>
<p>%0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end of list, when byte is 0</p>
</li><li>
<p>%1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end of list, when byte is 1</p>
</li><li>
<p>%+ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end of list, when byte smaller 128 (but not 0)</p>
</li><li>
<p>%- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end of list, when byte is greater equal 128 (unsigned byte obviously) [high bit is set]</p>
</li></ul>
</p>
</li></ul>
</p>
<h2>Examples</h2>

<p><b>Frogger</b><br />
</p>
<br/><p align="center">
<img src="pics/FroggerExample.png" width="1227" height="392" /><br/>
<em>Frogger example</em></p><br/>

<p><b>Patriots</b><br />
</p>
<br/><p align="center">
<img src="pics/PatriotsExample.png" width="1219" height="381" /><br/>
<em>Patriots example</em></p><br/>

<p><b>Vaboom</b><br />
</p>
<br/><p align="center">
<img src="pics/VaboomExample.png" width="1232" height="385" /><br/>
<em>Vaboom example</em></p><br/>

<p><b>Bresenham</b><br />
</p>
<br/><p align="center">
<img src="pics/BresenhamExample.png" width="1232" height="393" /><br/>
<em>Bresenham example</em></p><br/>

<p><b>Thrust</b><br />
</p>
<br/><p align="center">
<img src="pics/ThrustShipExample.png" width="1224" height="386" /><br/>
<em>Thrust example</em></p><br/>

<p><b>Spudster</b><br />
</p>
<br/><p align="center">
<img src="pics/SpudsterExample.png" width="1227" height="381" /><br/>
<em>Spudster example</em></p><br/>
<h2>Wavefront Object format</h2>
<br/><p align="center">
<img src="pics/Violine.png" width="926" height="310" /><br/>
<em>Wavefront file</em></p><br/>

<div class="code">
<p>OBJ (or .OBJ) is a geometry definition file format first developed by Wavefront Technologies for its Advanced Visualizer animation package. The file format is open and has been adopted by other 3D graphics application vendors. For the most part it is a universally accepted format.</p>

<p>The OBJ file format is a simple data-format that represents 3D geometry alone - namely, the position of each vertex, the UV position of each texture coordinate vertex, vertex normals, and the faces that make each polygon defined as a list of vertices, and texture vertices. Vertices are stored in a counter-clockwise order by default, making explicit declaration of face normals unnecessary. OBJ coordinates have no units, but OBJ files can contain scale information in a human readable comment line.</p>
</div>

<p>(Taken from Wikipedia)</p>

<p>Vecci is able to load WaveFront object files, only supported entities:</p>

<ul><li>
<p>vertex ("v")</p>
</li><li>
<p>faces ("f")</p>
</li><li>
<p>points ("p")</p>
</li><li>
<p>lines ("l")</p>
</li></ul>

<p>All other entities are ignored. Faces are imported to vecci faces so HLR is working out of the box with these files.</p>

<p>Beware! Many OBJ-files that can be found have hundreds and thousands of vectors, the above seen violine case can be loaded and edited in vecci - but displaying it on a vectrex uses about 500000 cycles! (0.3 seconds for one frame)</p>
<hr />
<h1>Export</h1>

<p>There are different ways you can export vectorlists from vecci.</p>
<h2>Text export</h2>
<br/><p align="center">
<img src="pics/VeccyExport.png" width="1508" height="421" /><br/>
<em>text export</em></p><br/>

<p>Text export is the "main" export vecci offers, all other exports (at the moment) must be user defined - but with user definitions you can probably export to any imaginable format (if you do know a little bit about java).</p>

<p>Anyway...<br />
</p>

<p>The export tab is divided into 2 main sections:</p>

<ul><li>
<p>Vectorlist export</p>
</li><li>
<p>Animation/Scenario export</p>
</li></ul>

<p>Following features are the same for both sections:</p>

<ul><li>
<p>the type of list/lists determine the type of saves that are available.</p>
</li><li>
<p>all export generated is put into the textarea to the right (and into the system clipboard, for immediate access)</p>
</li><li>
<p>if the checkbox "runnable" is checked (befor creating an export) a runnable vectrex sourcecode is generated (and also put into the textarea, source is ment as an EXAMPLE not as clever programming!)</p>
</li><li>
<p>if a runnable source is generated, the button <img src="pics/control_play_blue.png" alt="control_play_blue.png" /> is enabled, and by pressing it you start your generated vectrex binary in the emulator.</p>
</li><li>
<p>you can also change the source in the editor an run it afterwards. If "nothing" happened you entered a syntax error (check the log). If that is so, better copy and paste the text into vedi, there you can access error messages of assi directly</p>
</li></ul>

<p>Following types of exports are supported (if possible):<br />
 <br />
<tt> <b>Mov_Draw_VLc_a</b>     <br />
                                       This routine moves to the first location specified in vector list,    <br />
 and then draws lines between the rest of coordinates in the list.    <br />
   The number of vectors to draw is specified as the first byte in the     vector list.  The current scale factor is used.  The vector list has  <br />
 the following format:                            <br />
                      <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count, rel y, rel x, rel y, rel x, ...   <br />
                        <br />
 ENTRY DP = $D0                           <br />
                              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X-reg points to the vector list    <br />
                              <br />
 EXIT: X-reg points to next byte after list  <br />
                           <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D-reg trashed                   <br />
                                </tt></p>

<p> </p>

<p><tt><b>Draw_VLc      </b><br />
                                                                                                                    This routine draws vectors between the set of (y,x) points pointed    <br />
 to by the X register.  The number of vectors to draw is specified     <br />
 as the first byte in the vector list.  The current scale factor is    <br />
 used.  The vector list has the following format:     <br />
                                                                      <br />
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count, rel y, rel x, rel y, rel x, ...      <br />
                                                                        <br />
                      ENTRY DP = $D0                                <br />
                         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X-reg points to the vector list          <br />
                                                                        <br />
                         EXIT: X-reg points to next byte after list      <br />
                                                                      <br />
                         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D-reg trashed                           <br />
                        </tt></p>

<p><tt><b>Draw_VLp </b><br />
                                                                                                                         This routine draws patterned lines using the vector list pointed to   <br />
 by the X-register.  The current scale factor is used.  The vector     <br />
 list has the following format:                                        <br />
                                                                       <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pattern, rel y, rel x                                           <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pattern, rel y, rel x                                           <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.      .      .                                              <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.      .      .                                              <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pattern, rel y, rel x                                           <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x01                                                            <br />
                                                                       <br />
 The list is terminated by a pattern byte with the high bit cleared.   <br />
                                                                       <br />
 ENTRY DP = $D0                                                        <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X-reg points to the vector list                                 <br />
                                                                       <br />
 EXIT: X-reg points to the terminator byte                             <br />
                                                                       <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D-reg trashed                  <br />
</tt></p>

<p><b>Note!</b><br />
The BIOS Draw_VLp seems to be buggy, for the examples I provided a working version.</p>

<p><tt><b>Draw_VL_mode</b><br />
                                                                                                                   This routine processes the vector list pointed to by the X register.  <br />
 The current scale factor is used.  The vector list has the following  <br />
 format:                                                               <br />
                                                                       <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode, rel y, rel x,                                             <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode, rel y, rel x,                                             <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.      .      .                                                <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.      .      .                                                <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode, rel y, rel x,                                             <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x01                                                            <br />
                                                                       <br />
 where mode has the following meaning:                                 <br />
                                                                       <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt; 0  use the pattern in $C829                                   <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 0  move to specified endpoint                                 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 1  end of list, so return                                     <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt; 1  draw to specified endpoint                                 <br />
                                                                       <br />
 ENTRY DP = $D0                                                        <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X-reg points to the vector list                                 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$C829 contains the line pattern.                                <br />
                                                                      <br />
   EXIT: X-reg points to next byte after terminator                     <br />
                                                                        <br />
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D-reg trashed                                                 <br />
 </tt></p>

<p>Looking at the above definitions of these vectorlist types you can gather that not vectorlists can be exported with every list type. <br />
There is one thing <b>all</b> these routines have in common, they all only take <i>relative</i> positioning information. That is the reason why you can export only vectorlists, which can be drawn in one "go". <br />
"In one go" is again relative :-()! Since some formats accept patterns or mode bytes. Using these it is possible to sneak some invisible vectors (pattern = 0) into a list. Thus you can still draw them in one go, but some drawings are simply invisible.</p>

<p>The only possible way to draw totally "disjunct" vectorlists is doing so with a scenario. (You might not use the scenario option with vecci, but drawing two or more vectorlists seperately is just exactly what a scenario does...)</p>

<p><b>Note:</b>!<br />
The formats: Draw&nbsp;VLx have no way to "place" the vectorlist. The vectorlist is drawn at the "current" place with the first relative coordinate. Keep that in mind, when you wonder why it looks "displaced". (This is espacially queer if you have an animation, these seem to spin around themselfs...)</p>

<p><b>Note:</b>!<br />
In order to be able to export an animation be sure the "original" single vectors are exportable in the format you wish.</p>

<p><tt><b>Draw sync list</b><br />
     </tt>                                                                                                             This routine does not have BIOS pendant, with this type of list output of large non linear vectorlists can be achieved, which additionally are not prone (not very) to vectrex drift.</p>

<p>The list look a lot like the Draw_VL_mode format: <tt>                                                              <br />
                                                                       <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode, rel y, rel x,                                             <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode, rel y, rel x,                                             <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.      .      .                                                <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.      .      .                                                <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode, rel y, rel x,                                             <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x02 </tt></p>

<p>But the behaviour is a bit different. Following mode bytes are supported:
<ul><li>
<p>"0x00" move to the y, x (relative) </p>
</li><li>
<p>"0xff" draw to the y, x (relative) </p>
</li><li>
<p>"0x01" zero the integrators, reset offset, move to the designated start of the vectorlist and from there move to the y, x (relative) </p>
</li><li>
<p>"0x02" end marker</p>
</li></ul>
</p>

<p>As you see with this list it is possible to "resync" the beam in between drawing of the vectorlist. </p>

<p>For the above mentioned resync to be possible the call to the routine must provide additional information, as:<br />

<ul><li>
<p>U register, address of vectorlist</p>
</li><li>
<p>X register, the "absolut" position of the vectorlist to be drawn at</p>
</li><li>
<p>A register, the scalefactor for the positioning to the above start point</p>
</li><li>
<p>B register, the scalefactor the vectorlist itself will be drawn with</p>
</li></ul>
</p>

<p>Examples (runnable) for this type of vectorlist can be generated as for all others.</p>

<p><b>Note:</b><br />
The vectorlists build in vecci automatically resync at points in the list which are not connected. One additional parameter can be given to the generation of the list (textfield right beside the button). This is the maximum of vectors that are drawn without a resync (or -1, if only resyncs should be inserted at non connected vectors).</p>

<p>An example of the differences of a synced and not synced vectorlist:</p>
<br/><p align="center">
<img src="pics/FrogNotSynced.png" width="469" height="639" /><br/>
<em>Not synced</em></p><br/>
<br/><p align="center">
<img src="pics/frogSynced.png" width="459" height="639" /><br/>
<em>synced</em></p><br/>
<h2>Vectorlist export</h2>

<p>Look above...</p>
<h2>Animation/Scenario export</h2>
<h3>Animation</h3>

<p>In order to be able to save an animation in one format, <b>ALL</b> vectorlists of that animation must be saveable in that format!</p>

<p>If you use rotation, be sure to either have a correct startpoint, or use one of the Mov_Draw... or Mode... formats, otherwise it might happen, that you are "rotating" around the wrong point!</p>
<h3>Scenario</h3>

<p>Scenarios, since they MUST use positioning, can only ever be saved with the Mov_Draw... or Mode... formats.</p>

<p>Scenarios also make sense if you want to display LARGE vectorlists (say &gt;40 or 50 vectors), since it is very advisable to give the integrators some rest, if you zero them or at least reset them once in a while.</p>
<h2>Code export</h2>
<br/><p align="center">
<img src="pics/CodeGen.png" width="1511" height="424" /><br/>
<em>code export</em></p><br/>

<p>The following section is the same for vectorlists/animations/scenarios, I won't differentiate here.</p>

<p>Code export has the same prerequisites than the text - "Move..." export. Apart from that it differs greatly from text export.</p>

<p>Using the code export options allows you to export your vectors not as DATA statements, but as code, which actually draws vectors directly. If you are old enough to know the concept behind a library called Xlib (from DOS days) than you might recognize this as a <i>relative</i> to compiled bitmaps (although obviously these are no bitmaps!).</p>

<p>The general logic for the codeexport goes like this:
<ul><li>
<p>there is a template for "init" and "deinit" the code</p>
</li><li>
<p>there are different templates for "move", "draw", "patterned" draw</p>
</li><li>
<p>the different templates are exported for each vector as they are needed.</p>
</li></ul>
</p>

<p>Thats all - for large vectorlists (or animations/scenarios for that matter) HUGE pieces of code are generated (but nowadays you can bankswitch for all your needs).</p>

<p>The templates provided work fairly well, but they were done more in the spirit of an example than as well optimized code. You as the user can change them to your needs.<br />
Following templates are used:
<ul><li>
<p>"codeGenInit.template" </p>
</li><li>
<p>"codeGenMove.template" </p>
</li><li>
<p>"codeGenDraw.template" </p>
</li><li>
<p>"codeGenPattern.template" </p>
</li><li>
<p>"codeGenDeInit.template" </p>
</li></ul>
</p>

<p>They (as usually) can be found in the "template" directory! In order to set apropriate vectorinformation following keys are used for replacement in the above files:
<ul><li>
<p>%XRELPOS% - x relative position taken from the vectorlist</p>
</li><li>
<p>%YRELPOS% - y relative position taken from the vectorlist</p>
</li><li>
<p>%PATTERN% - pattern taken from the vectorlist</p>
</li><li>
<p>%INTENSITY% - intensity taken from the vectorlist (not used in the provided examples)</p>
</li><li>
<p>%UID% - each call to a template is done with a unique ID, that way you can insure the use of different branch addresses  </p>
</li></ul>
</p>
<h2>User export</h2>

<p>Here a user can configure (meaning program) his own export routines. A simple example is given, as of now I will not elaborate these settings.</p>
<hr />
<h1>Vector images</h1>
<br/><p align="center">
<img src="pics/VectorPanel.png" width="1070" height="747" /><br/>
<em>vectorized image</em></p><br/>

<p>Using this panel you can convert raster images to vectorized images.</p>

<p>This panel is accessable from vedi and from vecci. Output of source code is not directly supported, you have go "thru" vecci.</p>

<p>The conversion is done in a number of steps:
<ol><li>
<p>The orginal image is loaded</p>
</li><li>
<p>The original image can be "transformed" using despeckle and/or blur tools, to be less noisy</p>
</li><li>
<p>These transformations are visible on screen in the left most panel</p>
</li><li>
<p>The image is than converted to black and white, for this also a threshold can be given</p>
</li><li>
<p>The resulting image is displayed in the middle panel</p>
</li><li>
<p>The b/w image is than shoveled to potrace (an external program)</p>
</li><li>
<p>The resulting vector informations are loaded and the configurable transformations:
<ul><li>
<p>minimal vector length</p>
</li><li>
<p>minimal vector angle</p>
</li></ul>
</p>

<p>are applied.</p>
</li><li>
<p>The resulting "vectrex"- vectorlist is displayed in the rightmost panel.</p>
<br />
</li></ol>
</p>

<p><b>Note!</b><br />
This is the only place where Vide makes use of an external program and this tool therefor might not be available on all installations.<br />
With Vide I provide potrace for <i>Windows (32bit/64bit), Mac (32bit/64bit) and Linux (32bit/64)</i> I have tested most of these configurations, if there are any problems, please consult Malban!</p>

<p>The reason I used potrace as an external program is simply that I didn't have the energy and/or interest, to translate the open source software (potrace) to java just to build a cool (but probably seldom used) feature!</p>
<h2>Behind the Scene</h2>

<p>The idea to that menu entry was born while doing the "badapple" tryouts (see blog: <a target="_blank" href="http://malban.de/extreme-vectrex-reproduction-of-badapple">http://malban.de/extreme-vectrex-reproduction-of-badapple</a>).</p>

<p>A while I thought about implementing my own "conversion" routines, but after doing some diggings for algorithms and what would be needed, I decided to take a shortcut and let the main conversion being done by potrace. There are binaries available for nearly every OS-brand. Vide now sports a directory: "externalTools" which contains binaries for win/mac/linux in 32bit and 64bit version. Potrace is called from Vide, my testing showed it works on my systems rather well (tested: Win32, Win64, Mac64 and Linux32).</p>

<p>Potrace does only accept b/w images and only bmp, but can generate (with the right settings) nice vector images, even usable for vectrex purposes. If interested, for the images Malban used the same values SpritesMods used, namely:</p>

<p><tt>potrace -a0 -O1 -bgeojson -ooutFile inFile<br />
<br />
-a0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:is alphamax = 0 &rarr; output has no smooth corners, it is a <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;polygon, not a spline<br />
-O1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set the curve optimization tolerance, one is very high <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inaccurate but less vectors<br />
-bgeojson :output in json format (easy readable)<br />
<br />
</tt></p>

<p>Generating the BW image is done by using a simple "Threshold"-Filter (threshold can be configured). The resulting json-datafile which is generated by potrace is read by Vide and post-processed. Here again I took lead by the groundwork done by SpritesMods - as you can see in the above image, two other parameters can be set: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimal vector length<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimal vector angle<br />
<br />
Vectors which are shorter then the given length are "joined" to their neighbours (or totally omitted) and vectors which have an angle less than the given value in relation to each other are also joined. Using these reduction scheme one can generate âtolerableâ vector images.</p>
<hr />
<h1>assi</h1>

<p>There is no wonderfull screenshot available, since assi is more or less "internal".</p>

<p>First:<br />
</p>

<p>Assi is a code adaption of a java 6809 assembler called "asmj".<br />
 (sourceforge: <a target="_blank" href="http://sourceforge.net/projects/asmj/">http://sourceforge.net/projects/asmj/</a>) developed by <i>Bill Yakowenko</i>. <br />
The sources in the sourceforge zip, the svn version and the binaries are not complete nor compatible. I tried reaching out to the author, but have received no feedback yet. I fixed the part I am interested in - so that it works for me. The source is public domain. <br />
<b> Thank you for programming ASMJ and for making it available as public domain! </b></p>

<p>The assembler syntax of the original asmj is still in working order! See the section in this documentation.</p>

<p>Regardless of that I made many changes to the assembler - pragmatic changes that do work, but didn't make the source more compatible. I have not even tried. From the original sources I pried out the 6809 part I needed and fed the rest to the wolves.</p>

<p>In general I tried adding compatibilty to the assembler from  Frank A. Vorstenbosch, Kingswood Software, AS09 - since that was for a long time my assembler of choice and nearly all of my own programs I did for vectrex are AS09 written.</p>

<p>Here I will write down the changes I did to asmj.<br />
(in no particular order)<br />
</p>

<ul><li>
<p>assi is not so sensitive about whitespaces as asmj. Whereever it finds some, it ignores them. The original asmj would throw errors if an expression or a list of binary data contained any spaces.</p>
</li><li>
<p>added pseudo opcode "direct" for direct pages register recognition</p>
</li><li>
<p>added "&lt;" prefix for direct addressing</p>
</li><li>
<p>added pseudo opcodes for data handling (db, dw, ds)</p>
</li><li>
<p>added operator "lo" and "hi", to get the lower/higher part of a 16bit address</p>
</li><li>
<p>added pseudo macro opcode "local" to predefine a local macro label</p>
</li><li>
<p>macros can now have "named" parameters</p>
</li><li>
<p>added a second "escape"-sequence for macro parameters (as09 uses \, asmj uses &amp;)</p>
</li><li>
<p>if assi knows about the DP register and an "extended" address comes along which fits &rarr; it will use direct addressing (jsr/jmp are dangerous, I left them out!)</p>
</li><li>
<p>assi accepts ";" as a comment char</p>
</li><li>
<p>assi can do end of line comments</p>
</li><li>
<p>assi accepts "_" as a first label character</p>
</li><li>
<p>assi accepts ":" as a label "end marker"</p>
</li><li>
<p>assi register names can be both, upper and lower case!</p>
</li><li>
<p>"=" synonym for "equ"</p>
</li><li>
<p>flag for automatic use long branches if short ones don't fit</p>
</li><li>
<p>long range branches can't be out of range (was a bug in the original asmj)</p>
</li><li>
<p>more freely use of "#" possible, is not syntax correct, but doesn't do any harm either</p>
</li><li>
<p>BSS, DATA, CODE, STRUCT, ALIGN, PAGE, TITLE, LIST, NOLIST,as dummy opcodes (they do nothing yet - but do not give compiler errors either :-))</p>
</li><li>
<p>OPT, NOOPT <br />
slight optimization (started)
<ul><li>
<p><i>lbra</i> are converted to <i>jmp</i> (save one cylce), the instruction is one byte shorter, this byte is filled with a NOP (AS09 does the same, otherwise more passes are needed, since addresses and memory keeps changing)</p>
</li><li>
<p><i>lbsr</i> are converted to <i>jsr</i> (see above)</p>
</li><li>
<p><i>jmp</i> with jumps over a short range are converted to <i>bra</i> (see above) </p>
</li><li>
<p>other long branches are not converted to shortbranches, since the <i>nop</i> filler would waste the cycles - an information is given in output nonetheless</p>
</li></ul>
</p>
</li><li>
<p>short branches are converted to long branches if offset is to high (warning is given in output)</p>
</li><li>
<p>still more compatability added</p>
</li><li>
<p><i>lo</i> was added befor, I forgot <i>hi</i>...</p>
</li><li>
<p>assi saves "*.CNT" files (for dissi) after successfull assembly</p>
</li><li>
<p>comments on macro lines are now associated with the "lines" created from the macro, not with the "address" where the macro was defined (in the source)</p>
</li><li>
<p>bug from original fixed, a branch defined by offset, rather than by label was not handled correctly (e.g. BNE $6 would jump to address $6 rather than 6 bytes ahead)</p>
</li><li>
<p>bug from original, CWAI was treated as an inherent instruction, although it expects an immediate parameter</p>
</li><li>
<p>added pseudo opcode "bank x", so that assi can discern different main files, and give output to other programs in the building chain.</p>
</li><li>
<p>TFR a, b now works too! (space is ignored)</p>
</li><li>
<p>expressions &gt; 65536 can be calculated (befor there was a limit to each value of 65536. This sounds ok, but if you want to calculate 1500000/25 &nbsp;&gt; that gives garbage!</p>
</li><li>
<p>if supports now "=", befor it only supported "=="</p>
</li><li>
<p>corrected File seperator in assi, befor it was hardcoded "\", now "File.seperator"</p>
</li><li>
<p>support for "SP" as stack register (befor only "S" was allowed) </p>
</li><li>
<p>added "Krumlinde" (sources to Thrust) compatabilty, which means many small steps towards more AS09 compatabitly, like implementing:
<ul><li>
<p>struct</p>
</li><li>
<p>cmap</p>
</li><li>
<p>and many other small things </p>
</li></ul>
</p>
</li></ul>

<p><b>not compatible, not changed, and will not change:<br />
</b>
<ul><li>
<p>undefined labels in AS09 are initialized with 0, so you can check if a label is defined by  <br />
<i>if LABEL != 0</i><br />
</p>
</li><li>
<p>asmj has a "proper" "<i>ifdef</i>" syntax, I like that better!</p>
</li><li>
<p>actually - as an option that <b>IS</b> supported now</p>
</li></ul>
</p>
<h1>Differences to AS09</h1>

<p>There are a few differences which I did not "correct", since it either was trivial or would have resulted in very huge changes to asmj internally. Following are the differences I am aware of:
<ul><li>
<p>"<b> * </b>" the Symbol for HERE. In AS09 this symbol represents the <b>begin</b> of the current instruction. In asmj the "<b> * </b>" represents the address <b>after</b> the current instruction!<br />
that means a code like <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blo&nbsp;&nbsp;&nbsp;&nbsp;*+4&nbsp;&nbsp;&nbsp;&nbsp; in AS09 translates to $25 $02<br />
<br />
To achieve the same in assi:<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blo&nbsp;&nbsp;&nbsp;&nbsp;*+2&nbsp;&nbsp;&nbsp;&nbsp; in Assi translates to $25 $02<br />
(This 
<ol><li>
<p>can not be easily changed, since assi uses the "*" symbol for internal calculations quite regularily</p>
</li><li>
<p>the usage of asmj (if you look at the resulting machine code) is more "real" )</p>
</li></ol>
</p>
</li><li>
<p>if<br />
asmj can as of yet not concatinate conditions with &amp;&amp; or ||. Here you have to use more than one if to circumvent</p>
</li><li>
<p>if - second...<br />
 asmj has two sets of if's one for expressions, this is the "normal" if, and one set for string comparison ifeq.</p>
</li><li>
<p>optmize<br />
optimization is not as "good" as AS09 (no optimize for long branches to short branches e.g.)</p>
</li></ul>
</p>
<hr />
<h1>asmj - original syntax</h1>

<p>(more or less a copy of the page at <a target="_blank" href="http://asmj.sourceforge.net/doc/syntax.html">http://asmj.sourceforge.net/doc/syntax.html</a>, omitted are the command line options, since they are not relevant for VIDE, also omitted are reference to other processors than the 6809)</p>

<p>Asmj syntax Last revised: 23-Nov-2003</p>
<h1>1. Notation<b></b></h1>

<ul><li>
<p>Syntax is just a pattern that describes the strings of characters that we accept. For the sake of brevity, we take some shortcuts. For instance, some instructions require an operand, while others do not allow one; the operand is almost never optional. But our generic pattern for an operation line shows an optional operand, because in an imprecise way they are "sometimes" required.</p>
</li><li>
<p>We use a kind of Backus-Naur Form (BNF) to describe patterns. This lets us build bigger patterns from littler ones. A pattern definition begins with a word that we use as a name for the pattern, followed by the symbol "::=", which you could read as "is defined as". Following that are the elements that make up the pattern. Definitions can cover multiple lines, and are often spread out more than is really necessary just to make them more readable. A pattern ends just before a line that is either blank or begins another pattern definition (which you recognize because it contains the "::=" definition symbol).</p>
</li><li>
<p>The simplest element is a literal string in quotes. A string matches this pattern element if it consists of exactly the characters between the quotes, in the same order.</p>
</li><li>
<p>A pattern element enclosed in square brackets matches either the empty string, or the string that matches the enclosed element. Informally, this means the enclosed pattern element is optional, and may be omitted.</p>
</li><li>
<p>If several pattern elements appear one after the other, separated by white space, then a string matches the pattern if the string can be chopped into pieces that match the individual pattern elements in that order. Informally, this means that the parts are appended together.</p>
</li><li>
<p>If a pattern element is followed by an elipsis (three dots), then it matches a string made of one or more substrings that each match the element. Informally, this is for patterns that can be repeated one or more times. (If you want "zero or more", use square brackets to make the whole thing optional.)</p>
</li><li>
<p>If two pattern elements have a vertical bar between them, then the pattern matches any string that matches either one of them. Informally, this is how to make an "either this or that" pattern.</p>
</li><li>
<p>If a word is enclosed in angle brackets (less-than and greater-than signs), then the word must be the name of a pattern, and it matches any string that matches that named pattern. This is how to make bigger patterns from littler ones. We sometimes cheat a little and put an English description here that has not been defined. For instance, we used &lt;anything&nbsp;but&nbsp;single&nbsp;quote&gt; to mean any character other than the single-quote character """. If this bothers you, feel free to formalize those definitions and write them into your copy of this document. :-)</p>
</li><li>
<p>If you read a pattern strictly from left to right, you may not always get what you want. This is just like in math, where you have to do the multiplications before the additions, even if the addition came first. This is called "precedence"; in math, multiplications get higher precedence than additions. In our patterns, elipses (repetition) gets the highest precedence, followed by spaces (appending), then vertical bars (either-or). In a pinch, we allow parentheses to group things, just as you would in math.</p>
</li><li>
<p>By way of example, we will use BNF to describe the BNF notation itself.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax ::= &lt;definition&gt; ... <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;definition ::= &lt;word&gt; "::=" &lt;element&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;element ::= &lt;string&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;option&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;append&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;repeat&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;either&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;element&nbsp;name&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;grouping&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string ::= '"' &lt;anything&nbsp;but&nbsp;double&nbsp;quote&gt; ... '"'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| "'" &lt;anything&nbsp;but&nbsp;single&nbsp;quote&gt; ... "'"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;option ::= "[" &lt;element&gt; "]"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append ::= &lt;element&gt; ( " " &lt;element&gt; ) ...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat ::= &lt;element&gt; "..."<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;either ::= &lt;element&gt; "|" &lt;element&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;element&nbsp;name ::= "&lt;" &lt;word&gt; "&gt;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grouping ::= "(" &lt;element&gt; ")"<br />
<br />
 <br />
</p>
</li></ul>
<h1>2. The Input File</h1>

<p>Asmj expects its input file to contain assembly language source code. Each line of the input file can have either one operation, a comment, or be blank (all white-space or length of zero). </p>

<p>a) Comment lines<br />
Comment lines are discarded by the assmbler, but are used by the programmer to leave notes for humans to read. Blank lines are considered as comment lines.<br />
<br />
 A comment line consists of some number of white-space characters (possibly zero), followed by an asterisk, followed by anything else. The entire line is discarded. Blank lines are also discarded, and can be considered as comment lines.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spaces ::= " " ... <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;commentline ::= &lt;spaces&gt; "*" &lt;anything&gt; <br />
 &nbsp;</p>
</div>
<h2>Operation lines<br />
</h2>

<p>Each operation line consists of a label word beginning with the very first character of the line, followed by one or more white-space characters, followed by the operation name, followed by one or more white-space characters, followed by the instruction's operand, followed by one or more white-space characters and a comment. The label may almost always be ommitted (except with the "equ" pseudo-op), in which case the line must begin with a white-space character. The trailing comment (and the spaces immediately preceding it) is ignored if present, and may always be ommitted. For some instructions, the operand may also be ommitted.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s ::= &lt;spaces&gt; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opline ::= [label] &lt;s&gt; &lt;op&gt; [&lt;s&gt; &lt;operand&gt;] [&lt;s&gt; &lt;comment&gt;] <br />
 &nbsp;</p>
</div>

<p>A label can consist only of letters, digits, and underscores, and cannot begin with a digit. Labels are case-sensitive. Operation names are all made of letters and digits, and are not case-sensitive. An operation can be either a machine instruction or a "pseudo-op". The machine instructions can be grouped into a small handful of sets, where all of the instructions in a set share the same syntax. The pseudo-ops are more varied. An operand is typically made of a number with some other stuff telling what the number means. This is explained more under "Operand in memory" below. For now, just note that the number can be given in several forms.</p>
<h3>Numeric expressions<i><br />
</i></h3>

<p>A number can be specified in decimal, hexadecimal, ASCII, or as a symbol which was defined elsewhere to have a numeric value; or it can be a mathematical formula combining these elements.</p>
<h4>Decimal numbers</h4>

<p>A number is specified in decimal as a simple sequence of digits, exactly as you would expect. For instance, seventy-eight is 78 . Nothing complicated here.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;digit ::= "0"|"1"|"2"|"3"|"4"|"5"|"6"|"7"|"8"|"9"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decimal&nbsp;number ::= &lt;digit&gt;...<br />
 &nbsp;</p>
</div>
<h4>Hexadecimal numbers</h4>

<p>                A number is specified in hexadecimal as a "0x" prefix, followed by a sequence of hexadecimal digits. A hexadecimal digit is a decimal digit or a letter from "a" to "f". (This is not case-sensitive; you could use upper-case "A" to "F" if you like.) For instance, seventy-eight is 0x4E .</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hex&nbsp;digit ::= &lt;digit&gt;|"A"|"B"|"C"|"D"|"E"|"F"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hex&nbsp;number ::= "0x" &lt;hex&nbsp;digit&gt;...<br />
 &nbsp;</p>
</div>
<h4>ASCII strings</h4>

<p>                A string is just a sequence of characters between matching quotes. If single-quotes are used to delimit the string, then it may contain any number of unescaped double-quotes, and vice-versa. But whichever kind of quote is used to delimit the string, that kind can occur in the string only in escaped form (see below) or else it would be mistaken for the quote that marks the end of the string. In the definition below, we gloss over the fact that the delimiting quotes must match, and that they can occur within the string only if escaped. But you know the truth.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quote ::= "'" | '"'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escape ::= &lt;backslash&gt; &lt;anyCharacter&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character ::= &lt;nonQuote&nbsp;nonBackslash&gt; | &lt;escape&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string ::= &lt;quote&gt; &lt;character&gt;... &lt;quote&gt;<br />
 &nbsp;</p>
</div>

<p>                Strings are used as such in a few pseudo-ops, such as the filename when including other assembly source files, or when creating constant text in memory. But strings can also be treated as numbers. Each character of the string forms one byte of the number. If the string is longer than two characters, all of them after the second are discarded whenever the string is used as a number. For instance, seventy-eight could be represented as "N', or as "0N', or as "0Nthese extra bytes are discarded when making a number'.</p>

<p>                Between the quote-marks, the backslash character is treated specially: the backslash and the following character both are used to represent a single byte. In most cases, the byte represented is just the character that followed the backslash. But if the character after the backslash was the lower-case letter "n", then those two characters together ("n") represent the byte for the new-line character (ASCII value 10). Other special characters can be represented this way too. Representing a character this way is called an escape, because it is a way of letting the character escape from its normal meaning. The following table shows them all.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>code&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASCII<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; represented&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name<br />
</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'\0'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;null<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'\a'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alarm/bell<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'\b'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;backspace<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'\f'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form feed<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'\n'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newline/linefeed<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'\r'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carriage return<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'\t'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tab<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'\v'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vertical tab<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'\''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;39&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single quote<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'\"'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double quote<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'\\'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;92&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;backslash<br />
 &nbsp;</p>
</div>

<p>                In situations where a limited number of bytes are expected, such as when loading a number into a register, the same rules are followed as for any other number: the least significant byte(s) of the number are used, and the rest are discarded. This produces an odd effect: when a string of two or more characters is used as the data to load into a one-byte register, the second byte of the string is the one that is used. Here is why. Whenever a string is treated as a number, its first two characters are taken. But when a number is put into a one-byte register, its least significant byte is used. The least significant byte of the first two bytes of a string is the second byte.</p>
<h4>Processor-specific syntax</h4>

<p>Additional syntax for numeric constants is available for each family of processors, according to the tradition of their manufacturers. </p>

<p>Syntax of 68xx-family hexadecimal numbers</p>

<p>For 68xx processors, numbers can be specified with a prefix that indicates the base. The prefix is a single character.</p>

<p>Decimal numbers<br />
    A decimal number needs no prefix; lack of any special prefix indicates that the number is decimal.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decimal&nbsp;digit ::= "0"|"1"|"2"|"3"|"4"|"5"|"6"|"7"|"8"|"9"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decimal&nbsp;number ::= &lt;decimal&nbsp;digit&gt;...<br />
 &nbsp;</p>
</div>

<p>    Hexadecimal numbers<br />
A hexadecimal number is indicated by a dollar-sign prefix. This is exactly equivalent to the processor-neutral form in which "0x" is used as the prefix. (This does not displace the processor-neutral syntax; either prefix may be used to the same effect.)</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hex&nbsp;digit ::= &lt;decimal&nbsp;digit&gt;|"A"|"B"|"C"|"D"|"E"|"F"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hex&nbsp;number ::= "$" &lt;hex&nbsp;digit&gt;...<br />
 &nbsp;</p>
</div>

<p>    Octal numbers<br />
An octal number is indicated by an at-sign prefix.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;octal&nbsp;digit ::= "0"|"1"|"2"|"3"|"4"|"5"|"6"|"7"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;octal&nbsp;number ::= "@" &lt;octal&nbsp;digit&gt;...<br />
 &nbsp;</p>
</div>

<p>    Binary numbers<br />
A binary number is indicated by a percent-sign prefix.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary&nbsp;digit ::= "0"|"1"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary&nbsp;number ::= "%" &lt;binary&nbsp;digit&gt;...<br />
 &nbsp;</p>
</div>
<h4>Symbols</h4>

<p>A symbol can be defined by the "equ" pseudo-op (see below) to have a numeric value, or can be defined implicitly by being used as a label on any other operation. A symbol begins with a letter, and is followed by any sequence of letters, digits, and underscores. Any such word may be used as a symbol, but note that in places where a register name might be expected, any word that matches a register name will be treated as a register name, and not recognized as a symbol. So if you define a symbol to have the same name as a register, you will not be able to reference your symbol in those places. To be safe, avoid using register names as symbols. Symbol names are case-sensitive. Using a symbol definition, we may define the word "length" to have the value seventy-eight, and then we could use that word anyplace where we might have used 78 or 0x4E or "N' .</p>

<p>The asterisk is a special pre-defined symbol. It normally represents the address of the byte immediately following the current instruction, which is normally the address of the next instruction.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symbol ::= "*" | &lt;letter&gt; (&lt;letter&gt;|&lt;digit&gt;|"&nbsp;&nbsp;")...<br />
 &nbsp;</p>
</div>

<p>If the address of the next instruction depends on this instruction's argument value, such as for the org pseudo-op, then using "*" creates a circular dependency: the value of "*" depends on the value of the current instruction's argument, but that value depends on the value of "*". Another pseudo-op, "rmb' (called "ds' in 8080-land), produces the same problem. The solution is to give "*" a special meaning in those situations: it means the address of the <i>current</i> instruction, rather than the next one. This special meaning allows at least two potentially-useful constructs:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>Instruction&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Meaning</b><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rmb *%4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reserve up to the nearest word-aligned address <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org *+N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leave N bytes out of the object image<br />
 &nbsp;</p>
</div>

<p>Note that the decision of whether to use 6800 direct or extended addressing is not such a special situation. Although the value of the argument can have some impact on the instruction size, we do not have the same kind of circular dependency, because the difference in code size is just one byte; if it is not totally clear that direct addressing is possible, extended addressing will be used. Since using "*" in the argument of such an instruction makes it unclear whether direct addressing could work, the decision would be to use extended addressing, which then determines the instruction size and the value of "*".</p>
<h4>Formulas</h4>

<p>A number can be represented by a formula made of the preceding elements, the mathematical operations, and parentheses. For instance, given that we had defined the word length to mean three, we could specify seventy-eight by length*2+"B'+("m'-"a')/2 . Most of the operators of the "C" programming language are supported, listed below in order of decreasing precedence:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>operator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;meaning</b><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean negation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitwise NOT; 1's complement<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;integer negation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiplication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addition<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modulus; remainder after division<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addition<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subtraction<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift left<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift right<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;less than or equal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;less than<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;greater than or equal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;greater than<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;equal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not equal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitwise AND<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitwise XOR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitwise OR<br />
 &nbsp;</p>
</div>

<p>The syntax for formulas is simple, since it is independent of precedence.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;term ::= &lt;decimal&nbsp;number&gt; | &lt;hex&nbsp;number&gt; | &lt;string&gt; | &lt;symbol&gt; | "(" &lt;formula&gt; ")"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formula ::= &lt;term&gt; | (&lt;formula&gt; &lt;op&gt; &lt;formula&gt;)<br />
 &nbsp;</p>
</div>
<h3>Machine Instructions<br />
</h3>
<h4>Syntax of 6809 Machine Instructions</h4>

<p>Unless otherwise indicated, all words of all instructions (patterns whose names end in "&nbsp;instr") must be separated by one or more spaces. We omit those from the syntax expressions for brevity. In other patterns, there are no such omissions; spaces are needed as explicitly specified.</p>

<p>Inherent</p>

<p>Inherent instructions do not need any information to tell where to find the data to operate on; it is implicitly specified as part of the instruction itself. For instance, the "mul" instruction always multiplies the contents of accumulators A and B; it cannot multiply anything else. Syntactically, these are the simplest possible instructions.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inh&nbsp;op ::= "abx"|"daa"|"mul"|"sex"|"nop"|"rti"|"rts"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"swi"|"swi2"|"swi3"|"sync"|"cwai"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"asla"|"asra"|"clra"|"coma"|"deca"|"inca"|"lsla"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"aslb"|"asrb"|"clrb"|"comb"|"decb"|"incb"|"lslb"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"lsra"|"nega"|"psha"|"pula"|"rola"|"rora"|"tsta"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"lsrb"|"negb"|"pshb"|"pulb"|"rolb"|"rorb"|"tstb"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inherent&nbsp;instr ::= [label] &lt;inh&nbsp;op&gt; [&lt;comment&gt;]<br />
 &nbsp;</p>
</div>

<p>    Operand in memory</p>

<p>    Some instructions find one operand in memory (or at least compute an address as if they were going to do that) and can do so by any of several addressing modes. For brevity, our syntax diagram allows a few combinations that are actually illegal. For instance, store instructions cannot have immediate operands, jump instructions can have neither immediate nor direct operands, load-effective-address (lea&nbsp;) instructions can have only indexed operands, and the condition-register instructions (andcc and orcc) can have only immediate operands. But syntactically they all follow the same pattern, as shown below.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mem&nbsp;op ::= "adda"|"adca"|"anda"|"bita"|"eora"|"ora"|"suba"|"sbca"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"addb"|"adcb"|"andb"|"bitb"|"eorb"|"orb"|"subb"|"sbcb"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"cmpa"|"cmpb"|"cmpd"|"cmpx"|"cmpy"|"cmpu"|"cmps"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"lda" |"ldb" |"ldd" |"ldx" |"ldy" |"ldu" |"lds"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"sta" |"stb" |"std" |"stx" |"sty" |"stu" |"sts"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"asl"|"asr"|"clr"|"com"|"dec"|"inc"|"jmp"|"jsr"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"lsl"|"lsr"|"neg"|"psh"|"pul"|"rol"|"ror"|"tst"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"addd"|"subd" | "leax"|"leay"|"leau"|"leas"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"andcc"|"orcc"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mem&nbsp;arg ::= &lt;immediate&nbsp;arg&gt;|&lt;extended&nbsp;arg&gt;|&lt;direct&nbsp;arg&gt;|&lt;indexed&nbsp;arg&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mem&nbsp;instr ::= [label] &lt;mem&nbsp;op&gt; &lt;mem&nbsp;arg&gt; [&lt;comment&gt;]<br />
 &nbsp;</p>
</div>

<p>    The syntax of the operand depends on the addressing mode, as follows.</p>

<p>        Immediate</p>

<p>        The operand is the byte (or word) in memory immediately following the opcode. The operand argument begins with a pound-sign "#", followed by a numeric expression.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;immediate&nbsp;arg ::= "#" &lt;numeric&nbsp;expression&gt;<br />
 &nbsp;</p>
</div>

<p>        Extended</p>

<p>        The operand's address immediately follows the opcode in memory. The operand argument is just a numeric expression.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extended&nbsp;arg ::= &lt;numeric&nbsp;expression&gt;<br />
 &nbsp;</p>
</div>

<p>        Direct</p>

<p>        The byte following the opcode is used as the least significant byte of the operand's address. The most significant byte of the address is taken from the "direct page" register. The operand argument is a numeric expression representing the memory byte, followed by ",dp".</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;direct&nbsp;arg <tt>= &lt;numeric&nbsp;expression&gt; ",dp"<br />
 &nbsp;</tt></p>
</div>

<p>        Indexed</p>

<p>        This mode is itself quite varied, as the 6809 allows for many forms of indexed addressing. For constant-offset addressing, Asmj accepts hints to make the offset-length shorter than the default of two bytes. (The default applies when the offset involves symbols that have not yet been defined; since the assembler cannot determine the value of the offset when it need to reserve space for it, it must leave room for the largest possible one.) A prefix of a single less-than sign indicates that the length should fit into a single byte, while two less-than signs mean that the length should fit into the postbyte itself. This later form is only legal with constant-offset from a proper index register; it is not available for use with PC-relative addressing.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;register ::= "x" | "y" | "u" | "s"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumulator ::= "a" | "b" | "d"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexed&nbsp;indirect ::= "[" &lt;indexed&nbsp;direct&gt; "]"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| "[" &lt;numeric&nbsp;expression&gt; "]"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexed&nbsp;direct ::= &lt;constant&nbsp;offset&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;accumulator&nbsp;offset&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;auto&nbsp;increment&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constant&nbsp;offset ::= [&lt;numeric&nbsp;expression&gt;] "," &lt;index&nbsp;register&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  &lt;numeric&nbsp;expression&gt; ",pcr" <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumulator&nbsp;offset ::= &lt;accumulator&gt; "," &lt;index&nbsp;register&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auto&nbsp;increment ::= "," ("-"|"--") &lt;index&nbsp;register&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  "," &lt;index&nbsp;register&gt; ("+"|"++")<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexed&nbsp;arg ::= [ "&lt;&lt;" | "&lt;" ] ( &lt;indexed&nbsp;direct&gt; | &lt;indexed&nbsp;indirect&gt; )<br />
 &nbsp;</p>
</div>

<p>    Two-register</p>

<p>    The only two-register instructions are tfr and exg. Each needs a list of exactly two registers to act on, with the only limitation being that both registers must be the same size; it is illegal to transfer an 8-bit register to or from a 16-bit register.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;register&nbsp;8 = "a" | "b" | "cc" | "dp"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;register&nbsp;16 = "x" | "y" | "u" | "s" | "d" | "pc"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;two&nbsp;reg&nbsp;arg ::= &lt;register&nbsp;8&gt; "," &lt;register&nbsp;8&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;register&nbsp;16&gt; "," &lt;register&nbsp;16&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;two&nbsp;reg&nbsp;op ::= "tfr"|"exg"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;two&nbsp;reg&nbsp;instr ::= [label] &lt;two&nbsp;reg&nbsp;op&gt; &lt;two&nbsp;reg&nbsp;arg&gt; [&lt;comment&gt;]<br />
 &nbsp;</p>
</div>

<p>    Stack</p>

<p>    The only stack instructions are pshs/pshu and puls/pulu. Each needs a list of registers to push or pull, with the only limitation being that pshs/puls cannot push/pull the S stack pointer, while pshu/pulu cannot push/pull the U stack pointer. The operand argument is the list of register names, separated by commas, with no spaces between them.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;register ::= &lt;register&nbsp;8&gt; | &lt;register&nbsp;16&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stack&nbsp;arg ::= &lt;register&gt; [ "," &lt;register&gt; ]...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stack&nbsp;op ::= "pshs"|"pshu"|"puls"|"pulu"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stack&nbsp;instr ::= [label] &lt;stack&nbsp;op&gt; &lt;stack&nbsp;arg&gt; [&lt;comment&gt;]<br />
 &nbsp;</p>
</div>

<p>    Branch</p>

<p>    Branch instructions always need a single argument: the address to branch to. This can be any numeric expression, although in practice it will usually be just a symbol that was defined as the label of an instruction.</p>

<p>    Ordinary branch instructions (those that begin with "B") can only reach labels up to 127 (or -128) bytes away from the following instruction. Long branches (those that begin with "L"), on the other hand, can branch to labels at any distance.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch&nbsp;op ::= "bra"|"brn"|"bcc"|"bcs"|"beq"|"bge"|"bgt"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"bhi"|"bhs"|"ble"|"blo"|"bls"|"blt"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"bmi"|"bne"|"bvc"|"bvs"|"bpl"|"bsr"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"lbra"|"lbrn"|"lbcc"|"lbcs"|"lbeq"|"lbge"|"lbgt"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"lbhi"|"lbhs"|"lble"|"lblo"|"lbls"|"lblt"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"lbmi"|"lbne"|"lbvc"|"lbvs"|"lbpl"|"lbsr"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch&nbsp;instr ::= [label] &lt;branch&nbsp;op&gt; &lt;numeric&nbsp;expression&gt; [&lt;comment&gt;]<br />
 &nbsp;</p>
</div>
<h3>Pseudo-ops</h3>
<h4>68xx processors</h4>

<p>Syntax of 68xx-family pseudo-ops</p>

<p>fcb</p>

<p>"Form constant bytes" allows for leaving initialized byte data in memory. Its argument is a comma-separated list of numeric values, each stored in a single byte. Any value which is too large to fit in a single byte is shortened to its least-significant byte, except for strings in quotes which are treated as if each character was a distinct value in the list.</p>

<p>fcc</p>

<p>    "Form constant characters" is just the same as "fcb".</p>

<p>fdb</p>

<p>    "Form double bytes" is like "fcb", except that each value is stored in a pair of bytes, most-significant byte first. Just as for "fcb", characters of quoted strings are treated as if they were specified as individual values, which now means that they get two bytes each.</p>

<p>rmb</p>

<p>    This pseudo-op lets you "reserve a memory block" of a specified length. The contents of the block of memory are unspecified, and your program cannot depend on them to be initialized. The argument is a numeric expression telling how many bytes to reserve.</p>

<p>    Because the value of the expression determines the placement in memory of the following code, and therefore the value of the symbols defined there, the expression cannot contain forward references to those symbols; all symbols used in the expression must have values defined before the "rmb' itself.                </p>

<p>  </p>
<h4>Some are the same for all families of processor; these follow.</h4>

<p>end</p>

<p>This marks the end of the source file, and optionally tells the address at which program execution should start. If any operand is given, it is a numeric expression for the starting address. Text in the file after this line is not read by the assembler.</p>

<p>equ</p>

<p>This is used to "equate" a symbol with a value - to define it. Its operand is evaluated, and the line's label is entered into the symbol table with that value. This one of very few operations that require a label.</p>

<p>include</p>

<p>The "include" pseudo-op allows for reading from another file as if it were part of the specified source file. The operand is the filename in quotes. Such inclusions can be nested; the first included file can include another, and so on. Relative pathnames in an "include" are relative to the directory of the source file that contains the include. That is, if "/usr/bill/foo.asm" contains "include "lib/bar.asm", the actual file included is "/usr/bill/lib/bar.asm".</p>

<p>Beware of any file that "include"s itself! (Can you say "occurs check"? How about "unbounded recursion"?)</p>

<p>org</p>

<p>The origin is the address into which subsequent operations should be put. Its argument is a numeric expression; the address. If no "org" is given, the starting address is zero.</p>

<p>Because the value of the expression determines the placement in memory of the following code, and therefore the value of the symbols defined there, the expression cannot contain forward references to those symbols; all symbols used in the expression must have values defined before the "org' itself.</p>

<p>macro...endm</p>

<p>These pseudo-ops are used to define a "macro", which is a new mnemonic representing a series of instructions. The label on the macro line is the new mnemonic. All lines between the macro line and the endm line are scooped up together and saved for later use. Anyplace later in the program where that new mnemonic is used, it is a "call" to the macro, and all of those lines are substituted in place of the calling line.</p>

<p>To add flexibility, macros are allowed to take arguments. In the macro definition, lines may contain placeholders for arguments, which consist of an ampersand followed by a number or one of a few special characters. In the call to the macro, the new mnemonic can be followed by a comma-separated list of arguments, which are substituted for the numbered placeholders in the lines that replace the call.</p>

<p>The calling line consists of an optional label, spaces, the macro name, more spaces, the argument list, and then either the end of the line or some spaces followed by anything. The argument list cannot contain any white space.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;macroDefinitionHeadingLine ::= &lt;label&gt; &lt;spaces&gt; &lt;macroName&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;macroCall ::= [&lt;label&gt;] &lt;spaces&gt; &lt;macroName&gt; &lt;spaces&gt; &lt;argList&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg ::= &lt;nonWhiteSpace&nbsp;nonComma&gt;...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;argList ::= &lt;arg&gt; [ "," &lt;arg&gt; ]...<br />
 &nbsp;</p>
</div>

<p>                The argument list is treated as raw text; the arguments need not meet any syntactic restrictions, and can contain unbalanced parentheses or quotes, illegal expressions, and so on. Of course, the code resulting from the macro call will be assembled, and at that time it must be syntactically correct to succeed. But the arguments can be embedded in the line in any way that makes the result come out right; they need not make any kind of sense outside of those lines. For instance, the following two snippets of code produce the same object code:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;length equ 3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width equ 4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fnord macro <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&amp;1 length&amp;2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adda length*(width+7)  <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endm<br />
                	<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fnord a,*(width+7  <br />
 &nbsp;</p>
</div>

<p>References to arguments that were not supplied are replaced by the empty string, which is the same as if the placeholder was silently deleted. So if the argument list is too short, the result will have some missing parts. (This behavior can be exploited intentionally, of course). Similarly, no check is made that all of the supplied arguments are used; unused arguments are simply ignored. Argument number zero is special; it is the label from the calling line. An ampersand followed by a comma is always discarded, but can be useful if you want a number to immediately follow a placeholder; without something extra in there, the number would be read as part of the placeholder itself. An ampersand followed by a pound-sign expands to the number of arguments actually given on the calling line. An ampersand followed by an asterisk expands to the entire comma-separated list of arguments as given on the calling line. An ampersand followed by an at-sign produces a number that is unique to this macro invocation. (This is useful if the macro needs to define its own labels, but must generate different labels each time it is invoked to avoid production of conflicting definitions.) Finally, an ampersand followed by a any other character represents just that character. So, if you want the ampersand character to come out in the result of a macro call, it must be represented by two consecutive ampersands in the macro definition. This is particularly awkward if the macro contains a formula involving the logical AND operator "&amp;&amp;", which must now be represented as four consecutive ampersands.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>symbol&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expands to</b><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nothing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the label from the calling line<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;@&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a unique number<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the number of arguments<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the whole argument list<br />
 &nbsp;</p>
</div>

<p>                So the following code snippets produce the same result:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fnord macro <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "label=&amp;0"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "label=xyz"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "unique&nbsp;id=&amp;@"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "unique&nbsp;id=1"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "nothing=&amp;,"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "nothing="<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "num&nbsp;args=&amp;#"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "num&nbsp;args=4"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "all&nbsp;args=&amp;*"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "all&nbsp;args=AB,CD,EF,GH" <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "this &amp;&amp; that"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "this &amp; that"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "20th&nbsp;arg=&amp;20"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "20th&nbsp;arg="<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "2nd&nbsp;arg+0=&amp;2&amp;,0" &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "2nd&nbsp;arg+0=CD0"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
                	<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xyz fnord AB,CD,EF,GH<br />
 &nbsp;</p>
</div>

<p>                Parsing of macro definitions has higher priority than conditional compilation. When a macro definition is begun, all following lines are pulled into the definition until the macro-end is found. Those lines can contain conditionals, syntax errors, or anything else; the content is not noticed until the macro is called later. So a macro definition can contain the beginning of a conditional without its end, or vice-versa; but there is no way to specify that a conditional contains just the beginning or end of a macro definition.</p>

<p>                Macros can be recursive, using conditional compilation to prevent infinite recursion. The depth of macro expansion is limited to 65536.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left macro <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if &amp;1&gt;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asla <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asla&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asla <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left &amp;1-1  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asla <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asla <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asla <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asla <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asla <br />
 &nbsp;</p>
</div>

<p>                Because the expansion of recursive macros includes a lot of uninteresting lines associated with the conditional, the output listing of a macro call will show only those lines that actually generate code, and those lines that give rise to error messages.</p>

<p>                if...elseif...else...endif</p>

<p>                These pseudo-ops allow for conditional compilation - skipping over sections of the source code depending on the values of symbols and such. For instance, you might need to generate extra code to handle the case that the symbol "precision" has a value greater than 1. Or you might want to include some lines of code only if the symbol "debug" is defined. There are actually five different forms of the "if" part of the conditional; each will be explained below. All of them can have an "else", and all end with an "endif" pseudo-op.</p>

<p>                The "if" conditional allows testing of an arbitrary numeric expression to make its decision. Its argument is a formula, as described in the section under "numeric expressions". The formula is evaluated, and the result is considered to be true if it is not zero. The "if" can have any number of "elseif"s, each of which has its own condition just like the "if" did.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ::= [&lt;label&gt;] &lt;spaces&gt; "if" &lt;spaces&gt; &lt;formula&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif ::= &lt;spaces&gt; "elseif" &lt;spaces&gt; &lt;formula&gt;<br />
 &nbsp;</p>
</div>

<p>                Once again, the following code snippets produce the same result:</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;howmany macro<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if &amp;1&lt;=0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "&amp;1 is none"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif &amp;1&lt;=4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "&amp;1 is some"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif &amp;1&lt;=10<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "&amp;1 is lots"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "0 is none"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "2 is some"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "&amp;1 is too many"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "5 is lots"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcc "99 is too many" <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endm<br />
                    <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;howmany 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;howmany 2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;howmany 5<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;howmany 99<br />
 &nbsp;</p>
</div>

<p>                The "ifdef" and "ifndef" conditionals test whether or not a specific symbol has been defined. The argument is just a symbol name. The "ifndef" is the negation of "ifdef" - each is true when the other would have been false. These can each have an "else", but no "elseif".</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ifdef ::= [&lt;label&gt;] &lt;spaces&gt; ("ifdef"|"ifndef") &lt;spaces&gt; &lt;symbol&gt;<br />
 &nbsp;</p>
</div>

<p>                The "ifeq" and "ifneq" conditionals test whether two strings are identical. These can each have an "else", but no "elseif". Neither of the two argument strings can contain any white spaces or commas, because they are separated by a comma and ended by a white space character. Note that the strings are merely tested for equality; they are not evaluated as formulas or symbols. To see the difference, consider the statement "ifeq 1+1,2". The first argument is a string of three characters, the second is a string of only one character; the two strings are not equal to each other.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ifeq ::= [&lt;label&gt;] &lt;spaces&gt; ("ifeq"|"ifneq") &lt;spaces&gt; &lt;args&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg ::= &lt;nonWhiteSpace&nbsp;nonComma&gt;...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args ::= &lt;arg&gt; "," &lt;arg&gt;<br />
 &nbsp;</p>
</div>

<p>                The "ifeq" pseudo-op is mostly useful within a macro, in which one or both of the strings contain (or consist of) placeholders for macro arguments. (Otherwise the two strings would both be visible on the line, and the programmer would have noticed their equality and not needed a compile-time conditional to decide that.)</p>

<p>                Finally, note that "if", "elseif", "ifdef", "ifndef", "ifeq", "ifneq", "else", and "endif" are all pseudo-ops, and each must appear on its own line, like any other operation.</p>

<p>                error</p>

<p>                The error pseudo-op forces the assembler to generate an error message of your choosing. This is useful if you detect a problem by using conditional compilation, to make it clear that something is wrong, when it might not otherwise be obvious that there is a problem, or exactly what the problem is.</p>

<p>                exitm</p>

<p>                The exitm pseudo-op ends a macro expansion early. It is a convenience; you could always get the same effect with some combination of conditionals. It is typically used within a conditional, with the error pseudo-op. For instance, you may check that the arguments to a macro are reasonable using "if'. If it turns out that the argument values would cause illegal code to be generated, you could put in an exitm to prevent that. This makes the output cleaner, making it easier for the human to figure out where the real problem is, especially if used in conjunction with the error pseudo-op described above.</p>

<div class="code">
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift macro<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ifneq &amp;1,left<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ifneq &amp;1,right<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error "shift left or right, not &amp;1" <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exitm<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ifeq &amp;1,left<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asla<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asra<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endm<br />
 &nbsp;</p>
</div>
<hr />
<h1>vedi</h1>
<br/><p align="center">
<img src="pics/vedi.png" width="963" height="801" /><br/>
<em>vedi window</em></p><br/>
<h2>Editor</h2>
<h3>some "highlights":</h3>

<ul><li>
<p>double click on a  "include" tries to load the denoted file in an editor tab</p>
</li><li>
<p>search and replace works</p>
</li><li>
<p>tab, shiftab works as "indent"</p>
</li><li>
<p>middle mousebutton double click on a label/macro/variable jumps to the definition of that entity</p>
</li><li>
<p>there is a "pretty print" button for 6809 sources (only)</p>
</li><li>
<p>you can define and use up to 10 bookmarks</p>
</li><li>
<p>you can configure you syntax coloring settings</p>
</li></ul>
<h2>Buttons</h2>

<p><img src="pics/new.png" alt="new.png" /><br />
Create a new project or create an empty file.<br />
</p>

<p>Special:<br />
If in file system view pressing "shift"-new will create a "default" project on the current selected assembler file.</p>

<p><img src="pics/arrow_refresh.png" alt="arrow_refresh.png" /><br />
Refresh the current display tree (if you externally added files - e.g.).<br />
</p>

<p>Special:<br />
Pressing "shift"- refresh will switch the tree to a filesystem view within the Vide directory.</p>

<p><img src="pics/page_go.png" alt="page_go.png" /> Load a file.<br />
Pressing shift with the button, will reload the current edited file.</p>

<p><img src="pics/page_save.png" alt="page_save.png" /> Save the current file.<br />
Pressing shift with the button, will "save as" - opens a file dialog.</p>

<p><img src="pics/text_columns.png" alt="text_columns.png" /><br />
Pretty print the current source (assembler only).</p>
<h2>Assembling</h2>

<p>Pressing the button: <img src="pics/control_play_blue.png" alt="control_play_blue.png" /> <br />
<b>starts</b> the assembler with the current active file as input (file is automatically saved). If successfull, vecxi will automatically be started.<br />
The messages of assi can be viewed in the bottom tab called "ASM messages":</p>
<br/><p align="center">
<img src="pics/vediAss.png" width="987" height="596" /><br/>
<em>message window</em></p><br/>

<p>Pressing the button: <img src="pics/bug_go.png" alt="bug_go.png" /> <br />
starts <b> debugging</b> the assembler with the current active file as input (file is automatically saved). If successfull, vecxi will automatically be started.<br />
The messages of assi can be viewed in the bottom tab called "ASM messages". A breakpoint will be set automatically to the first valid instruction of the cartridge - dissi will popup and you can debug right away.</p>

<p>Pressing the button: <img src="pics/server_go.png" alt="server_go.png" /> <br />
starts the assembler with the current active file as input (file is automatically saved)  and if successfull (and a vecxi instance is already running) <b>injects</b> the built binary file into the currently running vecxi. Vecxi is not reset while doing this, you just âchangeâ the cartridge ROM while running. You can thus experiment with changes to your bin file on the fly without losing RAM data, PC address or breakpoints.</p>
<h2>Ask/F1</h2>

<ol><li>
<p>You can enter simple "expression" and use the ask field as a small calculator. Conversion between decimal, binary and hex is also supported.</p>
</li><li>
<p>You can enter names of (Bruce Tomlin - defined) BIOS routines, and a (stay on top) window displays a small help</p>
</li><li>
<p>You can enter Assembler mnemonics, and a help for the directive will be displayed</p>
</li></ol>

<p>Placing the cursor over such a "text" within the source, will do the same. </p>
<h3>Messages</h3>

<ul><li>
<p>error messages are colored red</p>
</li><li>
<p>warning messages are colored blue</p>
</li><li>
<p>optimization messages are colored green</p>
</li><li>
<p>info messages are colored black</p>
</li></ul>

<p>Error/Warning/Optimization messages are related to the assembled source. They allways consist of two lines of information:<br />
Line 1: What happened?<br />
Line 2: Where did it happen?<br />
</p>

<p>Doubleclicking on any of the two lines will jump to the source (will also open include files, if message is about an include).</p>

<p>The third tab on the bottom contains the listing output of the assembler. The Error/Warning/Optimization messages are also included in the "correct" places in the listing (although not double clickable to any effect).</p>
<h2>Syntax highlighting</h2>

<p>VIDE uses "Syntax" programmed by (c) Stephen Ostermiller. I slightly changed some code and did a flex grammar that covers some aspects of assi.  This was my first contact with flex and grammars, so the results are not 100% and probably not very efficient either.</p>

<p>The expressions that are possible with parenthesis and macro usage are IMHO nearly impossible to cover with a regular expression based scanner. After all, who would identify an opcode <i>lda</i> that is puzzled together by a macro, like:</p>

<div class="code">
<p>fillregister&nbsp;&nbsp;&nbsp;macro reg, val<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ld\1&nbsp;&nbsp;&nbsp;#val<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endm<br />
</p>

<p> &nbsp;&nbsp;&nbsp;fillregister a, 1 ; set a to 1<br />
&nbsp;&nbsp;&nbsp;fillregister b, 2 ; set b to 2<br />
</p>
</div>
<br/><p align="center">
<img src="pics/syntax.png" width="589" height="170" /><br/>
<em>syntax example window</em></p><br/>
<h2>Other features</h2>
<h3>Bookmarks</h3>

<p>Using SHIFT and CTRL (windows/linux) or CMD (apple) "1"-"0" you can define bookmarks. Using CTRL (windows/linux) or CMD (apple) "1"-"0" you can jump to defined bookmarks.</p>

<p>Bookmarks can be used "accross" files.</p>
<h3>Jump</h3>

<p>CTRL (windows/linux) or CMD (apple) "J" jumps to a line number.</p>
<h3>Recolor</h3>

<p>CTRL (windows/linux) or CMD (apple) "R" reapplies syntax highlighting. </p>
<h3>Run/Debug</h3>

<p>F5 runs the current project/file, F6 debugs the current project/file (same as the buttons).</p>
<hr />
<h1>projects</h1>
<br/><p align="center">
<img src="pics/NewProject.png" width="704" height="627" /><br/>
<em>new project window</em></p><br/>
<h3>What are projects?</h3>

<p>Projects regarding VIDE are in the simplest of terms directories which serve as a binding element for a bunch of files.</p>

<p>Projects are not really sophisticated entities.</p>

<p>As of now a project consists of:
<ul><li>
<p>a directory</p>
</li><li>
<p>a (xml) properties file, which mainly includes information about what file of all files in the directory is the "main" file (or main files in case of multiple banks)</p>
</li><li>
<p>if you build a project, the main file is always used as the starting point</p>
</li></ul>
</p>
<h3>Load</h3>

<p>Projects are represented by a XML-File with the name of the project in the directory of the project.</p>

<p>If you want to load a project - you have to load the corresponding XML file.</p>
<h3>New</h3>

<p>Projects can be created using the <img src="pics/new.png" alt="new.png" /> button in the main vedi window. After selecting new project, the above window is displayed and you can enter your project configuration. The name and the directory in which the project resides can not be altered later!</p>

<p>In the directory given, a new directory with the name of the project will be created! After the creation process has finished the project files are displayed in a tree view on the right side of the window.</p>

<ul><li>
<p>upon creation of a project you can select if your project should support bankswitching, if so you can chose between "standard" (two banks) or "VecFlash" (up to 64 banks)</p>
</li><li>
<p>you can chose to create code for each bank</p>
</li><li>
<p>each "main" - bank file is treated as such, upon project build the general idea is to create each bank seperatly and than join them to create a file vecxi will recognize as "bankswitchable" </p>
</li><li>
<p>each main file can support a "define" variable, that way you can "reuse" one main file and use assembler pseudo opcode "if" to define different sections for each bank in only one file</p>
</li></ul>

<p><b>Tree</b><br />
</p>
<br/><p align="center">
<img src="pics/projectPopUp.png" width="316" height="259" /><br/>
<em>project popup</em></p><br/>

<p>Right click on the tree elements pops up a PopupWindow :-)!</p>

<p><b>Root</b><br />
If you right click on the root of the tree you can chose to:
<ul><li>
<p>edit the properties</p>
</li><li>
<p>close the project</p>
</li><li>
<p>add files to the project</p>
</li><li>
<p>(and refresh the tree)</p>
</li></ul>
</p>

<p><b>add files</b><br />
Opens a file choser window which lets you select (multiple) files. All selected files are added to the project. Added here means literally: copied to the project directory - nothing more and nothing less!</p>

<p><b>edit properties</b><br />
Reopens the (very above) displayed window. Here you can change settings. Noteworthy are the two buttons:
<ul><li>
<p>configure script<br />
Here you can select (and create) Java files that you wish to execute befor and/or after a project build process. These are java programs which are interpreted. You can virtually do anything here as long as java can. In the simplest case you can call other programs thru a java "execute/invoke". This way you can for example access batch files after building to "transport" you new binaries to other places (like a real vectrex).</p>
</li></ul>
</p>

<p><b>Leaves</b><br />
If you right click on a leave following popup will be displayed:</p>
<br/><p align="center">
<img src="pics/vediFilePopup.png" width="281" height="408" /><br/>
<em>File popup</em></p><br/>

<ul><li>
<p>Properties<br />
(not done yet) <br />
Each file in a project can have seperate properties, while often these won't be neccessary, this can be used to configure mechanisms to build vectrex includable files from other formats (like mod, raster pictures, samples etc...) Here again you will be able to configure pre build actions which will consist of (again) java programs.</p>
</li><li>
<p>set main &rarr; a shortcut thats all</p>
</li><li>
<p>delete - deletes a file (or a directory) <b>NO QUESTIONS ASKED!</b> Be carefull!</p>
</li><li>
<p>rename - a file (or in java ways - click three times on a leave...)</p>
</li><li>
<p>duplicate - a file (gets a "copy" appended)</p>
</li><li>
<p>all the othr build/convert options are not yet done<br />
(but planned :-</p>
</li></ul>

<p><b>Java</b><br />
Will be realized as "beanshell" scripts (basically java 1.2 which can be run as a script, you can do everything java 1.2 can do, that means access file system, do input/output etc, execute system commands etc) (don't worry, I will provide examples)</p>
<hr />
<h1>Raster images</h1>
<br/><p align="center">
<img src="pics/raster1.png" width="962" height="713" /><br/>
<em>raster image</em></p><br/>

<p>On a popup you can convert images (png, bmp, gif and jpg) to vectrex raster images, but I wouldn't get my dreams up to high, image results in resolutions greater than about 150x100 "pixel" are probably out of the 30000 cylce limit! Raster display routine were hacked together in one afternoon, so you are invited to get more performance out of it!</p>

<p>Above you can see the actual conversion "tool". As one can see it is not completly finished, but it will probably stay the way it is implemented now for quite some time.</p>

<p>The image to convert is taken from the right clicked popup from above, the size is displayed.</p>

<p>Using "click" and "drag" - and thus build a selection in the source image - you can also use only partial image conversion.</p>

<p>On the left side you can see a "generated" vector image (the left slider zooms in/out), below the vector display you can give the resulting size - with this it is possible to resize the image any way you like.</p>

<p>One can chose what information to take for vector generation, the "color" - strength of a pixel (r+g+b/3) or the alpha channel. The slider on the right/bottom can be used to enter a threshold at what value a vector will be generated.</p>

<p>Also taken into account (although this could be optimized) is the fact, that shift register values are actually 9 bits instead of 8 (the last bit is repeated), the displayed vector list is updated with every change.</p>

<p>There used to be an option to include "brightness" data for the vector list. The generation routine is still in the code but disabled, since it performs so very badly, creating has been disabled.</p>

<p>Using the checkboxes to the left and the create button to the right generates code (and an example main program). </p>

<p>The data is output in binary-data-statements, that way (with some fantasy) you can still discern your image, although this is made more difficult with each alternating line, since the display routine is bidirectional, meaning the data of every second line is stored "backwards".</p>

<p>You can also generate uni directional data, for the difference of the two formats, look at the section in "Code Generation".</p>

<p>The format of the data is described in the (generated) source.</p>

<p> </p>
<hr />
<h1>Samples</h1>
<br/><p align="center">
<img src="pics/sample1.png" width="633" height="647" /><br/>
<em>Sample editor</em></p><br/>

<p>Using the popup on the tree of files in a project you can access the sample editor.</p>

<p>What you see is a gui to handle samples, handle means:
<ul><li>
<p>you are able to record samples on the fly (one can e.g. just talk to it (using a micro) after pressing the "record button")</p>
</li><li>
<p>you can also load (wav) sample files</p>
</li><li>
<p>you can "cut" selections of samples</p>
</li><li>
<p>you can play samples</p>
</li><li>
<p>you can "normalize" samples (no range compression though)</p>
</li><li>
<p>you can convert given samples to vectrex format (8 bit signed, one channel pcm)</p>
</li><li>
<p>you can set a desired sample rate</p>
</li></ul>
</p>

<p>For one reason or another, the tooltips can not be displayed on modal windows in Vide, for that reason some more information about the gui:
<ul><li>
<p><img src="pics/control_record_blue.png" alt="control_record_blue.png" /><br />
start recording your samples (easiest with a microphone, select the audio device via the combobox besides the microphone icon) For recording you can also chose in what "setting" you want to record, above the microphone you can see whether your selection of settings is accepted: 
<ul><li>
<p><img src="pics/help.png" alt="help.png" /> = unkown</p>
</li><li>
<p><img src="pics/accept.png" alt="accept.png" /> = ok</p>
</li><li>
<p><img src="pics/cancel.png" alt="cancel.png" /> = not ok</p>
</li></ul>
</p>
</li><li>
<p><img src="pics/control_play_blue.png" alt="control_play_blue.png" /><br />
play a loaded or recorded sample</p>
</li><li>
<p><img src="pics/control_stop_blue.png" alt="control_stop_blue.png" /><br />
stop recording, or stop playing a sample</p>
</li><li>
<p><img src="pics/cut.png" alt="cut.png" /><br />
cut the selected area in from the sample (no undo)</p>
</li><li>
<p><img src="pics/control_equalizer_blue.png" alt="control_equalizer_blue.png" /><br />
do the above mentioned "normalization", selecting a number of bits "cuts" these numbers of bits from the top, and moves all samples "up" (it gets all louder) (no undo)</p>
</li><li>
<p>samples can only be loaded from "wav"- files (hm - never tried anything else though...)</p>
</li></ul>
</p>

<p>Some general information:<br />
</p>

<ol><li>
<p>Internally all samples are kept in the format: 
<ul><li>
<p>44100 khz </p>
</li><li>
<p>2 channel </p>
</li><li>
<p>16 bit </p>
</li><li>
<p>signed </p>
</li><li>
<p>little endian </p>
</li></ul>
</p>

<p>this is what you see in the sample display window (left channel) </p>
</li><li>
<p>Recording is done with the settings you enter to the right (and is than converted to above format)</p>
</li><li>
<p>(the original) samples can be saved, save format is "wav", saving is done in the above format, since in this format all information is kept (internally) anyway.</p>
</li><li>
<p>(the vectrex) samples can be saved, save format is "wav", saving is done in the format chosen (only sample rate can be chosen, the rest is always set).</p>
</li><li>
<p>you can save the vectrex samples as "raw" data, the raw data uses 8 bit signed data (this is what vectrex wants)</p>
</li></ol>

<p>The generated "play" routines use sampled data "backwards", therefor you can select to reverse the order of the data statements generated.</p>

<p>The data is output in data-statements, the format of the data is described in the (generated) source. With the sourcecode some example code is also generated.</p>
<h2>Technically</h2>

<p>Samples as implemented now have NOTHING whatsoever to do with PSG.</p>

<p>It might be possible to implement samples as "volume" levels of  PSG channels, but as of now nobody has tried that.</p>

<p>The current implementation of playing samples is using  a direct DAC &rarr; audio implementation.</p>

<p>Technical meaning:</p>

<p>The sample data is taken directly (as signed 8 bit values), fed into the vectrex DAC and converted to analog values. Thru the multiplexer the resulting analog values are fed DIRECTLY to the vectrex sound hardware (not the PSG).</p>

<p>A MUXSEL value of 11 (and mux select enabled) does that with data in port A of VIA.</p>
<hr />
<h1>Mod-Conversion</h1>

<p>First!<br />
Let me start by saying that although I am an old Amiga - guy, I have never been one who was much interested in sound, or playing music. I know that the MOD-Format existed probably a short time after it first appeared and I can remember the labels on my ST-01 and ST-02 disk, but I never really did anything related to music.</p>

<p>That did not change!</p>

<p>All the brabbling below are things I found out the last couple of days while getting "Mod2Vectrex" integrated into VIDE. So please forgive me if I make any mistakes, just send me some words of correction and I'll keep on trying to do my best.</p>
<br />

<p><b>Thanks</b><br />
My thanks at this place especially goes to the guys (and girls?) behind <i>Nuance</i> and <i>Metalvotze</i> who not only did great Vectrex demos, but also are refreshingly open in sharing their sourcecode. The original Pascal source to the coding behind my Mod2Vectrex class were programmed by "Fieser Wolf", thanks for sharing!</p>

<p><b>Start</b><br />
Mod to vectrex conversion is not a trivial thing - at least if you want nice results.</p>

<p>Sure - you can read the "Notes" of a mod file and convert them to vectrex notes, but that alone will in most places not be sufficient.</p>

<p>There are significant differences in the way music is handled in the two formats:</p>

<ul><li>
<p>&larr;the orginal MOD has 4 voices (later versions can have even more than 4) [original: Karsten  Obarski's   Ultimate Soundtracker]</p>
</li><li>
<p>&rarr;vectrex only as 3 voices</p>
</li><li>
<p>&larr;MODs play samples</p>
</li><li>
<p>&rarr;although vectrex can be brought to play samples, it is not its "natural" cause (unlike the good old Amiga), therefor vectrex will play generated sound after conversion (not samples)</p>
</li><li>
<p>&larr;because MODs play samples there is no way to "auto-map" one instrument (sample) to a PSG setting (something instrument like), since every MOD can have different samples</p>
</li><li>
<p>&rarr;not all samples have a "fitting" counterpart in vectrex "instruments".</p>
</li><li>
<p>although vectrex can be brought to "sound like" one instrument or the other, the BIOS sound routines (which are used after conversion) do not allow different "instrument settings" to be used at the same time with different voices, the "ADSR" and "TWANG" settings are for all voices for one complete piece of music.     Therefor:<br />
In order to achieve conversion results which are at least somewhat pleasing, you as a user have to help!</p>

<ol><li>
<p>You must tell which of the 4 voices are supposed to be matched to the three vectrex voices</p>
</li><li>
<p>You must tell which of the instruments(samples) of the MOD are mapped to what PSG settings [the vectrex mod-routines use (nearly) the BIOS sound playing routines]</p>
</li></ol>
</li></ul>

<p>(This might not be an easy task, since there are two stumbling blocks:
<ol><li>
<p>Mod writers often do not name their instruments very descriptive</p>
</li><li>
<p>You have to know how the vectrex sound routines work in order to find settings for "instruments")</p>
</li></ol>
</p>

<p>I have tried to help in form of a nice little window with some features:<br />
(The piece of music you see is the one from "lineart", which is VERY easy to convert!)</p>
<br/><p align="center">
<img src="pics/mod2vectrex1.png" width="800" height="801" /><br/>
<em>Mod2Vectrex</em></p><br/>
<h3>IBXM</h3>

<p>At the top of the panel you can see a cut down version of the IBXM ((c)2011 mumart@gmail.com) - player, with that you can play the to be processed MOD file and listen to it, and chose easily whether you like it or not.</p>
<h3>Instrument table</h3>

<p>Below that you see a table with information of the loaded mod:
<ul><li>
<p>the number of instruments</p>
</li><li>
<p>the original instrument names (samples) (which sometimes only contain "messages")</p>
</li><li>
<p>the size of the sample, which give you a first clue whether they are used at all</p>
</li><li>
<p>"used #", these are numbers of "usages" of the sample, first the sum, and after that each usage count for each voice</p>
</li><li>
<p>instrument of vectrex to be mapped to, this you <b>have to edit</b>, since the default vectrex name for any instrument is "silence!" (see also below: <i>"noise"</i> should be set to an instrument, <i>"notes"</i> to ... note)</p>
</li><li>
<p>the resulting vectrex byte with the current selected mapping ["note" is always represented with 0]</p>
</li><li>
<p>a double click on a table row "plays" that sample, so you know at least what that specific sample sounds like</p>
</li></ul>
</p>
<h3>Channel/Voice selection</h3>

<p>Below that table there are some more settings.<br />
First there are 12 radio buttons, with these you can set which of the 4 mod channels (voices) should be converted to what vectrex channel - here only testing helps!</p>
<h3>Voice usage</h3>

<p>Below that you see four numbers, these are the sums of notes played in each of the four channels. In the example provided you can see, that the first three mod-channels play over a thousand notes and the fourth channel only about a hundred. This so far seems to be a perfect candidate to be dropped out...</p>
<h3>Voice enable/disable</h3>

<p>Below that you see four checkboxes which are per default all set to enabled. Each of the checkboxes represent a "play enabler" for IBXM. With these checkboxes you can turn on/off single voices while playing the original mod. This also enables you the chose which channel might be "drop-worthy".</p>
<h3>ADSR/TWANG</h3>
<br/><p align="center">
<img src="pics/adsr.png" width="306" height="199" /><br/>
<em>ADSR</em></p><br/>

<p>The last possible settings are the ADSR (<b>A</b>ttack, <b>D</b>ecay, <b>S</b>ustain, <b>R</b>elease) and TWANG (Vibrato) table. <br />
(See also Programming the Vectrex - Sound)<br />
The vectrex mod formats supports different ADSR / TWANG settings for each voice. </p>
<br />

<p>Note:<br />
Each pattern can have different ADSR and TWANG tables. The values you find here are used in ALL patterns. If you want to differentiate you have to change the generated sourcecode!</p>
<br />

<p>Note again:<br />
The ADSR and TWANG values are copied to the source AS IS, if you put errors in there or supply the wrong count of values, strange sounds may occur!</p>
<br />

<p>Instruments<br />
This might be confusing, there are actually "3" different entities lurking behind the label "instrument".
<ol><li>
<p>The Instruments which are mod file inherent, these are samples which are played in different frequencies to acchieve different tones.</p>
</li><li>
<p>In the table of the mod conversion, you can set the vectrex "translation" instruments. This originated in the way vectrex (or the PSG) generates sounds and how the sound format of the orginal BIOS was defined. There are two "states" a sound register can produce output from: <i>NOISE</i> and <i> TONE</i>. The noise is generated PSG internally and the input "frequency" defines the noise - this is not equavalent to a "tone-frequency". For that reason you can select in the table: 
<ul><li>
<p>silence (no sound)</p>
</li><li>
<p>a "noise" instrument (there are 3 fixed defined ones, but you can add easily to the resulting source code)</p>
</li><li>
<p>any "tone" instrument as "note" - the actual tone instrument is defined via the ADSR and TWANG tables (see also instrument editor)</p>
</li></ul>
</p>
</li></ol>
</p>
<h3>The last checkbox<br />
</h3>

<p>... is on the bottom left. With these you can alter output settings. But this is more for historic reasons, if I were you I would always use "indirect output", that output is better readable and allows you through definitions to more easily change the resulting sources.</p>
<h3>Resulting source</h3>
<br/><p align="center">
<img src="pics/mod2vectrex2.png" width="1008" height="1101" /><br/>
<em>Mod2Vectrex-generated source</em></p><br/>

<p>The resulting sourcecode is one asm file (+ example player) which contains all song data. The file has a few different "chapters":
<ul><li>
<p>adsr/twang table<br />
as described above, these are just copied</p>
</li><li>
<p>play values<br />
these are identical for every generated piece of music, only three values: SILENCE, NOISE, CONTINUE</p>
</li><li>
<p>instruments<br />
a list of all instruments from the original mod and the resulting mapping for vectrex</p>
</li><li>
<p>notes<br />
a list of all notes the vectrex can play for better readability (this is also always the same)</p>
</li><li>
<p>song values<br />
the count of patterns to be played and a loop position (if available)</p>
</li><li>
<p>pattern playlist<br />
a list of patterns which are to be played and in what order</p>
</li><li>
<p>pattern data<br />
 for each available pattern, a complete pattern data collection (in vectrex terms: one pattern is one piece of music. The data for one pattern is in exactly that vectrex music format!) </p>
</li></ul>
</p>
<h3>Some technical background:<br />
</h3>

<ul><li>
<p>The resulting piece of vectrex music is nearly identical to a original Vectrex BIOS music piece, the only difference is, that the highest possible vectrex note (AS7, value $3f) is taken as the value for SILENCE instead of a note. This is the only reason why the original sound routines are copied to cartridge space, - to reflect that little change (5 lines of different assembler code)</p>
</li><li>
<p>Thus the handling, setting up etc of the music is the same as usual BIOS routine.</p>
</li><li>
<p>Each generates "pattern" is one piece of vectrex music. With very little overhead you can play the different patterns in the original mod order and thus play the complete mod (see examples).</p>
</li><li>
<p>"Notes"- format!<br />
See Bruce Tomlins BIOS disassembly (&rarr;Library, address from $F687, "Init_Music_chk") (honestly, <b>READ THAT</b>), there the music format and note format is described. Most relevant for "mod conversion" is the differentiation between <i>noise</i> and <i>notes</i>. In order to play a drum, a hihat or bass or whatever other "noise" instrument you play, you set bit 6 ($40) of your note and achieve a noise result. The 3 (instrument-) values which are provided as a start, I have taken from lineart demo, and these noise instruments are:
<ul><li>
<p>bass drum</p>
</li><li>
<p>hihat drum</p>
</li><li>
<p>snare drum</p>
</li></ul>
</p>

<p>The values for these are hardcoded in a combobox, to easily chose from. If you find other suitable values,
<ol><li>
<p> tell me!</p>
</li><li>
<p>edit the resulting asm file (if saved with "indirect output" option enabled allows changing and adding new values very easily)</p>
</li></ol>
</p>
</li></ul>

<p>Many a mod file can be found at:<br />
<a target="_blank" href="http://modarchive.org/">http://modarchive.org/</a><br />
or<br />
<a target="_blank" href="http://amp.dascene.net/home.php">http://amp.dascene.net/home.php</a></p>
<hr />
<h1>Instrument editor</h1>
<br/><p align="center">
<img src="pics/Instruments.png" width="1026" height="429" /><br/>
<em>Instrument editor</em></p><br/>

<p>Here you can edit and experiment with the vectrex ADSR and TWANG tables. You can use the resulting data with mod file generation directly - or you can copy/paste the data to your own vecterx BIOS pieces and use them there - the format is identical.</p>

<p>There are 32 ADSR values which (provided the vectrex runs at 30000 cycles per update round) each represent a 0.02 seconds "piece" of a generated tone.</p>

<p>The values are "volumes" in the range from 0 (silence) to 15 (maximum volume). If within the "full" duration of the note (32*0.02) = 0.64 another sound is played, the ADSR will be chopped off - and the next note will start with its own ADSR range.</p>

<p>The Twang table are register frequency values (see Programmin the vectrex - sound), which are added to the PSG registers for the current channel (values range from -128 to + 127). This also "updates" each 0.02 seconds.</p>

<p>Regarding TWANG, some info:</p>

<ul><li>
<p>the TWANG values are roll over, they start at their respective zero-value after the max value is used</p>
</li><li>
<p>the BIOS routine uses different roll over values (6, 7, 8 for channel 0,1,2), the modified MOD-player routine uses always 8 (since it uses different TWANG values for each channel)</p>
</li><li>
<p>the internal twang counter is always increased, whether a note is played or not</p>
</li><li>
<p>the internal twang counter always (continues), it is not "reset" by playing a new note</p>
</li></ul>
<h3>Saving loading</h3>

<p>You can save the setting by giving a name and pressing the save button. <br />
You can retrieve old setting via the checkbox.</p>
<h3>Playing</h3>

<p>You can use the keyboard to listen to the sound generated by the current setting. For that place the cursor in the textfield behind "play" and press keyes.</p>
<h3>Noise</h3>

<p>With the checkbox you enable noise generation.</p>
<hr />
<h1>YM-Conversion I</h1>

<p>This section is a 1:1 conversion of the utility I did about 15 years ago. The old routines were translated to java and 100% reused. For that reason the description that follows will be in huge passages just a copy and paste of the old readme file.</p>
<br/><p align="center">
<img src="pics/ym1.png" width="788" height="1146" /><br/>
<em>YM</em></p><br/>

<p>For this conversion I did not build an own panel, it is sufficient if you right click on a ym file and chose "build vectrex YM".</p>

<p>A process will start which translates (if possible) the selected file to a vectrex assembler include. There is no way to chose different settings, as I reduced YM-Conversion to always chose the optimal packrate.  This in turn means, that conversion may take quite a few seconds, look at the message window to get the current status of conversion.</p>

<p>In opposite to the "original" routines, there is no need to unpack (lharc) the "YM"-files beforehand. LHARC files can be processed by java, so no external help is needed.</p>

<p>Three files are generated:
<ul><li>
<p>a main file, as a player example</p>
</li><li>
<p>an include file which contains the "player" subroutines (always the same)</p>
</li><li>
<p>and an actual data file which contains the data </p>
</li></ul>
</p>

<p>Following is the original readme file from way back in time:<br />
(but edited to not tell lies...)<br />
<br />
</p>

<div class="code">
<p>Hi!</p>

<p>I tried to write a packer for YM files to be able to be "runnable' on vectrex.</p>

<p>The idea to this came from two other people, namely:</p>

<p>        Ville Krumlinde and Ville Gustavsson</p>

<p>Thanks guys!</p>

<p>In this directory you find a couple batch files, which convert *.ym files to *.bin files. These *.bin files are "playable' vectrex binaries (no graphic, just sound) (well a title is displayed now).</p>

<p>This converts an ym file to a binary, it may however produce fairly large files. They may even be to large for vectrex to handle (&gt; 32Kb).</p>

<p>Samples in ym files are not supported, neither are loops or other not simple things like drums... and and and</p>

<p>My packer does not come near the original ym-file size (the lharced once). Perhaps another programmer wants to try to fiddle some more bytes out of the files. But consider this: you must unpack them on a vectrex with not much RAM.</p>

<p>Programmers point of view - vectrex side: The unpack routines generally use about 2000-3000 cycles per "round' but there are peaks that reach about 5000-6000 (though "seldom'). The unpacking is "streamed' the routine uses constantly 161 bytes RAM. The unpacker is a "bit' optimimized, though there could probably be done much more. The routine itself uses about 600 bytes.</p>

<p>The packer is a mixture of three schemes:
<ul><li>
<p>First a dictionay scheme (this is what takes the time... finding a good   dictionary)</p>
</li><li>
<p>Shannon/Fanno bit coding (huffman is implemented to, but for some reason or   another I use Shannon/Fanno)</p>
</li><li>
<p>RLE</p>
</li></ul>
</p>

<p>Enjoy...</p>

<p>Malban</p>

<p>PS The code is not all that cleaned up... pitty... but right now - I couldn't be bothered...</p>
</div>

<p>If you look for a good collection of YM-Files: <a target="_blank" href="http://pacidemo.planet-d.net/aldn/index.html">http://pacidemo.planet-d.net/aldn/index.html</a> <br />
 The package "ST synth musics" contains nearly 4000 pieces of music!</p>

<p><b>Tracker<br />
</b> There are at least to PSG trackers, which are available under windows:<br />

<ul><li>
<p>Arkos tracker: <a target="_blank" href="http://www.julien-nevo.com/arkos/">http://www.julien-nevo.com/arkos/</a></p>
</li><li>
<p>WYZTracker: <a target="_blank" href="https://sites.google.com/site/augustoruiz/">https://sites.google.com/site/augustoruiz/</a></p>
</li><li>
<p>Ymer YM2149: <a target="_blank" href="http://www.fedepede04.dk/Ym2149.html">http://www.fedepede04.dk/Ym2149.html</a></p>
</li></ul>
</p>

<p>As far as I know both of them are still activily developed, mainly to support other equipment like:
<ul><li>
<p>CPC Computer</p>
</li><li>
<p>MSX Computer</p>
</li><li>
<p>Spectrum Computer</p>
</li><li>
<p>Atari ST</p>
</li><li>
<p>and other</p>
</li></ul>
</p>

<p>As of yet no "direct" player for these trackers exist. If I have MUCH spare time in the future I might tackle the one or the other <i> Don't wait for that! </i> <br />
I would rather prefer <b>YOU</b> would write a vectrex player and send it for inclusion to VIDE!</p>
<hr />
<h1>YM Packing used by VecSound</h1>

<p>The data for a YM file is saved by VIDE in a packed format. Vectrex in general is not very good at packing / unpacking.</p>

<p>It does not have much RAM and it is not the fastest machine to begin with, so the strategies for packing are somewhat limited.</p>

<p>Here I will describe the format the packed data is saved with,  so you may try
<ol><li>
<p>to make a better packer</p>
</li><li>
<p>make a better unpacker (faster/less ram usage etc)</p>
</li></ol>
</p>

<p>Registers 0 to 10 (both inclusive) are saved.  I have not found any YM files which actually use the other other 3 registers (11-13) 14 and 15 are IO ports so no sense in saving them anyway.</p>

<p>The routines can easily be enhanced for the other three registers should that be needed.</p>
<h2><b>Shannon-Fano-Code + Run Length encoding</b><br />
</h2>

<p>The packing in general is a Shannon-Fano-Code, the resulting code bits are than in addition packed with a RLE algorithm. The Shannon-Fano-Code is not only used on the data bytes, but also on entities which I call "phrases".</p>

<p>A phrase is a byte pattern. If in the data of one register repetitions are found then the packer interprets them as a phrase (= pattern), the packer tries to find them and includes them in the Shannon-Fano-Code. With that it is possible to pack groups of bytes with only a few bits.  </p>

<p>Each register is saved and packed on its own. Since if you look at each register alone many data items in a row are quite similar. <br />
(This is also the reason the original YM-files differentiate between interleaved and non interleaved saving - to pack the data better!)</p>

<p>Note:<br />
The compression algorithm does not know, that some registers pairs form 12bit values, this knowledge might lead to better packing strategies - I have not followed that path.</p>

<p>In the resulting (asm) data file you will find the data for each register seperately listed.</p>

<p>The data for each register in the packed format comes in three "sections":
<ol><li>
<p>translation data</p>
</li><li>
<p>phrases</p>
</li><li>
<p>data</p>
</li></ol>
</p>
<h4>Translation data</h4>

<p>The translation data is a table where each row consists of three entries
<ol><li>
<p>bits used<br />
The number of bits that are used to build the code for the data. This means if here a "$03" is used, the following code (byte) only uses the three lowest bits. Possible values are than for the code:<br />

<ul><li>
<p>000</p>
</li><li>
<p>001</p>
</li><li>
<p>010</p>
</li><li>
<p>011</p>
</li><li>
<p>100</p>
</li><li>
<p>101</p>
</li><li>
<p>110</p>
</li><li>
<p>111</p>
</li></ul>
</p>

<p>If the highest bit is set (the byte starts with a "$8') than the decoded data which will be used is a "phrase" not a simple byte!</p>
</li><li>
<p>code<br />
The code used in the Shannon-Fano-Coding. Note, this does not mean, that a 10 bit code is actualy ten bit long here at this byte location. This location is always only one byte. But this bytes "number" will be coded in the number of bits given in the "bits used" data.</p>
</li><li>
<p>real data<br />
Here the real data which is the result of the Shannon-Fano <b>DECODE</b> is listed. If the result is a phrase (see above) than the number of the phrase is given.</p>
</li></ol>
</p>

<p>In addition to the actual data listed, there is always a comment after each entry. The comment is always a number and lists the count of entries that were found for each row.</p>

<p>The length of this section is not fixed! The length is determined on how many different entries for the Shannon-Fano-Code were found. This might be only a couple of entries, but in a weird worst case scenario it might be well over 100 or even 200 entries.</p>
<h4>Phrases</h4>

<p>This section is straight forward, here all phrases are listed, the format is: <tt><br />
 <br />
phrase_start_reg_X:<br />
 DB NO_OF_BYTES, BYTE1, BYTE2, ... BYTEX<br />
 DB NO_OF_BYTES, BYTE1, BYTE2, ... BYTEY<br />
 <br />
... for the number of phrases<br />
</tt></p>

<p>Note:<br />
There are no "direct" pointer to a phrase. To get to phrase x you have to read the length byte of all other phrases and add the values. This might be a point for optimization!</p>
<h4>data</h4>

<p>Now the actual data for the register follows. The above mentioned Shannon-Fano-Codes are additionaly packed using a RLE compression.<br />
RLE algorithm :<br />
(comments belong to the lines above!)<br />
<tt>
<ol><li>
<p>readBit()</p>
</li><li>
<p>if bit = 0 than dataCount = 1 (no rle coding) goto 5<br />
else bitCount = 1</p>
</li><li>
<p>while readBit()=1 bitCount++ <br />
// the count of bits which are 1 is the bitlength <br />
// of the following RLE counter </p>
</li><li>
<p>for bitCount: dataCount += readBit() &lt;&lt; i <br />
// build the counter from the following bits, <br />
// LSB first</p>
</li><li>
<p>code &lt;&lt;= 1  // code was initialzied with 0</p>
</li><li>
<p>code += readBit()</p>
</li><li>
<p>if code is not known goto 5</p>
</li><li>
<p>realData = map[code]</p>
</li><li>
<p>if realData &gt; 256 than isPhrase = true, realData -= 256</p>
</li><li>
<p>for dataCount: </p>
</li><li>
<p> &nbsp;&nbsp;&nbsp;if isPhrase than OUTPUT(phrase[realData]) else OUTPUT(realData)</p>
</li></ol>
</tt></p>

<p>Following above algorithm unpacks one complete register.</p>
<h2>"Base data"</h2>

<p>The above data sections are repeated 10 times, once for each register. </p>

<p>The unpacking routines also need some base data, as e.g. where to find above tables. </p>

<p>The setup routine for the ymSound player only needs one address for a song, this is the "data" address or base address.</p>

<p>The YMSound routine places the base address at the end of the actual YM assembler file. At the start of the table which maps to the data of the registers. The register data table has 3 entries for each register, the above described three tables.</p>

<p>The entries and the addresses are automatically build by the generator.</p>
<h2>Data format:</h2>
<h3>General file format of ym data:</h3>

<ol><li>
<p>Length of ym register "lines"</p>
</li><li>
<p>Datatables register 0-10 (translation/phrase/data)</p>
</li><li>
<p>Base data table</p>
</li><li>
<p>Name of YM-Song</p>
</li></ol>
<h4>Length of ym register "lines"</h4>

<p>Only one data statement:<br />
 <br />
<tt> &nbsp;&nbsp;&nbsp;&nbsp;DW length<br />
 <br />
</tt> a 16 bit signed value</p>
<h4>Datatables register 0-10 (translation/phrase/data)</h4>
<br />

<p><b>translation table</b><br />
<tt> &nbsp;&nbsp;&nbsp;&nbsp;DB bits_used, code, data &nbsp;&nbsp;; count of entries<br />
 <br />
</tt></p>
<br />

<p><b>phrase</b><br />
<tt> &nbsp;&nbsp;&nbsp;&nbsp;DB NO_OF_BYTES, BYTE1, BYTE2, ... BYTEX<br />
 &nbsp;&nbsp;&nbsp;&nbsp;DB NO_OF_BYTES, BYTE1, BYTE2, ... BYTEY<br />
... for the number of phrases<br />
</tt></p>
<br />

<p><b>data</b><br />
<tt> &nbsp;&nbsp;&nbsp;&nbsp;DB byte1, byte2...<br />
 &nbsp;&nbsp;&nbsp;&nbsp;DB ...bytex, bytey<br />
</tt></p>
<h4>Base data table</h4>

<p><tt> &nbsp;&nbsp;&nbsp;&nbsp;DW start &nbsp;&nbsp;&nbsp;&nbsp;; pointer to the start of this file<br />
 &nbsp;&nbsp;&nbsp;&nbsp;DW translationReg0, phraseReg0, dataReg0<br />
 &nbsp;&nbsp;&nbsp;&nbsp;...<br />
 &nbsp;&nbsp;&nbsp;&nbsp;DW translationReg10, phraseReg10, dataReg10<br />
</tt></p>
<h4>Name of YM-Song</h4>

<p><tt> &nbsp;&nbsp;&nbsp;&nbsp;DB "NAME", $80<br />
</tt></p>

<p> </p>
<hr />
<h1>VecSound Decoder in C(++) example</h1>

<p><tt> /*<br />
&nbsp;To work the first commented out byte (a counter) of each register must be uncommented.<br />
&nbsp;The counter to how many different bytes are used within the &nbsp;"SHANNON'-coding...<br />
*/<br />
<br />
#include &lt;fstream.h&gt;<br />
#include &lt;string.h&gt;<br />
#include &lt;stdlib.h&gt;<br />
#include &lt;ctype.h&gt;<br />
#include &lt;stdio.h&gt;<br />
<br />
#define PHRASES&nbsp;MAX 100<br />
#define MAX&nbsp;PHRASE&nbsp;LEN 100<br />
struct phrase<br />
{<br />
&nbsp;&nbsp;&nbsp;&nbsp;    int  phrase[MAX&nbsp;PHRASE&nbsp;LEN];<br />
&nbsp;&nbsp;&nbsp;&nbsp;   int  len;<br />
&nbsp;&nbsp;&nbsp;&nbsp;    int  count;<br />
};<br />
phrase phrases[PHRASES&nbsp;MAX];<br />
<br />
const MAXBUFF = 2000000;<br />
//START inclusive<br />
#define ENCODE&nbsp;START 0<br />
//END exclusive<br />
#define ENCODE&nbsp;END 11<br />
<br />
FILE *inFile;<br />
FILE *outFile;<br />
FILE *outFile2;<br />
unsigned char buf[MAXBUFF];<br />
unsigned char out&nbsp;buf[MAXBUFF/11+11][11];<br />
int len;<br />
int vbl&nbsp;len;<br />
int byte&nbsp;pointer&nbsp;read = 0;<br />
int byte&nbsp;pointer&nbsp;write = 0;<br />
<br />
int current&nbsp;bit&nbsp;counter = -1;<br />
int current&nbsp;out&nbsp;byte=0;<br />
<br />
<br />
#define MAP&nbsp;BIT&nbsp;MAX 127<br />
#define MAP&nbsp;CODE&nbsp;MAX 255<br />
<br />
int map[MAP&nbsp;BIT&nbsp;MAX][MAP&nbsp;CODE&nbsp;MAX];<br />
<br />
int GET&nbsp;BYTE()<br />
{<br />
&nbsp;&nbsp;current&nbsp;bit&nbsp;counter = -1;<br />
&nbsp;&nbsp;return buf[byte&nbsp;pointer&nbsp;read++];<br />
}<br />
void WRITE&nbsp;BYTE(int byte)<br />
{<br />
&nbsp;&nbsp;fprintf(outFile," DB $%02X \n",byte);<br />
&nbsp;&nbsp;fwrite(&amp;byte,1,1,outFile2);<br />
}<br />
<br />
int GET&nbsp;BIT()<br />
{<br />
&nbsp;&nbsp;if (current&nbsp;bit&nbsp;counter == -1)<br />
&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;current&nbsp;out&nbsp;byte = GET&nbsp;BYTE();<br />
&nbsp;&nbsp;&nbsp;&nbsp;current&nbsp;bit&nbsp;counter = 7;<br />
&nbsp;&nbsp;}<br />
&nbsp;&nbsp;if (current&nbsp;out&nbsp;byte&amp;(1&lt;&lt;(current&nbsp;bit&nbsp;counter--)))<br />
&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;return 1;<br />
&nbsp;&nbsp;}<br />
&nbsp;&nbsp;return 0;<br />
}<br />
<br />
int total&nbsp;unpack&nbsp;count = 0;<br />
<br />
int main( int argc, char* argv[] )<br />
{<br />
&nbsp;&nbsp;cout " nCalling ";<br />
&nbsp;&nbsp;for (int ii=0;ii&lt;argc;ii++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;cout " "argv[ii];<br />
&nbsp;&nbsp;cout  " \n \n";<br />
&nbsp;&nbsp;if ( argc != 2 )<br />
&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;cout  "Usage: decode &lt;infile&gt;  \n";<br />
&nbsp;&nbsp;&nbsp;&nbsp;return 0;<br />
&nbsp;&nbsp;}<br />
&nbsp;&nbsp;inFile=fopen(argv[1],"rb");<br />
&nbsp;&nbsp;if( !inFile )<br />
&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;cout  "A file error occured with "  argv[1]  "! \n";<br />
&nbsp;&nbsp;&nbsp;&nbsp;return 2;<br />
&nbsp;&nbsp;}<br />
&nbsp;&nbsp;len=fread( buf, sizeof(char),sizeof(char)*MAXBUFF,inFile );<br />
&nbsp;&nbsp;fclose(inFile);<br />
&nbsp;&nbsp;printf("Length of file: %i \n",len);<br />
<br />
&nbsp;&nbsp;vbl&nbsp;len = GET&nbsp;BYTE()*256+GET&nbsp;BYTE();<br />
&nbsp;&nbsp;printf("Length of track: %i \n",vbl&nbsp;len);<br />
&nbsp;&nbsp;int ym&nbsp;register;<br />
<br />
&nbsp;&nbsp;outFile=fopen("out&nbsp;int.asm","wb+");<br />
&nbsp;&nbsp;if (!outFile)<br />
&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;printf("File Open Error! \n");<br />
&nbsp;&nbsp;&nbsp;&nbsp;return 1;<br />
&nbsp;&nbsp;}<br />
&nbsp;&nbsp;outFile2=fopen("out&nbsp;int.bin","wb+");<br />
&nbsp;&nbsp;if (!outFile2)<br />
&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;printf("File Open Error! \n");<br />
&nbsp;&nbsp;&nbsp;&nbsp;return 1;<br />
&nbsp;&nbsp;}<br />
<br />
&nbsp;&nbsp;fprintf(outFile," DW %i ; length of track \n", vbl&nbsp;len);<br />
<br />
<br />
&nbsp;&nbsp;for (ym&nbsp;register=ENCODE&nbsp;START; ym&nbsp;register&lt; ENCODE&nbsp;END; ym&nbsp;register++)<br />
&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;int to&nbsp;map = GET&nbsp;BYTE();<br />
&nbsp;&nbsp;&nbsp;&nbsp;int i;<br />
&nbsp;&nbsp;&nbsp;&nbsp;printf("Register %i has %i different "bytes' \n", ym&nbsp;register, to&nbsp;map);<br />
&nbsp;&nbsp;&nbsp;&nbsp;// initialize mapper<br />
&nbsp;&nbsp;&nbsp;&nbsp;fprintf(outFile,"; mapper for ym&nbsp;register %i \n", ym&nbsp;register);<br />
&nbsp;&nbsp;&nbsp;&nbsp;fprintf(outFile," DB $%02X ; uses different bytes \n", to&nbsp;map);<br />
&nbsp;&nbsp;&nbsp;&nbsp;for (i=0; i &lt; MAP&nbsp;BIT&nbsp;MAX; i++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (int j=0; j &lt; MAP&nbsp;CODE&nbsp;MAX; j++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map[i][j] = -1;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;int no&nbsp;phrases=0;<br />
&nbsp;&nbsp;&nbsp;&nbsp;for (i=0; i &lt; to&nbsp;map; i++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int bits = GET&nbsp;BYTE();<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int code = GET&nbsp;BYTE();<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int real&nbsp;byte = GET&nbsp;BYTE();<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fprintf(outFile," DB %02X, %02X, %02X ; bits, code, realbyte \n", bits, code, real&nbsp;byte);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((bits&amp;127) &gt; MAP&nbsp;BIT&nbsp;MAX)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Bit overflow - bye! \n");<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(1);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map[bits&amp;127][code] = real&nbsp;byte;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (bits&amp;128)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no&nbsp;phrases++;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map[bits&amp;127][code]+=256;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;fprintf(outFile,"; Phrases follow (%i) \n",no&nbsp;phrases);<br />
&nbsp;&nbsp;&nbsp;&nbsp;// load phrases<br />
&nbsp;&nbsp;&nbsp;&nbsp;for (i=0;i&lt;no&nbsp;phrases;i++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phrases[i].len = GET&nbsp;BYTE();<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fprintf(outFile," DB %02X", phrases[i].len);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int j;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j=0;j &lt; phrases[i].len; j++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phrases[i].phrase[j] = GET&nbsp;BYTE();<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fprintf(outFile,", %02X", phrases[i].phrase[j]);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;fprintf(outFile," \n");<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;fprintf(outFile,"; Data follows...\n");<br />
&nbsp;&nbsp;&nbsp;&nbsp;// done... now start decoding!<br />
&nbsp;&nbsp;&nbsp;&nbsp;int byte&nbsp;decrunched&nbsp;count = 0;<br />
&nbsp;&nbsp;&nbsp;&nbsp;while (byte&nbsp;decrunched&nbsp;count &lt; vbl&nbsp;len)<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int RLE&nbsp;count = 0;<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (GET&nbsp;BIT() == 0)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// one byte<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RLE&nbsp;count = 1;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// rle encoded<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int count&nbsp;bits = 1; // already got a 1, see above<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (GET&nbsp;BIT() == 1)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;bits++;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;bits+=2; // plus two, since we start coding with 3 bits<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// the following count&nbsp;bits represent the RLE count<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// lsb first<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i=0; i &lt; count&nbsp;bits; i++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RLE&nbsp;count+=  i);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// in RLE&nbsp;count now the number of times we should repeat the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// following bit data...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// msb first<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int bits = 0;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int code = 0;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int is&nbsp;phrase = 0;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int unpacked&nbsp;byte = 0;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code = 1;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code += GET&nbsp;BIT();<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bits++;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (map[bits][code] != -1)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unpacked&nbsp;byte = map[bits][code];<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (unpacked&nbsp;byte&gt;=256)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;phrase = 1;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unpacked&nbsp;byte -= 256;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
/*<br />
&nbsp;&nbsp;&nbsp;&nbsp;fprintf(outFile,"; byte&nbsp;decrunched&nbsp;count %i \n",byte&nbsp;decrunched&nbsp;count);<br />
&nbsp;&nbsp;&nbsp;&nbsp;if (is&nbsp;phrase == 0)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fprintf(outFile,"; byte %02X, times %i \n",unpacked&nbsp;byte,RLE&nbsp;count);<br />
&nbsp;&nbsp;&nbsp;&nbsp;else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fprintf(outFile,"; phrase %02X, times %i \n",unpacked&nbsp;byte,RLE&nbsp;count);<br />
*/<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i=0; i&lt;RLE&nbsp;count; i++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is&nbsp;phrase == 0)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE&nbsp;BYTE(unpacked&nbsp;byte);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte&nbsp;decrunched&nbsp;count++;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total&nbsp;unpack&nbsp;count++;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int j;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j=0;j&lt;phrases[unpacked&nbsp;byte].len;j++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE&nbsp;BYTE(phrases[unpacked&nbsp;byte].phrase[j]);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte&nbsp;decrunched&nbsp;count++;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total&nbsp;unpack&nbsp;count++;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;}<br />
&nbsp;&nbsp;printf("Bytes unpacked: %i \n", total&nbsp;unpack&nbsp;count);<br />
&nbsp;&nbsp;fclose(outFile);<br />
&nbsp;&nbsp;fclose(outFile2);<br />
<br />
&nbsp;&nbsp;return 0;<br />
}<br />
<br />
<br />
</tt></p>
<hr />
<h1>YM-Conversion II</h1>

<p>So much has changed...</p>

<p>I leave the old "document" as it is, since it describes some of the history - and other parts are still relevant and I don't need to repeat/update that.</p>

<p>Under this section I'll put all stuff that comes in addition to everything said in "YM-Conversion I". </p>

<p>Obviously, now when YM-files are selected for conversion a new panel pops up. Here I will describe what you can do with that!</p>
<br/><p align="center">
<img src="pics/ympanel2.png" width="1026" height="599" /><br/>
<em>YM-Panel</em></p><br/>

<p>In general the panel is split into different sections (which again can be devided in several clusters).</p>
<h2>YM-Data</h2>
<h3>YM-Table</h3>

<p>The right side of the window is mainly occupied by a table. That table keeps all rows of YM-Data which is available at a given time.</p>

<p>The rows in the table can have different colors:
<ul><li>
<p>white<br />
nothing special - just data</p>
</li><li>
<p>lavender (sort of color)<br />
that is the current "active" row, the data of that row is displayed at the top, this data can be edited by the ym-gui, playing ym- data advances this 50 times per second. By double clicking on a row, you can set it. </p>
</li><li>
<p>gray<br />
these are rows that are selected (by dragging the mouse over rows)</p>
</li></ul>
</p>
<h3>YM-Edit</h3>

<p>To the top of the table you see different "Editors" for volume, noise, notes etc. With these controls you can manipulate register entries of the YM-Data.<br />
Note:<br />
With these controls you edit the YM-Data, not the PSG registers!</p>

<p>Below each control you can see (sometimes colored) textfields. The textfields show you the same data as the above controls. You can also edit the values in numerical form via these textfields.<br />
</p>

<p>Note:<br />
A double click on a textfield sends the data to the PSG-emulator of the YM-Panel!</p>

<p>Below the textfields you see a checkbox for each of the registers.  These checkboxes enable/disable the denoted registers, enables/disables means:
<ul><li>
<p>the YM-Player recognizes the switches and plays only the channels which are enabled</p>
</li><li>
<p>the source code generator of the ym-panel also recognizes the switches and only data (and the player) is generated for the selected registers</p>
</li></ul>
</p>
<h3>Channels</h3>

<p>As you can see the channel specific data words/bytes/bits are colored consistently for each of the three available channels.</p>
<h3>PSG</h3>

<p>At the bottom of the page you can see the actual registers the PSG emulation for the YM-panel at any given time are set to. These can not directly be edited or altered.</p>
<h3>Special edit-buttons </h3>

<p>On the top there are a couple of special buttons, here a short description:
<ul><li>
<p><img src="pics/add.png" alt="add.png" /> &nbsp;&nbsp;<b>insert new row</b><br />
 This button inserts a new row (with 0-lled data) <i>befor</i> the current active row</p>
</li><li>
<p><img src="pics/page_copy.png" alt="page_copy.png" /> &nbsp;&nbsp;<b>copy selected rows</b><br />
Put the current selected rows in a YM-Buffer (this is no clipboard buffer, but can be accessed from all YM-panels which are open)</p>
</li><li>
<p><img src="pics/paste_plain.png" alt="paste_plain.png" /> &nbsp;&nbsp;<b>paste buffer</b><br />
Paste the current buffer befor the current active row. The pasted rows are inserted, they do not overwrite existing rows!</p>
</li><li>
<p><img src="pics/cut.png" alt="cut.png" /> &nbsp;&nbsp;<b>cut selected rows</b><br />
 The current selected rows are deleted, but also placed in the buffer</p>
</li><li>
<p><img src="pics/page_add.png" alt="page_add.png" /> &nbsp;&nbsp;<b>insert ym file</b><br />
Insert another YM-file befor the current active row.</p>
</li><li>
<p><img src="pics/page_edit.png" alt="page_edit.png" /> &nbsp;&nbsp;<b>save selection as ym file</b><br />
Save the current selected rows as a YM-file.</p>
</li></ul>
</p>
<h2>YM-Player</h2>

<p>The left side of the window belongs mainly to the YM-Player.</p>
<h3>Buttons</h3>

<p>At the top row there are several buttons:
<ul><li>
<p><img src="pics/control_play_blue.png" alt="control_play_blue.png" /> &nbsp;&nbsp;<b>play current ym-data</b><br />
The data that is shown to the left is played (and looped)</p>
</li><li>
<p><img src="pics/control_stop_blue.png" alt="control_stop_blue.png" /> &nbsp;&nbsp;<b>stop playing</b><br />
Yeah, really, stop it!</p>
</li><li>
<p><img src="pics/control_rewind_blue.png" alt="control_rewind_blue.png" /> &nbsp;&nbsp;<b>rewind</b><br />
Set current active YM-data row to 0.</p>
</li><li>
<p><img src="pics/page_go.png" alt="page_go.png" /> &nbsp;&nbsp;<b>load YM-file</b><br />
Load a YM-file, all current data is overwritten.</p>
</li><li>
<p><img src="pics/page_save.png" alt="page_save.png" /> &nbsp;&nbsp;<b>save YM-file</b><br />
Save the complete current data to a YM-file.</p>
</li><li>
<p><img src="pics/new.png" alt="new.png" /> &nbsp;&nbsp;<b>new YM-file</b><br />
Deletes all data, creates a new "empty" YM-data table (with ONE row of nulled data)</p>
</li><li>
<p>Further<br />
 you can select (only two settings at the time), if you would like to play back in 50 or 60 Hz.</p>
</li></ul>
</p>
<h3>YM-file data</h3>

<p>Below the player buttons, you can see listed the meta-data that was gathered from the loaded YM-file. Not all YM-versions supply all data fields, so some may be empty.</p>
<h3>YM-Lister</h3>

<p>On the second tab you can see a list of all ym files that are in the same directory of the last loaded ym file.<br />
Double clicking on an entry loads the corresponding file. This allowes you (more or less) easy browsing and comparing of ym files.</p>
<h3>more configuration</h3>

<p>Nothing much is on this tab yet. There are three checkboxes. If any one of these are pressed the ym-data is "pre processed". Preprocessed means the data is analysed and if the corresponding registers are not used the are set to "0" (zero). <br />
e.g. :<br />
If in the complete ym file channel a is never used as a "tone" - only as noise, than registers 0 and 1 will be set to 0 to all data.</p>
<br />

<p>Preprocessing does <b>not</b> always make sense, one has to tryout each ym file individually whether the resulting data is actually shorter or longer. </p>
<h3>Source-generator</h3>

<p>Below the YM-file information you see one button, one checkboxes and one combobox:
<ul><li>
<p>button: "create source"<br />
if pressed source code is generated for the ym data loaded (depending on the settings)<br />
<b>note</b>:<br />
When packing is used, the process may take some time, if started as a standalone window, the log-output is done to the standard debugging log, you can watch the processings there</p>
</li><li>
<p>checkbox: "create player"<br />
whether source code for the generated type of ym-asm-data should be generated or not</p>
</li><li>
<p>combobox: "encoding"<br />
Here you can chose what kind of encoding should be used for the generated vectrex data (see ym vectrex generator)</p>
</li></ul>
</p>
<h2>AYFX Support</h2>

<p>The last available feature is support for AYFX files (see the other chapter where these may come from). AYFX is a format for sound effects of the PSG-chips. The sound effects are channel independend, and are saved WITHOUT channel information (and can be loaded to any channel - any of the three :-)). The below description goes for all three channels.</p>
<h3>Save as AYFX</h3>

<p>You can save either one complete channel or the current selected rows of one channel as an AYFX file.</p>
<h3>Load from AYFX</h3>

<p>You can load AYFX data to the current YM-file. You can select if new rows should be inserted [befor the current active row] (than all other channel data will be set to 0 (null)), or you can select if the data in the current YM-file should overwritten with AYFX data [starting from the current active row]. Data for the selected channel will be overwritten. Mixer settings for that channel only will also be changed (but the other channel data in Reg 7 will be kept unchanged). The noise register (Reg 6) will be changed to the data that is loaded from the AYFX file (there is only one noise register for all 3 channels, so this <i>may</i> make a difference!)</p>
<hr />
<h1>YM vectrex generator</h1>

<p>With the supplied ym utility you can generate different YM data files (and players). Following is a list of these formats.</p>
<h2>Uncompressed</h2>

<p>The data is written in without any compressing to data statements - this is very easy understandable. (for comparisson, playing speed ~ 1700 cycles)</p>
<h2>YMSound (historic)</h2>

<p>This output is 100% compatible to the tool I released about 15 years ago. The structure of the generated ym file is explained in YM-Conversion I.</p>
<h2>YMSound (opimized speed)</h2>

<p>This is still in basic the same as YMSound, but with a few ehancements. The data between these two are NOT compatible.</p>

<p>The generated data uses a little bit more space (10% more ~ about). The <i>average</i> unpacking speed is about the same amount faster (a little bit more than 10%), but the main aspect is, that the "peaks" are reduced.</p>

<p>With my given example file, peaks by playing using the old routines were up to nearly 20000 cycles (average 3200 cycles). The new routines have a maximum peak of less thean 7500 cycles (in the whole song only 3 times) - and an average of about 2400 cycles.</p>

<p>Changes to YMSound historic:
<ul><li>
<p>single bytes are not shannon encoded (since searching for the shannon code takes longer the more codes are generated, and the savings for single bytes using shannon was only a small benefit)</p>
</li><li>
<p>RLE encoding changed from LSB first to MSB first, this made decoding the RLE length more performat</p>
</li><li>
<p>the phrase length is not held befor the phrase structure but directly in the phrase mapping, I can calculate the phrase offset now while searching the phrase</p>
</li><li>
<p>the RAM structure is 1 byte longer per register, the current phrase length is also kept in the data structure now</p>
</li><li>
<p>only the used bits per register are encoded (e.g. amplitude registers only 4 bits...) this made up quite some of the lost space due to the shannon/byte changes</p>
</li><li>
<p>some internal changes to optimzed "little" stuff</p>
</li><li>
<p>all "subroutines" were macro'ed</p>
</li><li>
<p>I advise to change the subroutine, to output to shadow registers, rather than to PSG registeres directly, that way you can "overwrite" values with sound effects!</p>
</li></ul>
</p>
<h2>Streamed</h2>

<p>(streamed does not support envelope data as yet)<br />
The ym data is bit encodeded in a stream of "bits".  At first the data is analyzed, the analysis results in following "knowledge":
<ul><li>
<p>is channel X used at all or not</p>
</li><li>
<p>does channel X use tone or not</p>
</li><li>
<p>does channel X use noise or not</p>
</li><li>
<p>is noise used at all in the ym data</p>
</li><li>
<p>does register 7 change at all in the data</p>
</li></ul>
</p>

<p>According to the above knowlegde only used registers are encoded.</p>

<p>The idea behind streamed encoding is to only supply information for changes and leave out all data that is unchanged.</p>

<p>There are two good reasons for that:
<ol><li>
<p>leaving out data is "packing" of some sort, the resulting data is shorter than the original</p>
</li><li>
<p>we know while processing inherently what data has changed and what not, so while unpacking on the vectrex we also know what registers changed and we do not have to poke to the psg registers that did not change. Poking to psg takes quite a few cycles.</p>
</li></ol>
</p>

<p>Following decoding is used (for each ym-line, a complete set of data for one refresh cycle - encoding is the opposite way):<br />
<tt> &nbsp;&nbsp;read bit, if bit is 0 than nothing at all changed &rarr; goto done<br />
&nbsp;&nbsp;for channel 0 to 2 do<br />
&nbsp;&nbsp;&nbsp;&nbsp;read bit, if bit is 0 than channel did not change at all &rarr; do next channel<br />
&nbsp;&nbsp;&nbsp;&nbsp;read bit, if bit is not 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read 4 bits of amplitude<br />
&nbsp;&nbsp;&nbsp;&nbsp;read bit, if bit is 1 than set noise, outherwise clear noise<br />
&nbsp;&nbsp;&nbsp;&nbsp;read bit, if bit is 1 than set tone, outherwise clear tone<br />
&nbsp;&nbsp;&nbsp;&nbsp;read bit, if bit is not 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read 8 bits of frequency low<br />
&nbsp;&nbsp;&nbsp;&nbsp;read bit, if bit is not 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read 4 bits of frequency high<br />
&nbsp;&nbsp;end for<br />
&nbsp;&nbsp;read bit, if bit is not 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;read 5 bits of noise frequency<br />
done: </tt></p>

<p>Vectrex unpacking is done like described above. The unpacker is a bit "longish" since readbit is realized as a macro and often used :-).</p>

<p>The mentioned analysis is also respected by the vectrex sources. Code parts that are not needed are omitted (using "<tt>if then else</tt>").</p>

<p>The resulting player is usually quite a lot faster than the other packing - but the data used is by far not reduced as much. It depends on how "tight" (cycles) the circumstances are what strategy of packing is more useful to you.</p>
<hr />
<h1>AYFX-Conversion</h1>

<p>Perhaps in a far, far away future I will do a FX generator/editor or at least a register editor for the AY-soundchip. Until that time this feature might help you doing sound effects.</p>

<p>There is a (discontinued - but runable on emulators) windows program called:<br />
<b>AY Sound FX Editor</b><br />
</p>
<br />

<p>Which can be found at: <a target="_blank" href="https://shiru.untergrund.net/software.shtml">https://shiru.untergrund.net/software.shtml</a><br />
</p>

<p>With that editor you can save files in a "*.afx" format. These files contain AY register values in a slightly compressed format.  These register storages are meant to contain sound effects.</p>

<p>With the software come about 200 different sound effects which you can use "out of the box" - or edit them yourself. The program looks like:</p>
<br/><p align="center">
<img src="pics/ayfx.png" width="645" height="470" /><br/>
<em>AYFX</em></p><br/>

<p>The copyright status of the program is unkown, there is no hint whatsoever regarding copyright. The programer seems to be known as "Shiru". Thanks for your software!</p>

<p>Right clicking on such a file allows you to "convert" it to vectrex usage (including sample code). The vectrex "player"-code was done by a proboard member which goes by the name "Vectrexrc"... Thanks!</p>

<p>Nothing more - nothing less...</p>
<hr />
<h1>VecVoice/VecVox+</h1>
<br/><p align="center">
<img src="pics/VecSpeech.png" width="1020" height="598" /><br/>
<em>VecSpeeech panel</em></p><br/>

<p>Accessable via the popup-menu on the tree is a menu entry called: "VecVoice/VecVox+". Using the above displayed panel you can add support for speech to your vectrex programs.</p>

<p>Since the VecVoice system is more or less depricated, the support mainly focuses on VecVox, although most of the below stated features also work for VecVoice.</p>

<p>Featured on these panels are following "helpers":
<ul><li>
<p>support of a "phrasealtor" dictionary (VecVox+ only)</p>
</li><li>
<p>support of a translation from text to phonemes using the NRL Report 7948<br />
  "AUTOMATIC TRANSLATION OF ENGLISH TEXT TO PHONETICS<br />
	            BY MEANS OF LETTER-TO-SOUND RULES"<br />
(seperately implemented for SPL0256Al2 and SpeakJet)</p>
</li><li>
<p>on the fly switching between the chips</p>
</li><li>
<p>switching the above "translations" on/off</p>
</li><li>
<p>enter "free" text</p>
</li><li>
<p>enter direct commands by "escaping" commands</p>
</li><li>
<p>double click on the dictionary table adds commands</p>
</li><li>
<p>(right) double click on dictionary table plays the underlying phoneme</p>
</li><li>
<p>(thru emulation) on the fly listening to the entered data</p>
</li><li>
<p>data and code generation ready to use for your vectrex assembly</p>
</li><li>
<p>support of the "jetphones.inc" for better readability of your sources</p>
</li></ul>
</p>

<p>The panel is devided into 2 main regions, left (mainly input) and right (mainly information/dictionary - tables).</p>

<p>You can enter the text you want to convert to speech commands in the textarea titled "Text".</p>
<h3>Phrasealator</h3>

<p>(Only VecVox+) The phrasealator consists of a freely available dictionary file availble from the manifacturer of the SpeakJet (see: <a target="_blank" href="http://magnevation.com/">http://magnevation.com/</a>). It consists of rules for building english words using the speakjet commands.</p>

<p>The file: "Phrasealator.Dic" can be found in the directory: "template", the file is a ascii key&larr;&gt;value table, which can be edited and extended. <br />
 <br />
Noteworthy:<br />
The Manifacturer of the SpeakJet has a tool called "Phase a lator" for free download with which the dictionary can be easily extended, and if you have the right hardware, can be listened to on a real SpeakJet on the fly.<br />
(The tool is written in visual basic and is only available under windows) </p>
<h3>Naval: Text to Speech</h3>

<p>What this is &rarr; google is your friend, search for "NRL Report 7948".</p>

<p>This feature can be activated additionally to the Phrasealator, and will be used to convert all text, that the above does not recognize.</p>
<h3>Other</h3>

<p>The <img src="pics/control_play_blue.png" alt="control_play_blue.png" /> - button can be used to play back (emulated) the current entered text. </p>
<h3>Technical</h3>

<p>The communication from vectrex to the VecVoXX is done by a serial communication 9600 baud 8n1. The known vectrex speech devices communicate using that protocol via the joystick port. <br />
The only usable "source" of knowledge came from an old source code of Alex Herbert.</p>

<p>The actual communication as said is done via the joystick port. <br />
The joystick port on the other hand is not directly connected to an easily accessable vectrex device. The joystick port is connected to the sound chip. And is reachable via register 14 of the soundchip. The soundchip on the other hand also can not be addressed directly, here one has to communicate via VIA.<br />
 <br />
</p>

<p>So the actual communication goes like this:
<ul><li>
<p>assume you want to tell the VecVoice device to receive the byte value "128" (IY)</p>
</li><li>
<p>for that one must transfer 10 bits to VecVoice (8n1): 0 (startbit), 1000 0000 (data), 1(stopbit)</p>
</li><li>
<p>the communication with VecVoice is done via bit 4 of PSG Port A (that is the first button of the second joystick)</p>
</li><li>
<p>so we one must ensure that the above bit sequence is sent "through" that (PSG Port A-) bit, and each bit is held for about 156 vectrex "cycles", this is roughly 9600 baud</p>
</li><li>
<p>the thing that Alex came up with (and I didn't know about, and which thoroughly confused me at first...):<br />
in his code it looks like that the above said bit is set by using the PSG Port A enable bit in Register 7 of the PSG, which at first did not make any sense. <br />
But probably the following is actually going on:
<ol><li>
<p>the output of PSG port A is initialized right in the beginning to "1110 1111", this is a bit mask for bit 4</p>
</li><li>
<p>it seems that the PSG internally remembers that value for eternity if you do not actually CHANGE the output again</p>
</li><li>
<p>what I mean by that is: <br />
even when port A receives data (in input mode), once you switch to output mode, the above set "output" data reappears</p>
</li><li>
<p>when port A is in input mode the connected device (here our speech device) can still (sort of) read port A, after all - the cables are still connected - and what they always seem to receive is: "1111 1111" - when port A is in input mode</p>
</li><li>
<p>so ... using the above mask, you can change the status of bit 4 of PSG port A by "simply" changing PSG port A from input to output mode</p>
</li><li>
<p>that again is done by bit 6 of PSG register 7</p>
</li><li>
<p>(actually VecVoice expects the bits inverted, but since the enable register is zero active, which is sort of also inverted, the double invertedness cleverly resolves itself within the communication routine)</p>
</li></ol>
</p>
</li><li>
<p>so with that knowledge...</p>
</li><li>
<p>select on VIA Port b to communicate with the sound chip (mux select&rarr;soundchip, mux enable, BDIR and BC1 to :latch ])</p>
</li><li>
<p>set VIA Port a to the register you want to address (psg register 7, because we must read 7 befor we set anything, so we know what we must set)</p>
</li><li>
<p>of the value we got from register 7 we set bit 6 to 0 if we want to send a "0" bit and to 1 if we want to send "1" bit</p>
</li><li>
<p>write that value to VIA port A (which with mux select and enable goes to PSG)</p>
</li><li>
<p>keep the latch to 7 and set in VIA port B BDIR/BC1 to write</p>
</li><li>
<p>wait 156 cycles and repeat for the other 9 bits</p>
</li><li>
<p>voila - you just sent 1 byte to VecVoice!</p>
</li></ul>
</p>

<p>For the SP0256AL I got some pretty good samples, for the SpeakJet the current samples I am using have same crackling noises :-(.</p>

<p>I have not connected any of the speech devices to any of my hardware yet - I will do so as soon as I am able to.</p>

<p>The SP0256AL is pretty straight forward, and can be (in my opinion) emulated quite well using samples. Although in the meanwhile there DOES exist a correct software emulation of that chip, it was done by "Joseph Zbiciak" for his intellivision emulator and is now also used by the Mame/Mess team. But unless something serious happens, I will probably not port that code to java and use it. After all the SP0256AL is pretty old, and won't be used for any future development tasks (and that is what Vide is about...)</p>

<p>The SpeakJet on the other hand is quite up to date, still available and has many more advances features! The emulation of SpeakJet is rudimentary at best, especially as long as I am not able to listen to the real thing.</p>

<p>I started emulation of some of the more advances features (different pitches, time stretching, repeat etc), most of them are implemented, and the output DOES sound different than without ... - but that is about it - different...</p>

<p>I used a library called: TarsosDSP which provides methods to do pitch shifting, time stretching etc, it is pretty easy to use, comes with all sources and is licenced under GPL V3.</p>

<p>The thing is - while the library is great -  it works much better with larger samples... The samples used for the phonemes are quite tiny, anything from 40ms to 700ms at most. These small durations are not handled well, since for the DSP processing frequency windows and overlaps must be found, and the search corridors within the library are also in about 20-50 ms. This makes the results somewhat "not quite so nice".</p>
<hr />
<h1>Code Generation</h1>

<p>Vide, mainly through vedi, supports generating code for various purposes.</p>

<p>Upon creating a project:
<ul><li>
<p>main game loop</p>
</li><li>
<p>bankswitching</p>
</li><li>
<p>eEprom support</p>
</li></ul>
</p>

<p>Using aditional tools available from vedi menus:
<ul><li>
<p>building and play routines for samples</p>
</li><li>
<p>conversion and play routines for mod files</p>
</li><li>
<p>building and display of raster images</p>
</li><li>
<p>building and play of YM-files</p>
</li><li>
<p>building and play of AYFX sound effects</p>
</li><li>
<p>building and play of vecVoice/vecVox data</p>
</li></ul>
</p>

<p>With the help of veccy:
<ul><li>
<p>building and display of vector images</p>
</li><li>
<p>building and play of vectorlists
<ul><li>
<p>different vectorlist types </p>
</li><li>
<p>animations</p>
</li><li>
<p>scences</p>
</li></ul>
</p>
</li></ul>
</p>

<p>Once planned but not done code generation: Veclink cables.<br />
 <br />
- The code generation would have been little more than the provided examples. The code can not easily be used in ones own code and be at the same time used as an example. </p>

<p>For that reason I left these out as code generations. The provided examples are well documented and should give anyone interested in implementing a game or other binary a good starting point and many routines can be just copied and pasted from that base. </p>
<hr />
<h1>Game loop</h1>

<p>When creating a new project (or create a new file of type "vectrex") one is given the choice to create a standard vectrex game loop.</p>

<p>The project window looks like:</p>
<br/><p align="center">
<img src="pics/GameLoop1.png" width="711" height="635" /><br/>
<em>new project window</em></p><br/>

<p>If you select (like in the window shown) the checkbox "create standard game loop", that said game loop file will be created (in the example, a file called "MainLoopTest.asm").</p>

<p>Also the standard vectrex include file: "VECTREX.I" will be copied to the new project directory. The whole scenario than looks like:</p>
<br/><p align="center">
<img src="pics/GameLoop2.png" width="998" height="990" /><br/>
<em>Game loop created window</em></p><br/>
<h3>Game Loop</h3>

<p>The game loop is a section of the vectrex program that is (more or less) repeated throughout the complete lifecycle of the game.</p>

<p>It often starts with a recalibration routine (ensuring a stable, flicker free display). Other parts of the game loop handle:
<ul><li>
<p>player input</p>
</li><li>
<p>sound generation and output</p>
</li><li>
<p>caclulations (e.g. colision detection)</p>
</li><li>
<p>display</p>
</li></ul>
</p>

<p>The order of these can change - but most of the time at least the above are present. In a clean (not to optimized) program the game loop can most of the time be easily recognized by the recalibration, a couple of instructions mainly consisting of calling subroutines and jumping back to the start of the loop.</p>

<p>In more sophisticated programs main loops might not so easily be recognized.</p>

<p>The game loop created by vide is fairly simple and easily recognizable. The loop is contained in the section between:<br />
<tt>main: <br />
...<br />
...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BRA &nbsp;&nbsp;&nbsp; main</tt><br />
</p>

<p>Further enhancements of the main loop should be inserted there (for starters preferable in calling subroutines which handle the tasks you think of).</p>

<p>The created game loop by vide can be run out of the box, but it does not represent more than a little "hello world" program:</p>
<br/><p align="center">
<img src="pics/GameLoop3.png" width="402" height="502" /><br/>
<em>Hello world window</em></p><br/>
<hr />
<h1>Bankswitching</h1>

<p>When creating a new project one can also create projects that support bankswitching.</p>

<p>As of now two different bankswitch schemes are supported:
<ul><li>
<p>"Dondzila" Bankswitching (2 banks)</p>
</li><li>
<p>"VecFlash" Bankswitching (up to 64 banks)</p>
</li></ul>
</p>

<p>In order to create code for these schemes you must:
<ul><li>
<p>check the checkbox "create standard game loop"</p>
</li><li>
<p>check the checkbox "create bankswitch code"</p>
</li><li>
<p>and you must select what kind of bankswitching you want</p>
</li><li>
<p>if vecflash is chosen, you have to give the number of banks (combobox)</p>
</li></ul>
</p>

<p>In the table below the checkboxes you can enter filenames for each bank (if left blank, than standard filenames will be created). You can even use the same filename for different banks. Column 3 of the table ("define(s)") allows you to enter a "DEFINE" so you can chose sections in your main file to include/exclude.</p>

<p>The project window (for a "Dondzila"-Bankswitching) looks like:</p>
<br/><p align="center">
<img src="pics/BankSwitch1.png" width="709" height="630" /><br/>
<em>new project window</em></p><br/>

<p>The result is two generated files for "Main" (since I did not give any file names they are named "mainBank0.asm" and "mainBank1.asm").</p>
<br/><p align="center">
<img src="pics/Bankswitch2.png" width="1119" height="1281" /><br/>
<em>created files</em></p><br/>

<p>The files are documented, and can be run in vide straight out of the box. The program only displays a string "bank 0", if any button is pressed, the bank is switched and "bank 1" is displayed.</p>
<br/><p align="center">
<img src="pics/Bankswitch3.png" width="405" height="504" /><br/>
<em>bank 0</em></p><br/>
<br/><p align="center">
<img src="pics/Bankswitch4.png" width="403" height="505" /><br/>
<em>bank 1</em></p><br/>
<hr />
<h1>eEprom DS2430A</h1>

<p>When creating a new project one can also create projects that support eEprom reading and writing.</p>

<p>For this example disable the "create standard game loop" creation (otherwise you get two main files, and the default won't be the eEprom example file).</p>

<p>Chose the settings like: (and press "create")</p>
<br/><p align="center">
<img src="pics/eEprom1.png" width="708" height="629" /><br/>
<em>new project window</em></p><br/>

<p>In order for the example to be runable select the created file: "ds2430ExampleMain.asm", right click to show the popup-Menu and select "set as Main".</p>

<p>With this you tell the current project that the selected file should be treated as the main file, meaning - this file must be assembled.</p>
<br/><p align="center">
<img src="pics/eEprom2.png" width="537" height="394" /><br/>
<em>changing main file</em></p><br/>

<p>As you see a couple of files (include files for low level access) are created along with the main file.</p>
<br/><p align="center">
<img src="pics/eEprom4.png" width="951" height="1277" /><br/>
<em>file structure</em></p><br/>

<p>There only two methods and one variable worth mentioning of the included files:
<ul><li>
<p>you must declare a RAM space of 32 consecutive bytes, in the example the name for that space is <tt>"eeprom_buffer"</tt> (that buffer should beforehand be filled with a "standard" setting, in case the eEprom is first used and thus empty)</p>
</li><li>
<p>upon starting the cartridge, you read the eEprom <tt>"JSR eeprom_load"</tt> (transfer 32 bytes to the above mentioned buffer - or upon first access reset the eEprom with the default values)</p>
</li><li>
<p>upon changing data in the buffer, that you wish to persist call <tt>"JSR eeprom_save"</tt>.</p>
</li></ul>
</p>

<p>That is all.</p>

<p>The example program just increases a counter each time it is started.<br />
(technically in vide the savestate is saved in a file with the name of the "bin" concatinated with "ds2430.ser" -  java serialization)</p>
<br/><p align="center">
<img src="pics/eEprom3.png" width="741" height="507" /><br/>
<em>running</em></p><br/>
<hr />
<h1>Samples</h1>

<p>Samples and sample playing code is generated in vedi, using the popup on the project file tree. By chosing the entry "build vectrex samples" the dialog for sample generation is displayed. (see also the vedi&rarr;Samples documentation)</p>
<br/><p align="center">
<img src="pics/SampleCodeGen0.png" width="303" height="362" /><br/>
<em>build samples in vedi</em></p><br/>
<br/><p align="center">
<img src="pics/SampleCodeGen1.png" width="639" height="653" /><br/>
<em>samples dialog</em></p><br/>

<p>Exiting the above dialog with "create source" will (...hm...) create sources in the current project directory. <br />
(After asking for a name for the file which is to be generated. In the following it is assumed that the name given is <tt>"TestSample"</tt>.) <br />
The generated sources are accompanied by an example player program. </p>

<p>Following sources are generated:
<ul><li>
<p><tt>digitalPlayer.i</tt><br />
the subroutines which do the actual playing of samples</p>
</li><li>
<p><tt>VECTREX.I</tt> <br />
which is needed by the player</p>
</li><li>
<p><tt>TestSample.asm</tt><br />
a file with the actual sample data </p>
</li><li>
<p><tt>TestSampleMain.asm</tt><br />
a "main" file, with an example vectrex runnable "cartridge" file</p>
</li></ul>
</p>

<p>A vectrex playable binary file can be generated by setting the generate SampleMain file as the main file in the project.</p>
<br/><p align="center">
<img src="pics/SampleCodeGen2.png" width="371" height="407" /><br/>
<em>set example player as main</em></p><br/>

<p>The format and the actual play routines are documented in the source code. Just a few bullet points...
<ul><li>
<p>the provided sample player routines do not use the PSG chip</p>
</li><li>
<p>the digital audio data is send through the DAC, the resulting analog voltages are transfered by the correct MUX settings directly to the sound hardware</p>
</li><li>
<p>playing samples this way on (what I think) new vectri (3rd generation) results in very low volumes, this seems to be hardware related</p>
</li><li>
<p>the provided sample routines play the data backwards</p>
</li><li>
<p>the sample "generator" can build samples in different sample rates. The higher the sample rate the better the quality. The higher the sample rate, the more memory is used. The higher the sample rate, the more cycles the player routines must use. So - you have to experiment yourself what is your threshold for quality.</p>
</li><li>
<p>the provided sample routines are "general" if you plan to do your own game with samples, you probably should fit them to your specific needs.</p>
</li><li>
<p>the general idea is, that you have to feed the audio hardware with samples in respect to the current sample rate (you get the idea, sample rate of 5000 &rarr; you have to update the audio hardware 5000 times per second)</p>
</li><li>
<p>the best quality is provided if your routines concentrate only on feeding the audio hardware</p>
</li><li>
<p>but: most of the time you also want to draw something<br />
some routines are provided (String printing, and vectorlist drawings) which also do screen updates and (roughly) update the audio hardware in time</p>
</li><li>
<p>this updating - depending on the stuff that is written or drawn - does not always come "in time" for that reason the quality is not "perfect", but most of the time at least "ok"</p>
</li></ul>
</p>

<p>Provided subroutines, that also play sample data "in between" when needed:<br />
<tt>
<ul><li>
<p>wait_recal_digitj </p>
</li><li>
<p>intensity_a_digitj</p>
</li><li>
<p>move_to&nbsp;d_digitj</p>
</li><li>
<p>draw_vlc_digitj</p>
</li><li>
<p>Print_Str_digit</p>
</li></ul>
</tt></p>

<p>The sample generator generates:</p>

<p><i>Data - <tt>TestSample.asm</tt></i><br />

<ul><li>
<p>the data of the sample (backwards) and labels for the data<br />
LabelNames: <tt>TestSample_data, TestSample_data_start, TestSample_data_end</tt></p>
</li><li>
<p>a memory word location with the length of the sample<br />
LabelName: <tt>TestSample_length</tt></p>
</li><li>
<p>a constant which defines the sample rate:<br />
ConstantName: <tt>TESTSAMPLE_SAMPLERATE</tt></p>
</li></ul>
</p>

<p><i>Subroutines - <tt>digitalPlayer.i</tt></i><br />

<ul><li>
<p>this file contains above mentioned routines</p>
</li><li>
<p>also included are macro definitions and calculations in respect to the sample rate of the data</p>
</li><li>
<p>in the file there are also RAM locations used, for the default example these start at $c880. 12 bytes are needed. You can easily change these values - see top of the file.</p>
</li><li>
<p>sample setup is done by the subroutine, <tt>init_digit_sound</tt> with parameters D = sample start, and X pointer to sample length</p>
</li><li>
<p>subsequent calling of any of the <tt>"..._digit"</tt> functions plays the sample</p>
</li><li>
<p>there is one other flag that can be set: &rarr; the RAM location <tt>digit_looping</tt> if set to 1 than the sample will be looped, if 0 than not</p>
</li></ul>
</p>

<p><i>Example - <tt>TestSampleMain.asm</tt></i><br />

<ul><li>
<p>this is the main program, that can be assembled to a vectrex binary</p>
</li><li>
<p>this is pretty straight forward - just read it...</p>
</li></ul>
</p>

<p>(not further mentioned, but also generated: "VECTREX.I")</p>
<br/><p align="center">
<img src="pics/SampleCodeGen3.png" width="795" height="495" /><br/>
<em>sample data that is generated</em></p><br/>
<br/><p align="center">
<img src="pics/SampleCodeGen4.png" width="401" height="505" /><br/>
<em>example that is generated (sample is looping)</em></p><br/>
<br/><p align="center">
<img src="pics/SampleCodeGen5.png" width="840" height="1048" /><br/>
<em>start of digitalPlayer.i</em></p><br/>
<hr />
<h1>Mod-Files</h1>

<p>Mod conversion and playing code is generated in vedi, using the popup on the project file tree. By chosing the entry "build vectrex mod" the dialog for mod generation is displayed. (see also the vedi&rarr;Mod-Conversion documentation)</p>

<p>The popup menu is only activated while a mod file is selected in the current project. You have to download or create mod files befor you can convert them. If you have a mod file available (e.g. in the following example in the codelib directory&rarr;lineart), you can easily add the file to your project. Place the mousecursor over the project name and press the right mouse button.</p>
<br/><p align="center">
<img src="pics/ModCodeGen0.png" width="240" height="220" /><br/>
<em>add a file to the project</em></p><br/>

<p>Chose "add file"... and navigate in the resulting file choser to the mod file of your desire.</p>
<br/><p align="center">
<img src="pics/ModCodeGen1.png" width="537" height="469" /><br/>
<em>add a mod file</em></p><br/>

<p>By chosing a file - the file is <i>copied</i> to the project directory and is NOW available.</p>
<br/><p align="center">
<img src="pics/ModCodeGen2.png" width="315" height="372" /><br/>
<em>build mod in vedi</em></p><br/>

<p>Selecting "build vectrex mod" opens the mod - dialog:  (which is explained in "Mod-Conversion")</p>
<br/><p align="center">
<img src="pics/ModCodeGen4.png" width="761" height="491" /><br/>
<em>build mod in vedi</em></p><br/>

<p>Exiting the above dialog with "create source" will (...hm...) create sources in the current project directory. <br />
(The name of the generated sources are derived from the chosen mod file. In the following it is assumed that the name given is <tt>"music.mod"</tt>.) <br />
The generated sources are accompanied by an example player program. </p>

<p>Following sources are generated:
<ul><li>
<p><tt>modPlayer.i</tt><br />
the subroutines which do the actual playing of vectrex "mods"</p>
</li><li>
<p><tt>VECTREX.I</tt> <br />
which is needed by the player</p>
</li><li>
<p><tt>music.asm</tt><br />
a file with the actual mod data </p>
</li><li>
<p><tt>musicMain.asm</tt><br />
a "main" file, with an example vectrex runnable "cartridge" file</p>
</li></ul>
</p>

<p>A vectrex playable binary file can be generated by setting the generate musicMain file as the main file in the project.</p>
<br/><p align="center">
<img src="pics/ModCodeGen5.png" width="308" height="433" /><br/>
<em>set example player as main</em></p><br/>

<p>The format and the actual play routines are documented in the source code. <br />
Just a few bullet points...
<ul><li>
<p>the provided player routine is similar to the BIOS routine.</p>
</li><li>
<p>the data that results in the mod conversion is (apart from the SILENCE value) exactly the same as the BIOS vectrex music data and therefor not further explained here</p>
</li><li>
<p>in addition to the "music" data, the new format supports a ADSR and TWANG table for each voice, the given music structure looks the same, but the expected ADSR and TWANG data should be tripple the size - look at the generated mod files as an example</p>
</li><li>
<p>the generated data is "verbose" and uses named constant labels for note representation and silence values - and is therfor quite readable (and thus resembles a tracker data also)</p>
</li><li>
<p>each mod "pattern" is converted to a vectrex "song"</p>
</li><li>
<p>to play a complete mod, one must play all songs (previous patterns) in the order of the original patterns</p>
</li><li>
<p>for that a song table (previous pattern table) is generated, which keeps all songs (and song repetitions) </p>
</li><li>
<p>the order and setting of songs is not done withing the player, but is kept in the example main program within sixteen lines of code (see: <tt> loadmusic </tt> )</p>
</li></ul>
</p>

<p>Playing a mod<br />
Is done exactly (with respecting above mentioned patterns...) like playing a vectrex song. The actual pointer to the current song (pattern) is kept in the (RAM) variable: <tt> plr_geilmusik</tt>. With that variable set to the right place, you call the new <tt> Init_Music_chk_mod </tt> befor your recalibration, and after the recalibration the BIOS <tt> Do_Sound</tt> function.</p>

<p>Done</p>
<br/><p align="center">
<img src="pics/ModCodeGen6.png" width="1053" height="1278" /><br/>
<em>the complete main, including the pattern -&gt; song ordering</em></p><br/>
<br/><p align="center">
<img src="pics/ModCodeGen7.png" width="1055" height="1270" /><br/>
<em>example of a generated data file</em></p><br/>
<hr />
<h1>Raster images</h1>

<p>Raster image conversion and display code is generated in vedi, using the popup on the project file tree. By chosing the entry "convert image to vectrex raster" the dialog for image conversion is displayed. (see also the vedi&rarr;Raster images documentation)</p>

<p>The popup menu is only activated while an image file is selected in the current project. You have to download or create image files befor you can convert them. If you have a file available, you can easily add the file to your project. Place the mousecursor over the project name and press the right mouse button.</p>
<br/><p align="center">
<img src="pics/RasterCodeGen0.png" width="207" height="186" /><br/>
<em>add a file to the project</em></p><br/>

<p>Chose "add file"... and navigate in the resulting file choser to the image file of your desire.</p>
<br/><p align="center">
<img src="pics/RasterCodeGen1.png" width="505" height="358" /><br/>
<em>add an image file</em></p><br/>

<p>By chosing a file - the file is <i>copied</i> to the project directory and is NOW available.</p>
<br/><p align="center">
<img src="pics/RasterCodeGen2.png" width="269" height="352" /><br/>
<em>convert image to vectrex raster</em></p><br/>

<p>Selecting "convert image to vectrex raster" opens the - dialog:  (which is explained in "Raster images")</p>
<br/><p align="center">
<img src="pics/RasterCodeGen6.png" width="716" height="648" /><br/>
<em>convert image dialog</em></p><br/>

<p>Exiting the above dialog with "create" will (...hm...) create sources in the current project directory. <br />
(The name of the generated sources are derived from the chosen file. In the following it is assumed that the name given is <tt>"ghost.png"</tt>.) <br />
The generated sources are accompanied by an example raster display program. The example routine is programmed for bi directional raster data, if you want to use the provided routines - be sure that the corresponding checkbox is checked.</p>

<p><b>Note:<br />
</b> You can chose whether you want to generate uni- or bi- directional data (and examples).
<ul><li>
<p>bi directional data will be drawn:<br />

<ol><li>
<p>positioning of the beam</p>
</li><li>
<p>draw one line forward</p>
</li><li>
<p>draw one line backward</p>
</li><li>
<p>do 2) and 3) till finished This is in comparisson quite fast, but the result is prone to be "italic" due to vectrex drift</p>
</li></ol>
</p>
</li><li>
<p>uni directional data will be drawn:<br />

<ol><li>
<p>zeroing and positioning of the beam</p>
</li><li>
<p>draw line forward</p>
</li><li>
<p>do 1) and 2) till finished This is in comparisson quite slow (nearly double time as bi), but the result very "clear" and is immune to drift</p>
</li></ol>
</p>
</li></ul>
</p>

<p>Following sources are generated:
<ul><li>
<p><tt>rasterDraw.asm</tt><br />
the subroutines to display a raster "image"</p>
</li><li>
<p><tt>VECTREX.I</tt> <br />
which is needed by the source</p>
</li><li>
<p><tt>ghost.asm</tt><br />
a file with the actual image data </p>
</li><li>
<p><tt>ghostMain.asm</tt><br />
a "main" file, with an example vectrex runnable "cartridge" file</p>
</li></ul>
</p>

<p>A vectrex playable binary file can be generated by setting the generate ghostMain.asm file as the main file in the project.</p>
<br/><p align="center">
<img src="pics/RasterCodeGen3.png" width="327" height="390" /><br/>
<em>set example main</em></p><br/>

<p>The format and the actual display routines are documented in the source code. Just a few bullet points...
<ul><li>
<p>the actual display routine is called <tt> draw_raster_image </tt> and expects a pointer to the image data in register U</p>
</li><li>
<p>as with BIOS raster routines (printStr), the size of the image can be set with BIOS RAM locations:<br />
<tt> Vec_Text_Height </tt> and <tt> Vec_Text_Width </tt></p>
</li><li>
<p>in the example these are filled with defined constants (see top of main file): WIDTH and HEIGHT</p>
</li><li>
<p>the raster display example routines kept in the file <tt>rasterDraw.asm</tt> were put together in a few "minutes", and can probably be optimized. Just keep in mind, that the actual update of the ShiftReg should be done in 18 cycles (less - skips data and VIA can stall on certain cycle counts, more - are "a waste of time"...)</p>
</li></ul>
</p>
<br/><p align="center">
<img src="pics/RasterCodeGen4.png" width="855" height="874" /><br/>
<em>example main</em></p><br/>

<p>The actual generated raster data is kept in the file <tt>ghost.asm</tt> :</p>
<br/><p align="center">
<img src="pics/RasterCodeGen5.png" width="1090" height="939" /><br/>
<em>ghost.asm</em></p><br/>
<br/><p align="center">
<img src="pics/RasterCodeGen7.png" width="341" height="393" /><br/>
<em>example raster display</em></p><br/>
<hr />
<h1>YM-Files</h1>

<p><b>Note:</b><br />
YM generation can take a few seconds to finish. If you open the utility directly, the output goes to the debug window. So if you want to follow the progress - you should open the debug log.<br />
Once generation finishes, a vedi window will open!</p>

<p>--</p>

<p>YM file conversion and play code is generated in vedi, using the popup on the project file tree. By chosing the entry "build vectrex YM" the dialog is displayed. (see also the vedi&rarr;YM-Conversion documentation(s))</p>

<p>The popup menu is only activated while a ym file is selected in the current project. You have to download (or create ym) files befor you can convert them (in the configuration section under edit you can download a few thousand [wait a little for the download to finish]).</p>

<p>If you have a file available, you can easily add the file to your project. Place the mousecursor over the project name and press the right mouse button.</p>
<br/><p align="center">
<img src="pics/YMCodeGen0.png" width="193" height="172" /><br/>
<em>add a file to the project</em></p><br/>

<p>Chose "add file"... and navigate in the resulting file choser to the file of your desire.</p>
<br/><p align="center">
<img src="pics/YMCodeGen1.png" width="509" height="358" /><br/>
<em>add a ym file</em></p><br/>

<p>By chosing a file - the file is <i>copied</i> to the project directory and is NOW available.</p>
<br/><p align="center">
<img src="pics/YMCodeGen2.png" width="279" height="336" /><br/>
<em>build vectrex YM</em></p><br/>

<p>Selecting "build vectrex YM" opens the - dialog:  (which is explained in "vedi&rarr;YM-Conversion II")</p>
<br/><p align="center">
<img src="pics/YMCodeGen3.png" width="1028" height="601" /><br/>
<em>convert ym dialog</em></p><br/>

<p>Exiting the above dialog with "create" will (...hm...) create sources in the current project directory [the dialog must be closed manually, this can be done directly after generation started, you do not have to wait until generation of the source is finished]. <br />
(The name of the generated sources are derived from the chosen file. In the following it is assumed that the name given is <tt>"Last Ninja.ym"</tt>.) <br />
The generated sources are accompanied by an example ym player routine [if create player was selected in the dialog]. </p>

<p>Following sources are generated:
<ul><li>
<p><tt>ymPlayer.i</tt><br />
the subroutines to play ym-data</p>
</li><li>
<p><tt>VECTREX.I</tt> <br />
which is needed by the source</p>
</li><li>
<p><tt>LASTNINJ.asm</tt><br />
a file with the actual data </p>
</li><li>
<p><tt>Last NinjaMain.asm</tt><br />
a "main" file, with an example vectrex runnable "cartridge" file</p>
</li></ul>
</p>

<p>A vectrex playable binary file can be generated by setting the generate "Last NinjaMain.asm" file as the main file in the project.</p>
<br/><p align="center">
<img src="pics/YMCodeGen4a.png" width="317" height="358" /><br/>
<em>set example main</em></p><br/>

<p>The format and the actual display routines are documented in the source code - and quite extensibly in the above other mentioned pages.</p>

<p>Just a few bullet points...
<ul><li>
<p>the initialization routine is called <tt> init_ym_sound </tt> and expects the ym-sound data structure in register U. This must be called befor a new ym-file is to be played.</p>
</li><li>
<p>the actual ym routine is called <tt> do_ym_sound </tt> that routine should be places somewhere in your main loop</p>
</li><li>
<p>the generated ym player respects the settings of the dialog (like skipping certain registers, or playing uncompressed ym data)</p>
</li></ul>
</p>
<br/><p align="center">
<img src="pics/YMCodeGen4.png" width="1022" height="741" /><br/>
<em>example main</em></p><br/>
<br/><p align="center">
<img src="pics/YMCodeGen5.png" width="385" height="474" /><br/>
<em>example ym player</em></p><br/>
<hr />
<h1>AYFX sound effects</h1>

<p>AYFX file conversion and play code is generated in vedi, using the popup on the project file tree. By chosing the entry "build vectrex ayfx" the dialog is displayed (see also the vedi&rarr;AYFX-Conversion documentation).</p>

<p>The popup menu is only activated while a ayfx file is selected in the current project. You have to download (or create) files befor you can convert them (in the configuration section under edit you can download a few hundred [wait a little for the download to finish]).</p>

<p>If you have a file available, you can easily add the file to your project. Place the mousecursor over the project name and press the right mouse button.</p>
<br/><p align="center">
<img src="pics/AYFXCodeGen0.png" width="231" height="158" /><br/>
<em>add a file to the project</em></p><br/>

<p>Chose "add file"... and navigate in the resulting file choser to the file of your desire.</p>
<br/><p align="center">
<img src="pics/AYFXCodeGen1.png" width="510" height="357" /><br/>
<em>add a ayfx file</em></p><br/>

<p>By chosing a file - the file is <i>copied</i> to the project directory and is NOW available.</p>
<br/><p align="center">
<img src="pics/AYFXCodeGen2.png" width="297" height="294" /><br/>
<em>build vectrex ayfx</em></p><br/>

<p>Selecting "build vectrex ayfx" converts the ayfx files directly (no dialog, although you <i>can</i> edit ayfx files, for this you must use the ym-dialog): </p>

<p>The sources will be created in the current project directory. <br />
(The name of the generated sources are derived from the chosen file. In the following it is assumed that the name given is <tt>"metalgear&nbsp;1.afx"</tt>.) <br />
The generated sources are accompanied by an example ayfx player routine. </p>

<p>Following sources are generated:
<ul><li>
<p><tt>ayfxPlayer.i</tt><br />
the subroutines to play ym-data</p>
</li><li>
<p><tt>VECTREX.I</tt> <br />
which is needed by the source</p>
</li><li>
<p><tt>metalgear&nbsp;1.asm</tt><br />
a file with the actual data </p>
</li><li>
<p><tt>metalgear&nbsp;1Main.asm</tt><br />
a "main" file, with an example vectrex runnable "cartridge" file</p>
</li></ul>
</p>

<p>A vectrex playable binary file can be generated by setting the generate "metalgear&nbsp;1Main.asm" file as the main file in the project.</p>
<br/><p align="center">
<img src="pics/AYFXCodeGen3.png" width="356" height="383" /><br/>
<em>ayfx</em></p><br/>

<p>The actual play routines are documented in the source code, for the format of ayfx files look at the documentation of the AYFX editor (downloadable at: <a target="_blank" href="https://shiru.untergrund.net/software.shtml">https://shiru.untergrund.net/software.shtml</a>). You can also use the ym-conversion dialog in vedi to edit/create/extract ayfx files.</p>

<p>Just a few bullet points...
<ul><li>
<p>the AYFX routines were written by <i>Richard Chadd</i>, I have not modified them, they were released as a facebook posting for other vectrex interested people</p>
</li><li>
<p>for initialization following variables should be cleared: <tt> sfx_pointer </tt>(16 bit) and <tt> sfx_status </tt>(8 bit).</p>
</li><li>
<p>for playing a sound effect the address of the effect must be put into the <tt> sfx_pointer </tt> variable and a "1" into the <tt> sfx_status </tt> variable</p>
</li><li>
<p>in the main loop a subroutine <tt> sfx_doframe </tt> must be called, as long as the status is not 0</p>
</li><li>
<p>the provided example does only play one ayfx at a time and this hardcoded in channel 3 of the PSG chip</p>
</li><li>
<p>to use the other two sound registers, the routine has to be expanded</p>
</li></ul>
</p>
<br/><p align="center">
<img src="pics/AYFXCodeGen4.png" width="816" height="702" /><br/>
<em>example main</em></p><br/>
<br/><p align="center">
<img src="pics/AYFXCodeGen5.png" width="519" height="113" /><br/>
<em>ayfx data</em></p><br/>
<br/><p align="center">
<img src="pics/AYFXCodeGen6.png" width="396" height="504" /><br/>
<em>ayfx example</em></p><br/>
<hr />
<h1>VecVoice/VecVox</h1>

<p>(In the following section only examples for vecvox are discussed, substituting "vecvox" with "vecvoice" is allowed, since the code and examples are nearly identical.)<br />
</p>

<p>VecVoice/VecVox editing and building code is generated in vedi, using the popup on the project file tree. By chosing the entry "VecVoice/VecVox+" the appropriate dialog is displayed (see also the vedi&rarr;VecVoice/VecVox+ documentation).</p>
<br/><p align="center">
<img src="pics/VecVoxCodeGen0.png" width="320" height="348" /><br/>
<em>VecVoice/VecVox</em></p><br/>
<br/><p align="center">
<img src="pics/VecVoxCodeGen1.png" width="1026" height="663" /><br/>
<em>speech dialog</em></p><br/>

<p>Exiting the above dialog with "create source" will (...hm...) create sources in the current project directory. <br />
For the generated files the names are always the same, to use them in your own programs you have to change them to your likings. The speech dialog must be closed manually after generating the code. <br />
The generated sources are accompanied by an example player program. </p>

<p>Following sources are generated (provided the checkbox "create full example" was selected):
<ul><li>
<p><tt>vecvox.i</tt><br />
the subroutines which do the actual playing of speech</p>
</li><li>
<p><tt>ser_ji.i</tt><br />
low level subroutines used by the speech routines, they handle the serial communication for devices placed in joyport 1</p>
</li><li>
<p><tt>jetphones.inc</tt><br />
an "include" file done by <i>B. Watson</i>, which defines constants for better readability of vecvox commands</p>
</li><li>
<p><tt>VECTREX.I</tt> <br />
which is needed by the player</p>
</li><li>
<p><tt>speechData.i</tt><br />
a file with the actual speech data </p>
</li><li>
<p><tt>vecVoxMain.asm</tt><br />
a "main" file, with an example vectrex runnable "cartridge" file</p>
</li></ul>
</p>

<p>A vectrex playable binary file can be generated by setting the generate vecVoxMain.asm file as the main file in the project.</p>
<br/><p align="center">
<img src="pics/VecVoxCodeGen2.png" width="321" height="435" /><br/>
<em>set example player as main</em></p><br/>

<p>The format and the actual play routines are documented in the source code - and in the above mentioned other documentation.<br />
Just a few bullet points...
<ul><li>
<p>the communication and player routines were written by <i>Alex Herbert</i>, I changed and commented them slightly</p>
</li><li>
<p>the user needs only to access two subroutines:<br />
 <tt>vox_init</tt> once at the start of the program to initialize serial communciation of joyport 1<br />
 <tt>vox_speak</tt> to actually output data to the vecvox</p>
</li><li>
<p>the output of data to vecvox is initialized by storing the address of the speech data to the RAM variable:  <tt>vox_addr</tt></p>
</li></ul>
</p>
<br/><p align="center">
<img src="pics/VecVoxCodeGen3.png" width="720" height="953" /><br/>
<em>example main</em></p><br/>
<br/><p align="center">
<img src="pics/VecVoxCodeGen4.png" width="449" height="147" /><br/>
<em>example data</em></p><br/>
<br/><p align="center">
<img src="pics/VecVoxCodeGen5.png" width="399" height="507" /><br/>
<em>vecvox example</em></p><br/>
<hr />
<h1>Vector images</h1>

<p>Images can be "converted" to vector images, the conversion and display code can be generated by vecci and exported to vedi (see also the vecci&rarr;Vector images documentation).</p>
<br/><p align="center">
<img src="pics/VectorImageCodeGen0.png" width="310" height="257" /><br/>
<em>call the dialog</em></p><br/>

<p>In vecci you can find the relevant button in the tab "2d-tools". Upon pressing the button "image to vector" the conversion dialog is opened. In the upper left corner a small button <img src="pics/page_go.png" alt="page_go.png" /> is located, with that you can load an image.</p>
<br/><p align="center">
<img src="pics/VectorImageCodeGen1.png" width="1068" height="717" /><br/>
<em>handle the dialog</em></p><br/>

<p>In the lower right corner you can discern a button "to vecci", pressing that, the generated vectorlist is passed on to vecci (you have to close the dialog afterwards manually).</p>

<p>The generated vectorlist is <b>not</b> guaranteed to be "clean" (usable for vectrex) straight out of the box, it is wise to check the list on the tab "vectorlist status".  </p>
<br/><p align="center">
<img src="pics/VectorImageCodeGen2a.png" width="1125" height="388" /><br/>
<em>check vectorlist</em></p><br/>

<p>In the example you see, that there is at least one vector which is longer than 127 - that is <b>not</b> correct for vectrex.</p>

<p>Vecci is probably able to remedy any faults you encounter. In the provided example one must go to the tab "shortcuts" and press the button "split where needed". And the vectors which were to long are split in half.</p>
<br/><p align="center">
<img src="pics/VectorImageCodeGen2b.png" width="294" height="249" /><br/>
<em>use "split where needed"</em></p><br/>

<p>The generated vectorlist in vecci will most probably be not a closed list and as such is <b>not</b> exportable straight away. </p>

<p>To generate an exportable "setting", go to the tab "scenario" and press the button "seperate paths as scenario entries". Using that button - for each connected path a scenario vector list is generated and put into the scenario list at the bottom.</p>
<br/><p align="center">
<img src="pics/VectorImageCodeGen2.png" width="1222" height="896" /><br/>
<em>create a scenario</em></p><br/>

<p>The generated scenario can be used to generate and export code.</p>

<p>For that chose the tab "export" and there (for example) "text export".  In the lower half of the tab a section labeled "Animation/Scenario" is displayed. Usually for a scenario only the first and the fourth button is enabled. Pressing one of these buttons will generate source code. The generated data is displayed in the text area on that tab (the data is also copied to the system clipboard). Pressing the button <img src="pics/page_edit.png" alt="page_edit.png" /> opens the generated data in vedi (the file is copied to the tmp directory).</p>

<p>If <b>befor</b> pressing the generate button the checkbox "runnable" is selected, an example source code for direct binary generation is generated.</p>
<br/><p align="center">
<img src="pics/VectorImageCodeGen3.png" width="1175" height="884" /><br/>
<em>create a scenario</em></p><br/>

<p>The generated file is a standard vector-list drawing "program" - therefor not further explained here. The generated file in a "tmp" vedi:</p>
<br/><p align="center">
<img src="pics/VectorImageCodeGen4.png" width="1023" height="771" /><br/>
<em>example main</em></p><br/>
<br/><p align="center">
<img src="pics/VectorImageCodeGen5.png" width="387" height="471" /><br/>
<em>example vector image display</em></p><br/>
<hr />
<h1>Vectorlists</h1>

<p>Vectorlists of different fashion can be generated by vecci.</p>

<p>Most of the vectorlists are "standard" vectrex vectorlists and/or described in detail in the vecci section or by the generated source code itself. No further documentation is provided here.</p>
<hr />
<h1>codi</h1>
<br/><p align="center">
<img src="pics/codi.png" width="1023" height="765" /><br/>
<em>codi window</em></p><br/>

<p>Codi = codeLibrary</p>

<p>A collection of sources that are free or I have permission to include with VIDE. These are sources to vectrex binaries which can be assembled on the fly and run in vecxi. These sources can be investigated, studied or reused (within reason!).</p>

<p>Within the code library window you can not persist any changes, although you can edit, you can not save! If you need the code you will have to copy and paste!</p>

<p>Codi is "only" a view to a directory within VIDE. The directory is scanned for subdirectories and files and all that is there is displayed.</p>

<p>Where I could, I provided an "origin.txt" file, which gives more information where the "original" came from.</p>

<p>Some files were slightly modified so they can be assembled correctly.</p>

<p>Some examples:
<ul><li>
<p>Most of Fred Taft disassembled files, like 
<ul><li>
<p>Star Castle</p>
</li><li>
<p>Narrow Escape</p>
</li><li>
<p>Minestorm</p>
</li><li>
<p>etc</p>
</li></ul>
</p>
</li><li>
<p>Bruce Tomlin
<ul><li>
<p>SpectrumI+</p>
</li><li>
<p>BIOS</p>
</li></ul>
</p>
</li><li>
<p>John Dondzillas early public domain releases</p>
</li><li>
<p>Omega Chase (Christoper Tumber) [if I get permission]</p>
</li><li>
<p>and many many more, if I get permissions, as of now about 20 MB of vectrex sources</p>
</li></ul>
</p>

<p>Some examples/descriptions of my own programming can also be found in the "Programming" section of this help.</p>
<hr />
<h1>Example: Lightpen</h1>

<p>For the lightpen no "Code Generation" was done, since any generated code would have been an extensive example on its own.</p>

<p>Instead I provide an example in form of a "code snippet" within codi. (see:<br />
<tt> codelib/Snippets/Malban/Lightpen/LightpenExample.asm<br />
and <br />
codelib/Snippets/Malban/Lightpen/LightpenSubroutines.i</tt>)</p>

<p>Much of the example is reused code found in the Artmaster binary and the great disassembly of Fred Taft.</p>

<p>I enhanced his disassembly in two ways:
<ol><li>
<p>added further comments</p>
</li><li>
<p>extracted a couple of subroutines, which can be used "out of the box" without sorting out to much stuff</p>
</li></ol>
</p>

<p>Anyone interested in programming lighpen stuff should find it (I hope) to be quite easy to get going.</p>

<p>I didn't bother to provide examples for lightpen usage in port 0, I can't really seem to find much use for it, although the routines in general should be nearly the same. Further writings about lightpen in this documentation always assumes lightpen in port 1.</p>
<h2>In general</h2>

<p>The main (and actually - ONLY) communication that is going on between the lightpen and a vectrex is by whether "button 4" of joyport 1 is pressed or not. The lightpen internally reacts (how else could it be) on light. If the light is switched on the button is active (I say active here, in reality the state of the button goes low, but that is sort of confusing, lets just say light = active), if the light is switched off - the button is not active. The switching is done "lightning" fast. If you use your usual vectrex 50Hz display, the button is switched on/off 50 times per second, the "glow" of the vectors is in this case negligible.</p>

<p>Also, button four of the joytickport 1 is connected to the CA1 line of VIA, this enables us to very easily check whether the lightpen is active - or not (we do not have to check the PSG  all the time). </p>

<p>If the lightpen is active, CA1 will be 1 - true, or whatever you want to call it :-). This enables us to use the interruptflags of VIA to check whether the lightpen saw some light or not.</p>

<p>The interruptflag is usually configured that it is set upon the lightpen going from inactive to active. 
<ol><li>
<p>the IFR must be reset befor an interrupt can occur again</p>
</li><li>
<p>that lightpen must be inactive befor it goes active again in order for an interrupt to occur</p>
</li></ol>
</p>
<h3>Checking lightpen for a vector</h3>

<p>Remembering that, the general strategy to check for lightpen is:
<ul><li>
<p>clear flags</p>
</li><li>
<p>get something on the screen (one vector, one scanline of text,...) </p>
</li><li>
<p>check if interruptflag for CA1 is set</p>
</li><li>
<p>if set, remember for what vector the flag was set</p>
</li><li>
<p>and react on that whenever you have time to do so</p>
</li></ul>
</p>

<p>This is really straight forward.</p>

<p>It gets more complicated, when you do not have a vector that you want to react upon, like finding a lightpen which was placed on an empty screen, or if you want to use your lightpen to "drag" a vector around the screen.</p>

<p>In this cases you must think a bit around the corner...  </p>
<h3>Checking lightpen for a "move"/empty screen</h3>

<p>All strategies come down to using the above strategy. You can not check for light, without light! Therefor the two strategies the old artmasters came up with are: <br />
(you are invited to come up with your own...)<br />

<ul><li>
<p>Movement/Dragging &rarr; webbing<br />
The thought behind that is, that if you want to "move" something, you will do not big jumps, but move "slowly" in small steps. The method for checking is - to surround the last known position where the lightpen was found with a steadily in size increasing "web" (an 8 sided polygon). If one of the vectors the web consists of "reacts" on the lightpen (an interrupt occurs while drawing it), the location is calculated, based on the index of the vector (in the polygon), size of the web (vectors) and the scalefactor used to draw it. The result of the calculation is the new position.</p>
</li><li>
<p>Finding a lightpen on an empty screen &rarr; scanning<br />
With this method you fill the whole screen (bottom to top, left to right) with "scanlines" (122 scanlines). You check after each line was drawn if an interrupt occured, if yes, you have the y-coordinate. Now you still have to find the x-coordinate. Instead of "plotting" 122 dots on one line (which would habe been the 1:1 solution to scanning), the artmasters (Mark Indictor), came up with a calculative way. This time the said scanline is drawn again, but while drawing it, a counter is decreased, and the CA1 interrupt (which is usually only checked by a flag) this time actually <b>generates</b> an interrupt. Using the known scalefactor and the countdown while drawing the scanline, the x- position is calculated after the interrupt occured. The interrupt cleans up the stack and returns to the calling routine with the actual pair of y, x coordinates set to the X register.</p>
<br />
</li></ul>
</p>

<p>  Note on Interrupt:<br />
Although none of my VIA 6522 documentation describes this - the routines described below clear the Interrupt flag with <br />
<tt>"CLR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_int_flags"</tt><br />
this obviously works ok though ...</p>
<h2>Example routines</h2>

<p>The provided example shows four different lightpen "situations":
<ul><li>
<p>select a text (strategy one with string)</p>
</li><li>
<p>pick a vector (strategy one with vectors)</p>
</li><li>
<p>drag a point (webbing)</p>
</li><li>
<p>find a location (scanning)</p>
</li></ul>
</p>

<p>The code is well structed and documented, I will not document it here further.</p>

<p>The example main program includes a set of lightpen routines, which can be found in the above dscribed file:<br />
<tt> codelib/Snippets/Malban/Lightpen/LightpenSubroutines.i</tt> <br />
</p>

<p>That file includes a set of "public" routines, which can be "normally" used, and some routines which I like to describe as "private". Which a "user" not neccesarily must use, but which support the public rotuines.</p>

<p>Following public routines are available:</p>
<h3>print_with_pick_check</h3>

<p>This routine is very much like the ordinary <tt>Print_Str</tt> routine the BIOS offers.</p>

<p>As input a pointer in U Register is expected which points to  a string structure consisting of:<br />
<tt> DB height, width<br />
DB ypos, xpos<br />
DB "SOME TEXT", $80<br />
</tt></p>

<p>If a lightpen pick occured while printing the string, the variable "<tt>lightpen_pick</tt>" ($C89E) will be set to 2 if no pick occured it will be 0.</p>
<h3>draw_vector_with_pick_check</h3>

<p>This routine is very much like the ordinary <tt>Draw_Line_d</tt> routine the BIOS offers.</p>

<p>It draws a vector from the current position, using the current scale to the delta coordinates given in register D. On return register A is set to 2 if a lightpen pick occured and  if no pick occured it will be 0.</p>
<h3>search_screen_for_lightpen</h3>

<p>(This method uses 6 bytes of RAM, see documentation in source code)</p>

<p>This routine implements the above mentioned "scanning". After a call register A will be $ff if a lightpen pick was found or 0 if not. If a pick was found register X contains the location (scale factor $ff) as y, x. </p>
<h3>check_point_move</h3>

<p>(This method uses 12 bytes of RAM, see documentation in source code)</p>

<p>This routine implements the above mentioned "webbing". </p>

<p>This routine expects as input parameters in register X the "point" that might be moved, and in register A a flag whether the "point" was found by the lightpen the last time it was checked. </p>

<p>The return of the method is the same as the input:</p>

<p>After a call register A will be $ff if a lightpen pick was found or 0 if not. If a pick was found register X contains the location (scale factor $ff) as y, x. </p>
<br/><p align="center">
<img src="pics/LightPenExample1.png" width="559" height="695" /><br/>
<em>Lightpen example 1</em></p><br/>
<br/><p align="center">
<img src="pics/LightPenExample2.png" width="559" height="694" /><br/>
<em>Lightpen example 2</em></p><br/>
<br/><p align="center">
<img src="pics/LightPenExample3.png" width="558" height="693" /><br/>
<em>Lightpen example 3</em></p><br/>
<hr />
<h1>Example: VecLink V1</h1>

<p>With the information about the veclink cables I was given a couple of binaries.</p>

<p>One of the binaries ("vl_test.bin") is a test program for the veclink V1 cable. The program was most likely written by Alex Herbert.</p>

<p>I disassembled the program and commented it.</p>

<p>It is by now a very well documented example on how to use veclink V1.</p>

<p>It can be found in the directory:<br />
</p>

<p><tt> codelib/Snippets/Alex Herbert/VecLinkV1/vlink1.asm<br />
</tt><br />
The program can be assembled and run in vide.</p>

<p>If you want you can look at it and rip it apart, but keep in mind, that my documentation says that VecLink V2 is much more stable.</p>

<p>For more information look at the source to the example and possibly at the "Emulation: VecLink V1 + V2" section.</p>

<p>Let me remind you, that there is no way to "automatically" configure vide to run two vecx instances, you have to start two instances manually:</p>

<p>Manually meaning:
<ul><li>
<p>go to the main menu and start a vecx</p>
</li><li>
<p>select the veclink binary you would like to play</p>
</li><li>
<p>press start</p>
</li><li>
<p>select for port 0 the input device you would like to use</p>
</li><li>
<p>select for port 1 the veclink cable you would like to use, start with the "left" side (although it does not really matter which side is plugged in first)</p>
</li><li>
<p>repeat the above process for a second vecx instance, </p>
</li><li>
<p>for port 1 select the "other side" (right?) of the same veclink cable</p>
</li></ul>
</p>
<br/><p align="center">
<img src="pics/VecLink.png" width="802" height="460" /><br/>
<em>VecLink example</em></p><br/>
<hr />
<h1>Example: VecLink V2</h1>

<p>With the information about the veclink cables I was given a couple of binaries.</p>

<p>One of the binaries ("BerzerkArena") is fantastic prototype game made by Alex Herbert</p>

<p>I partly disassembled the program and commented it. I combined the disassembled serial communication routines with the example I had for VecLink V1. I guess by now it can also be seen as a well documented example on how to use veclink V2.</p>

<p>It can be found in the directory:<br />
</p>

<p><tt> codelib/Snippets/Alex Herbert/VecLinkV2/vecLinkV2.asm<br />
</tt><br />
The program can be assembled and run in vide.</p>

<p>For more information look at the source to the example and possibly at the "Emulation: VecLink V1 + V2" section.</p>

<p>Let me remind you, that there is no way to "automatically" configure vide to run two vecx instances, you have to start two instances manually:</p>

<p>Manually meaning:
<ul><li>
<p>go to the main menu and start a vecx</p>
</li><li>
<p>select the veclink binary you would like to play</p>
</li><li>
<p>press start</p>
</li><li>
<p>select for port 0 the input device you would like to use</p>
</li><li>
<p>select for port 1 the veclink cable you would like to use, start with the "left" side (although it does not really matter which side is plugged in first)</p>
</li><li>
<p>repeat the above process for a second vecx instance, </p>
</li><li>
<p>for port 1 select the "other side" (right?) of the same veclink cable</p>
</li></ul>
</p>
<br/><p align="center">
<img src="pics/VecLink.png" width="802" height="460" /><br/>
<em>VecLink example</em></p><br/>
<hr />
<h1>Example: 3d Imager</h1>

<p>For the 3d Imager no "Code Generation" was done, since any generated code would have been an extensive example on its own.</p>

<p>Instead I provide an example in form of a "code snippet" within codi. (see:<br />
<tt> codelib/Snippets/Malban/3dImager/3dImager.asm<br />
and <br />
codelib/Snippets/Malban/3dImager/3dImager.i</tt>)</p>

<p>Much of the example is reused code found in the Narrow Escape binary and the great disassembly of Fred Taft.</p>

<p>I enhanced his disassembly in two ways:
<ol><li>
<p>added further comments</p>
</li><li>
<p>extracted a couple of subroutines, which can be used "out of the box" without sorting out to much stuff</p>
</li></ol>
</p>

<p>Anyone interested in programming imager stuff should find it (I hope) to be quite easy to get going.</p>

<p>In the example I do not do any fancy 3d calculation, I only print 6 messages for the combination color/eye. Movement and placing of vectors to acchive 3d effects I leave out as an excercise for the avid reader.</p>
<br/><p align="center">
<img src="pics/ImagerExample.png" width="379" height="484" /><br/>
<em>Imager example</em></p><br/>
<h2>In general</h2>

<p>Narrow Escape: how the imager is programmed and how PWM is realized to control the motor</p>

<ol><li>
<p>Startup The official imager games have a startup phase.  During this phase the imager is "powered" up with high frequency short pwm duty pulses until the speed of the wheel matches the above mentioned time frame. The pulse duty is about 67% [542 cycles of low pulse, with 805 cylces wavelength]. </p>
</li></ol>

<p>During that powerup button 4 is polled to see if the sync hole of the wheel is triggered (button 4) - no usage of interrupts in the startup phase.  The measurement taken is thus that one 360Â° spin of the wheel (one sync cycle) must be done completely within the wanted time frame [time frame see below] - if that is achieved three times, the program assumes that the wheel is up to speed.</p>

<p>The powerup loop only contains the above mentioned routines, if the power up does not reach its goal, from a user point of view the program  just "hangs", since no other output of any kind gives any feedback.</p>

<ol><li>
<p>Ingame Once the game runs, the PWM is realized differently. Vectrex "assumes" that the wheel is spinning about "right" and sends exactly one pulse (of a calculated length, which is adjusted all the time) per sync cycle.</p>
</li></ol>

<p>Each official game runs the game loop in a time reference frame.  The frequency of the wheel is set in accordance to that timing frame (different games have different timing parameters).</p>

<p>The developer chose a frequency they would like to realize the game with (in Narrow Escape that timing value is $E000, which results in a frequency of 1/(1/1500000 * 0xe000) = 26,1579241... Hz wheel spin).<br />
(<br />
<tt>Narrow Escape: $e000 &rarr; 26.157Hz<br />
Minestorm 3d: $fc00 &rarr; 23.251Hz<br />
3d Crazy Coaster: $f000 &rarr; 24.414Hz<br />
</tt> )<br />
</p>

<p>Timer T2 is set to that value. T2 is started after the sync triggered the interrupt and thus "counted down" throughout the game loop, the game loop finishes with a CWAI instruction, which waits for another interrupt to occur.</p>

<p>During the game T2 is compared to reference values:<br />
<tt> $f000 right eye blue<br />
$BD00 right eye green<br />
$9600 right eye red<br />
$6800 left eye blue<br />
$4000 left eye green<br />
$2000 left eye red<br />
</tt></p>

<p>When the timer has reached the value - the corresponding vectors are drawn.</p>

<p>The pulse modulation is handled in a two fold manner:</p>
<h3>Interrupt</h3>

<p>With each occurrence of an interrupt a compare value is stored to a "global" variable (which I call "PWM_T2_Compare_current"). While running the main loop in the beginning the pulse is switched on (put to low), T2 (hi) is compared against the reference every now and than and if T2 is lower than the reference, the pulse is switched off.</p>

<p>The interrupt is triggered each time the index hole of the wheel passes the photo transistor and the in opposition placed LED.</p>

<p>The interrupt handles the calculation of the PWM. In general:</p>

<p>Within the interrupt two compare values are generated which I call
<ul><li>
<p>PWM_T2_Compare_faster</p>
</li><li>
<p>PWM_T2_Compare_slower</p>
</li></ul>
</p>

<p>As you might have guessed those two values are stored to the above mentioned "global" variable (PWM_T2_Compare_current).<br />
The calculated value "PWM_T2_Compare_slower" is used when no timeout occured and "PWM_T2_Compare_faster" when a timeout occured. "Switching" between those two values all the time, the speed of the motor is held more or less constant (in emulation the difference is about 0.01 Hz, I have not been able to measure the real thing).</p>

<p>The two mentioned values are checked from time to time if they also need adjustment. Therefor  eight interrupt "sampling" are bundled together and are further investigated.</p>

<p>The timeout "failures" from above are counted and remembered. After 8 interrupt calls the ratio of "timeouts" and "not timeouts" are stored and further examined. </p>

<p>The current sampling (of 8 interrupt measurements) is stored in a variable which might be called:
<ul><li>
<p><tt>countIRQFailureAfterRefreshFor8Samples</tt><br />
(yes I know - it is a long name, but I like self explaining variable names)</p>
</li></ul>
</p>

<p>for "long term" measurement, these samples are additionally stored for the last 3 samplings, in variables which I call:<br />
<tt>
<ul><li>
<p>countIRQFailureAfterRefreshFor8Samples_1<br />
</p>
</li><li>
<p>countIRQFailureAfterRefreshFor8Samples_2<br />
</p>
</li><li>
<p>countIRQFailureAfterRefreshFor8Samples_3<br />
<tt></tt></p>
</li></ul>
</tt></p>

<p>(So all together we have access to the last 4 * 8 = 32 timeout/non timeout IRQ values).</p>

<p>The calculation of the new values for PWM_T2_Compare_faster/PWM_T2_Compare_slower is three fold:</p>

<ol><li>
<p>adjustment of "PWM_T2_Compare_faster"
<ul><li>
<p>the sum of the current and last sampling is build, which results in a value between 0 - 16    (maximum of 16 timeouts, wheel is WAY to slow), the average should be "8", half of the samplings were done in time, the other half had a timeout.</p>
</li><li>
<p>the sum is compared to 13<br />
  &nbsp;&nbsp;&nbsp;- if it is exactly equal, the "PWM_T2_Compare_faster" stays the same<br />
  &nbsp;&nbsp;&nbsp;- if there are more failures than 13, subtract the difference from "PWM_T2&nbsp;Compare_faster"      (when PWM_T2_Compare_faster is decreased, the compare value to T2 is decreased and thus the duty pulse of the PWM is longer) (not below 0)<br />
  &nbsp;&nbsp;&nbsp;- if there are less failures than 13, add the difference to "PWM_T2_Compare_faster" <br />
    (when PWM_T2_Compare_faster is increased, the compare value to T2 is increased and thus the duty pulse of the PWM is shorter) (not above 0xff)</p>
</li></ul>
</p>
</li><li>
<p>adjustment of "PWM_T2_Compare_slower"<br />

<ul><li>
<p>the sum of all available samplings is build, which results in a value between 0 - 32    (maximum of 32 timeouts, wheel is WAY to slow), the average should be "16", half of the samplings were done in time, the other half had a timeout.<br />
</p>
</li><li>
<p>the sum is compared to 24<br />
  &nbsp;&nbsp;&nbsp;- if it is exactly equal, the "PWM_T2_Compare_slower" stays the same<br />
  &nbsp;&nbsp;&nbsp;- if there are more failures than 24, subtract half the difference from "PWM_T2_Compare_slower" (not below 0)<br />
  &nbsp;&nbsp;&nbsp;- if there are less failures than 24, add half the difference to "PWM_T2_Compare_slower" (not above 0xff)<br />
 (The "PWM_T2_Compare_slower" is "wheighted" more towards timeouts than the "PWM&nbsp;T2_Compare_faster" value by the usage of 32 samples (and 24 as timeout threshold))<br />
</p>
</li></ul>
</p>
</li><li>
<p>it is ensured, that both values are not to close to each other<br />
 - if the difference between "PWM_T2_Compare_faster" and "PWM_T2_Compare_slower" is smaller than $1a than the "newer" value of "PWM_T2_Compare_faster" is taken as a reference and   "PWM_T2_Compare_slower" = "PWM_T2_Compare_faster" - $1a   is used.  </p>
</li></ol>
<h3>In game</h3>

<p>The "in game" handling of PWM is quite simple (once the IRQ has handled all the setup). At the beginning of the game loop (after joystick buttons have been read, this must be done beforehand, otherwise the button requests would interfere with the imager-communication), the duty pulse is enabled (set to low).</p>

<p>Than each time after some "time consuming" work is done, the variable "PWM_T2_Compare_current" is compared to T2 timer (hi byte). If T2 is lower than the reference value, the duty pulse is finished (set to high) and the "PWM_T2_Compare_current" set to 0 as indication that the pwm control is done for this mainloop.</p>
<hr />
<h1>Library</h1>
<br/><p align="center">
<img src="pics/library.png" width="552" height="449" /><br/>
<em>library menu</em></p><br/>

<p>I would like to integrate a "library" of vectrex essential documentations.</p>

<p>Provided I get permission, this (at least for me) may be helpfull as I don't have to look for all those manuals in the shelfs.</p>

<p>The "Library" is generated from all files that can be found in the documentation folder. Following "rules" are used to generate:
<ul><li>
<p>the file extension must be one of: "pdf", "txt", "rtf", "doc", "html", all other files are ignored</p>
</li><li>
<p>files containing "_critics.txt" or "_instructions.txt" are ignored</p>
</li><li>
<p>directories containing "firstvectrex" are ignored</p>
</li></ul>
</p>

<p>All other files and directories (provided they are not empty with above mentioned rules) are displayed.</p>

<p>For each selected entry the system wide default "viewer" is started when activated.</p>

<p>You can add your <i>own</i> entries by simply copying your documents in the directory (and restarting vide).</p>
<hr />
<h1>Cartridges</h1>
<br/><p align="center">
<img src="pics/CartProps.png" width="580" height="773" /><br/>
<em>Cartridge configuration</em></p><br/>

<p>Cartridges are the "main" input to vecxi.</p>

<p>Cartridges can be configured with all kinds of properties - some emulation relevant, some only for documentation or history reasons.</p>

<p>Most options and fields are very straight forward. <br />
<b>page 1 - general </b><br />

<ul><li>
<p>names and checkboxes can be filled as usual</p>
</li><li>
<p>a "homepage" for homebrew authors can be provided, the button starts the current system browser to that page.</p>
</li><li>
<p>overlay config is simple a png (as in MESS)</p>
</li><li>
<p>the binary file configuration may be somewhat involved and is splitted into two options:
<ul><li>
<p>first: <br />
chosing a file locations with a file choser, for this use the buttons "+" and "-" to add (or delete from config) a "rom images" to your configuration (basically one image per bank, most of the time only one image!) <br />
Double click on the table row, lets you chose a "rom" - done </p>
</li><li>
<p>second, configuration of a link to some rom in the internet ... see below...</p>
</li></ul>
</p>
</li></ul>
</p>

<p><b>page 2 - instructions </b><br />
can either be:
<ul><li>
<p>a textfile (chose from a file choser)</p>
</li><li>
<p>a pdf file (chose from a file choser)</p>
</li><li>
<p>or a text entered (which than will be saved as a text file and appear as a file in the above field)</p>
</li><li>
<p>or a pdflink (pdf links are configured exactly like linked roms - therefor, see below)</p>
</li></ul>
</p>

<p><b> page 3-5 - images </b><br />
The images can be chosen with a file choser dialog OR, can be pasted using the button. The pasted image will be saved to a directory, and named like the cartridge name + a random number.</p>

<p><b> page 6 - critics </b><br />
Either a text file - or a "generated" text file (see instructions)</p>

<p><b> page 7 - others </b><br />
2 "Other" possible text entries, + a in game image field (use as images above) </p>

<p>If these are not enough ... I have still some spare room - I can provide additional fields :-).</p>

<p><b>Links</b><br />
There are people which offer their files freely - as long as you do not distribute them in any way. These can be text, pdf or binaries (or whatever).  Since these files are still basically free and of interest to vectrex "users" - I provided a mechanism to include them in the configuration without violating the rights.</p>

<p>You can download these files using VIDE. If you just use the "Starter" window this functions quite seemless. But at some stage these files and their internet locations must be configured... </p>

<p>This is the time - this is the place!</p>
<br/><p align="center">
<img src="pics/Downloader.png" width="699" height="400" /><br/>
<em>Downloader configuration</em></p><br/>

<p>As described above, at the moment there are two kinds of files (and places) where the mechanism is used, rom images and instructions. The handling is identical, therefor I will just go thru one example - a rom image.</p>

<p>Look at the window above. You see:
<ul><li>
<p>a field with a name, this is a IDENTIFIER (must not be doubled!) of the downloader configuration you are doing, it stands to reason to name it appropriatly!</p>
</li><li>
<p>a URL to a location. Only a single file can be "downloaded" (and downloadble configured) at one time</p>
</li><li>
<p>although, the file can be a zip file, which can be extracted</p>
</li><li>
<p>if the file is a zip and should be extracted, you can use the</p>
</li><li>
<p>"+" and "-" button to configure the number of files to extract</p>
</li><li>
<p>enter for each of these files the "path" in the ZIP</p>
</li><li>
<p>and a location where to save it to</p>
</li><li>
<p>if it is no zip, than you must enter a destination file location at the bottom </p>
</li><li>
<p>done</p>
</li></ul>
</p>

<p>Conventions:<br />
All downloaded zip files are downloaded to the path:<br />
(relative to vide main dir)<br />

<ul><li>
<p>download/zips </p>
</li><li>
<p>and stored there</p>
</li></ul>
</p>

<p>Rom images downloaded I give the location:<br />

<ul><li>
<p>download/cartridges  </p>
</li></ul>
</p>

<p>Instructions downloaded I give the location:<br />

<ul><li>
<p>download/documents/games  </p>
</li></ul>
</p>

<p>Zip files are extracted in the tmp directory which is cleaned afterwards.</p>
<hr />
<h1>Emulation: eEprom DS2430A</h1>

<p>Based on the description and vectrex source code from Alex Herbert. Emulation is only done in so far, that SP can be read and written, this is no FULL emulation of a DS2430!</p>

<p>Known cartridges which use this hardware:
<ul><li>
<p>Thrust</p>
</li><li>
<p>Protector/ YASI</p>
</li></ul>
</p>

<p>Statefiles for the eEprom are always saved in the same directory and named as the original cartridge (bin) file, with the additional extension of: ".ds2430.ser". <br />
(the save-format is java serialization)</p>
<h3>Technical</h3>

<p>In general the emulation are two state machines, 
<ul><li>
<p>one lowlevel "machine" which regulates bit manipulations and waits for timings slots and such.</p>
</li><li>
<p>and one highlevel machine which emulates the commands</p>
</li></ul>
</p>

<p>The highlevel uses the lowlevel machine and is "called" back from it when it is finished.</p>

<p>Input/output is basically done via the lineIn and lineOut functions. Both functions in itself do not trigger any further actions.</p>

<p>All steps of emulation are "triggered" from the "step" function. The step function should be called EVERY emulated cycle.</p>

<p>The step function is basically the lowLevel statemachine, which on occassion triggers the highlevel.</p>

<p>You can view current emulation status by opening a "cartridge" window (in dissi type "carti").</p>
<br/><p align="center">
<img src="pics/ds2430a.png" width="658" height="508" /><br/>
<em>emulation view</em></p><br/>

<p>The datasheet of the chip can be found in the subdirectory: <br />
</p>

<p>documents/hardware/DS2430A.pdf</p>
<hr />
<h1>Emulation: eEprom Microchip 11AA010</h1>

<p>Based on the manual that can be got at the Microchip site and my own disassembly of VectorPilot - the only known cartridge, which makes use of the chip.</p>

<p>Emulation is only done in so far, that VectorPilot playes all right, not emulated at the moment are the command: CRRD, ERAL and SETAL.</p>

<p>Known cartridges which use this hardware:
<ul><li>
<p>VectorPilot</p>
</li></ul>
</p>

<p>Statefiles for the eEprom are always saved in the same directory and named as the original cartridge (bin) file, with the additional extension of: ".microchip.ser". <br />
(the save-format is java serialization)</p>
<h3>Technical</h3>

<p>The microchip 11AA010 uses a manchester serial protocoll (in short: a self synchronizing serial protocoll, where the bit encoding is done by a change from low/high or high/low instead of the high/low states itself).</p>

<p>In general the emulation are three state machines, 
<ul><li>
<p>one lowlevel "machine"<br />
the low level in general handles the initial syncing needed for later "synchronized" communication</p>
</li><li>
<p>one midlevel "machine"<br />
which emulate atomic commands-steps (like MAK, SAK, reading a bit...) </p>
</li><li>
<p>one highlevel "machine"<br />
which emulates complete commands, which consist of several atomic commands</p>
</li></ul>
</p>

<p>Input/output is basically done via the lineIn and lineOut functions. Both functions in itself do not trigger any further actions.</p>

<p>You can view current emulation status by opening a "cartridge" window (in dissi type "carti").</p>
<br/><p align="center">
<img src="pics/microchip.png" width="661" height="508" /><br/>
<em>emulation view</em></p><br/>

<p>The datasheet of the chip can be found in the subdirectory: <br />
</p>

<p>documents/hardware/22067J.pdf</p>
<hr />
<h1>Emulation: Bankswitching "Dondzila"</h1>
<h2>Bankswitch Scheme 1 (Dondzila)</h2>

<ul><li>
<p>Only 2 banks available</p>
</li><li>
<p>switch is implemented by high/low of VIA ORB PB6</p>
</li><li>
<p>switching is usually done by setting the corresponding DDR register to input (PB6 goes high automatically) or output (PB6 goes low automatically)</p>
</li><li>
<p>vectrex default state is PB6 = INPUT</p>
</li><li>
<p>PB6 high enables BANK 1</p>
</li><li>
<p>PB6 low enables BANK 0</p>
</li><li>
<p>therefor the default vectrex bank upon startup is BANK 1!</p>
</li></ul>

<p>Here John Dondzilas original rec.games.vectrex post (29.10.1999):</p>

<div class="code">
<p><b>EXTRA ! EXTRA ! READ ALL ABOUT IT - PCJOHN AND ANOTHER VECTREX FIRST !!!</b> <br />
 <br />
Thanks to Peter Pachla's suggestion, I spent the last 2 nights working on<br />
the software selectable mini bankswitch cart and I'm pleased to announce:<br />
<br />
SUCCESS !!!<br />
<br />
Hardware wise is really easy, just wire the PB6 line (pin 35) to the<br />
high address line (A15) on the 64K EPROM.<br />
<br />
The software end was a little trickier, the 6522 info I have and the actual<br />
execution of the thing don't work quite the same ...<br />
<br />
Basically, if you set the PB6 line to INPUT, it seems to automatically go<br />
high. If you set it to OUTPUT, it goes low. You can send a high bit in the<br />
output mode, but it will only pulse once, then reset to low. This could be<br />
useful for larger carts, but I need the 2 banks to stay steady right now without<br />
re-writing all 8 programs. I'm not sure if my manual is wrong or the Vec does<br />
this, either way - it works. Now I just need to test it on some more machines<br />
before I implement it into the final package.<br />
<br />
Looks like emulator users will be getting Volume I and Volume II<br />
seperate binaries.<br />
<br />
JD<br />
<br />
 </p>
</div>

<p>Emulator:
<ul><li>
<p>if a bin file is 32k &lt; Size &lt;= 64K, Vide assumes this bankswitch scheme</p>
</li></ul>
</p>
<hr />
<h1>Emulation: VecFlash</h1>
<h2>Bankswitch Scheme 2 (VecFlash)</h2>

<ul><li>
<p>64 banks available</p>
</li><li>
<p>switch is implemented again by use of high/low of VIA ORB PB6</p>
</li><li>
<p>switching is usually done by setting the corresponding DDR register to input (PB6 goes high automatically) or output (PB6 goes low automatically)</p>
</li><li>
<p>switch routine in general works this way:
<ul><li>
<p>first time when PB6 (external line from cartridge point of view) is set to high from low (after a LONG time... (&gt;2000 cycles?) bank is resetted to 0</p>
</li><li>
<p>if another switch from high to low occurs within a short (but not too short) time (about 1500 cycles) bank is increased by one</p>
</li><li>
<p>so to reach "higher" banks we have to loop thru all lower banks...</p>
</li></ul>
</p>
</li><li>
<p>the routine which does the bankswitching must not reside in flash memory, thus the actual switching routine must run in RAM-memory!</p>
</li></ul>

<p>As long as not another PB6 using external device is emulated, VecFlash is detected automatically (this may change when EPROM RAM is implemented)</p>
<hr />
<h1>Emulation: Lightpen</h1>

<p>Lightpen is emulated. <br />
Use the mouse as a lightpen, press the left button when you go "near" a shiny vectrex object to trigger the lightpen.</p>
<hr />
<h1>Emulation: Sprites Mod - extreme Vectrex "BadApple"</h1>

<p>see: <a target="_blank" href="http://spritesmods.com">http://spritesmods.com</a></p>

<p>On the above page "Sprites" describes his building of an "extreme vectrex multicard" and his efforts to bring a vectorized "movie" onto the vectrex.</p>

<p>Vide as a small "bonus" is able to play the described extreme vectrex files (file must be configured in cartridge define).</p>

<p>On infomation how to build such a file look at the above page or at Malbans blog under: <a target="_blank" href="http://malban.de/extreme-vectrex-reproduction-of-badapple">http://malban.de/extreme-vectrex-reproduction-of-badapple</a></p>

<p>Provided with Vide is the bad apple example I described in the above blog entry.<br />
(a vectrex cart with a size of about 12mb)</p>
<hr />
<h1>Emulation: VecVoice</h1>

<p>VecVoice is a hardware extension for the vectrex which can be plugged into port two joystick port.</p>

<p>It was designed and build by Richard Hutchinson and gives programmers access to a SP0256-AL2 speech chip.</p>

<p>VecVoice is not available anymore, since the used speech chip is not fabricated anymore.</p>

<p>The speech is emulated by using samples.</p>

<p>The Datasheet of the chip can be found in the subdirectory: <br />
documents/hardware/Sp0256al2&nbsp;datasheet.pdf</p>
<hr />
<h1>Emulation: VecVox</h1>

<p>VecVox is a hardware extension for the vectrex which can be plugged into port two joystick port.</p>

<p>It was designed and build by Richard Hutchinson and gives programmers access to a SpeakJet speech chip. The hardware can still be ordered and is now known as AtariVox+, but using dipswitches
<ul><li>
<p>it can be used as a VecVox</p>
</li><li>
<p>or configured to emulate VecVoice</p>
</li></ul>
</p>

<p>It can be ordered at <a target="_blank" href="https://atariage.com/store/index.php">https://atariage.com/store/index.php</a><br />
<br />
<b>Note:</b><br />
You additionaly need a joystick cable extension, since the cartridge because of its design does not fit directly into a vectrex!</p>

<p>The speech is emulated by using samples.</p>

<p>The Datasheet of the chip can be found in the subdirectory: <br />
documents/hardware/speakjet-usermanual.pdf</p>
<hr />
<h1>Emulation: extra RAM / Spectrum RA</h1>

<p>Emulation of extra RAM is supported for the three known cartridges:
<ul><li>
<p>Animaction<br />
which has an additional 2k on board ram located at $2000- $27ff</p>
</li><li>
<p>Spectrum RA<br />
which has an additional 2k on board ram located at $8000- $87ff</p>
</li><li>
<p>Logo<br />
which has an additional 8k on board ram located at $6000- $7fff</p>
</li></ul>
</p>

<p>Also supported are the 8 LED from spectrum RA (controlled by the Joyport output of 8 buttons) - and a insert coin button (PB6 of Via ORB).<br />
These can only be seen and accessed at the "cartridge" window (in dissi type "carti").</p>
<br/><p align="center">
<img src="pics/spectrumWin.png" width="707" height="417" /><br/>
<em>emulation view</em></p><br/>
<hr />
<h1>Emulation: VecLink V1 + V2</h1>

<p>These emulations can not be configured using the cartridge settings.</p>

<p>The reasoning is that as of now, the starting logic was not ment to ever start two vecx instantiations at the same time.</p>

<p>Thus - even if veclink would be "cartridge enabled", you would not be able to see any effects by only starting one emulator instance.</p>

<p>Nonetheless, veclink emulation IS supported, you just have to configure using it manually.</p>

<p>Manually meaning:
<ul><li>
<p>go to the main menu and start a vecx</p>
</li><li>
<p>select the veclink binary you would like to play</p>
</li><li>
<p>press start</p>
</li><li>
<p>select for port 0 the input device you would like to use</p>
</li><li>
<p>select for port 1 the veclink cable you would like to use, start with the "left" side (although it does not really matter which side is plugged in first)</p>
</li><li>
<p>repeat the above process for a second vecx instance, </p>
</li><li>
<p>for port 1 select the "other side" (right?) of the same veclink cable</p>
</li></ul>
</p>

<p>That should do it...</p>
<h2>BerzerkArena</h2>

<p>BerzerkArena uses veclink V2.</p>

<p>The following pieces are thoughts of Malban during the disassembly of said bin file.
<ol><li>
<p>There is an initial syncing of several bytes. In game, only one byte is synced each WaitRecal cycle: Joystick Data (4 bit for the buttons, and 4 bit for the directions up/down, left/right).</p>
</li><li>
<p>upon initializing the veclink, a synchronizing of the wait recal routine of both vectrex is done (Alex wait recal is customized, and has a specific counter and timing)</p>
</li><li>
<p>since the swapping of the one byte is synchronized by each WR and the WR are also synchronized, no additional data is needed, everything else (shots, ammunition, teleports can be calculated from the one transfered byte)</p>
</li></ol>
</p>
<h3>Low Level</h3>

<p>The used transfer protocoll:</p>

<p>The bits of port A used: 
<ul><li>
<p>bit 4 (control bit)    [button 1 of port 1] </p>
</li><li>
<p>bit 5 (data bit) [button 2 of port 1] </p>
</li><li>
<p>bit 6 (acknowledge bit) [button 3 of port 1] </p>
</li></ul>
</p>

<p><i>Control bit<br />
</i> Each byte is send in 4 "packages" of 2 bit. The first bit of such a package has the control bit set to 0 (zero), the second bit in such a package has the control bit set to 1 (one).</p>

<p><i>Data bit<br />
</i> This bit - as the name implies - carries the one bit of data used in one "transfer" round.</p>

<p><i>Acknowledge bit<br />
</i> The receiving vectrex must send an acknowledgement "message" in which the bit 6 must be set.</p>

<p>If any of the above is not true while the communication is done (actually there is a timer which waits for the appropriate resonse, one byte must be transfered in $ffff cycles (T1 Timer)), the communication is broken and a message is displayed.</p>

<p><b>Special</b><br />
(See also Joyport Devices...)<br />
The complete game BerzerkArena is played with PSG Port A set to output (on both ends of the serial cable), the serial communication still works in both directions.</p>
<h3>Higher Level</h3>

<p>One of the two vectrex must be the first, this is always the case :-).</p>

<p>Primary vectrex:<br />
The first one obviously does not receive any data before. If no data is received, than a "$4d" is sent. </p>

<p>Secondary vectrex:<br />
The secondary vectrex receives the above mentioned "$4d" and responds with sending a "$73".</p>

<p>If both above sendings and readings are aknowledged by both vectri, the primary starts the initial syncing sequence by transfering 7 bytes of data (amongst them the wait recal counters).</p>

<p>The primary vectrex sets its first indirect jumper in the main routine to: <br />
 <tt>linkPort0ExchangePrimary(). </tt> <br />
</p>

<p>The secondary vectrex sets its first indirect jumper in the main routine to: <br />
 <tt> linkPort0ExchangeSecondary(). </tt> <br />
</p>

<p>All other routines are henceforth the same on both vectri. The difference in the above two routines:
<ul><li>
<p>the order of calling read/write to serial connection</p>
</li><li>
<p>the view on what are "own" joystick data and what are "other" joystick data</p>
</li></ul>
</p>
<hr />
<h1>VecLink V1</h1>

<p>Earlier version of the cable (V1). The I/O on pin 4 is harder to drive than pins 1,2,3 so the pull up resistors were used to try and correct the voltage levels, but even then it was still iffy.    </p>

<p><tt><br />
Vectrex A                Vectrex B<br />
1 |--------------------------| 4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;   600 Ohm Resistor<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     &gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />
8 |--------------------------| 8<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;   600 Ohm Resistor<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />
4 |--------------------------| 3<br />
2 |--------------------------| 1<br />
3 |--------------------------| 2<br />
</tt></p>
<hr />
<h1>VecLink V2</h1>

<p>The new cable (V2) just avoids this by not using pin 4. It means we have 1 less pin for data which should in theory reduce the maximum bandwidth, but I was able to optimise it quite well and didn't loose much performance. </p>

<p><tt><br />
Newer style VecLink Cable <br />
Vectrex A                Vectrex B<br />
1 |--------------------------| 1<br />
2 |--------------------------| 2<br />
3 |--------------------------| 3<br />
8 |--------------------------| 8<br />
All other pins MUST NOT be connected.<br />
(or damage to your Vectrexes is quite probable).<br />
</tt></p>
<hr />
<h1>Emulation: Dual Vec</h1>

<p>I found following message on a very old rec.games.vectrex usenet entry:<br />
<br />
</p>

<div class="code">
<p><tt> I wrote those programs years ago at Western Tech to demonstrate the possibility of making a game that would play on two systems (Like you can do with gameboy now...)</tt></p>

<p><tt> This program did nothing more than display the buttons from one Vectrex on the other's display (and vice-versa).  </tt></p>

<p><tt> I have no idea how these programs made it into the archive - I only showed this software to a few people...   You may safely discard them.   It communicates between the system by using PB6 on the cartridge.  If you really want to see it work, you must connect PB6 and GND between the two systems, then run DUALVEC on 1 system and DUALVEC2 on the other.</tt></p>

<p><tt> Bill Hawkins</tt></p>
</div>

<p>I just implemented that...</p>

<p>These emulations must be configured via the cartridge settings - since the communication goes via the cartridge extension cable - but to see the emulation in action - you have to start two vecxi instances manually.</p>

<p>Manually meaning:
<ul><li>
<p>go to the main menu and start a vecx</p>
</li><li>
<p>select the "DualVec.bin" in one vecxi</p>
</li><li>
<p>and "DualVec2.bin" in the other vecxi</p>
</li><li>
<p>press start (for both)</p>
</li></ul>
</p>

<p>That should do it... (configuration is automatically gotten from the cartridge settings).</p>

<p><b>Note:<br />
</b> Due to the same reasons that VecLinkV1 ist somewhat unstable in vide [no proper, synchronization between the two in different threads running emulators], this one too is a bit "flickery". Once I have done all other stuff I want to do with vide, I will add a proper "dual emulation", where two emulators can run in cycle sync. Doing that will get rid of these last disturbances. If anyone wants to use any of the link versions befor that far away day in the future and also would like to use vide to develope â give me a call and I will prioritiseâ¦</p>
<hr />
<h1>Emulation: Imager 3d (Goggles)</h1>

<p>Emulation of the 3d imager can be enabled with the cartridge settings. Required is also that a "wheel" is chosen for the imager.</p>

<p>The wheel has important information which are needed to display the game correctly:</p>

<ul><li>
<p>the colors</p>
</li><li>
<p>the angle of the colors</p>
</li><li>
<p>the position of the index hole<br />
</p>
</li><li>
<p>(the default speed of the wheel,<br />
 this information is not required, but emulating the pulse width modulation slows down the startup of a game, using the default speed is a quicker way. The default speed is game related, not wheel-related though. It makes sense to create own wheels (even if the layout is identical) for each game, since the default speeds vary between games)</p>
</li></ul>

<p>The emulation has two different "modes", namely
<ul><li>
<p>manual</p>
</li><li>
<p>automatic</p>
</li></ul>
</p>
<h3>Manual "Imager" emulation</h3>

<p>In this mode the speed of the wheel is "fixed", the user (or the settings) can set (or change) the speed of the wheel. The vectrex program has no influence on the speed.</p>

<p>If a game is "known" this setting is the "better" looking version. All known games use during its livecycle only one rotation speed, so the value can be pre-set.</p>
<h3>Automatic "Imager" emulation</h3>

<p>In this mode the speed of the wheel is calculated by obtaining and calculating the pulses the vectrex sends to the imager hardware (see PWM).  At the beginning of an imager programm the vectrex sends heavy duty pulses to get the wheel up to speed (which takes a few seconds to emulate), and than regulates the speed continuously while the game is runnning. The wavelength of one sequence is always the time between two sync (hole) passes.</p>

<p><b>Note!</b><br />
Switching from automatic to manual emulation mode is no problem. Switching from manual emulation to automatic gives sometimes unexpected results. This is caused by the algorythms the vectrex games use to control the motor (pwm) with. The algorythm tries to achieve a "fixed" relation between timeout and non-timeouts. The manual emulation knows only one fixed frequency. That frequency either times out or does not timeout. One way or the other, the count of these events is min and max, the game algorythms still try to adept to the received values. Even to the EXTREME. Thus switching from manual to automatic, the startup values for automatic mode (of the current running game) are all wrong and the game probably goes completely out of sync.</p>
<h2>Emulation Imager in general</h2>

<p>The emulation of the imager hardware consists of different entities:
<ul><li>
<p>the wheel</p>
</li><li>
<p>phototransistor</p>
</li><li>
<p>the motor</p>
</li><li>
<p>eye areas</p>
</li></ul>
</p>
<h3>Reference points</h3>

<p>Following points of reference are assumed in emulation and in the following descriptions:
<ul><li>
<p>all "directions" are from the view of the person wearing the imager, looking through the imager</p>
</li><li>
<p>on the wheel the degree 0 is the start of the black area, degrees are increased clock wise, thus the first color starts at 180 degree</p>
</li><li>
<p>the 0 degree on the hardware side is the 6 o'clock position (right above the nose of the wearer)</p>
</li></ul>
</p>
<h3>The wheel</h3>

<p>The wheel characteristcs are:
<ul><li>
<p>black area<br />
  it is assumed every imager wheel has a 180 degree black area, for reference sake the start of the black area is regarded as 0 degree (zero) degree point for wheel definition.</p>
</li><li>
<p>color areas<br />
all known games feature three colors, but actually the number of colors is arbitrary, emulation allows to build wheels with different numbers of colors. The first color always starts at degree 180 degree and the last color always ends at degree 360 degree.</p>
</li><li>
<p>index hole<br />
Placement of the index hole on the wheel. This is the reference point the vectrex programs use for internal calculation of when to draw vectors (left/right eye in relation to color). <br />
In "real live" a phototransistor and a led are placed opposite of each other, and only when the index whole is in the right position the light of the led reaches the phototransistor. The transistor switches "button 4" to the state "pressed" and thus sends a signal to the vectrex (button 4 is also connected to CA1 of VIA - and can thus be configured to trigger an interrupt).<br />
 <br />
The index hole is not in the same position (in relation to the above defined 0 degree) for the two known official wheels. </p>
</li></ul>
</p>
<h3>Phototransistor</h3>

<p>Experiments and measures indicate a good value for the phototransistor location at 339 degree. The index hole has a size of about 3.3274 millimeters :-) - but experiments also show, that the transistor does not react on the led for the whole size of the hole, the actual reaction size is (guessing) only 1/3 of that.</p>
<h3>Motor</h3>

<p>The motor is emulated as a "frequency" of rotation. The frequency can be either set manually or can be determined by a calculation of the pulses got from the vectrex (see pwm). Emulation-internally an angle is increased every emulated cycle - in relation to the current frequency.</p>
<h3>Eye areas</h3>

<p>The holes where the wearer sees the vectrex image through. In relation to the reference the eyes are located at 90 degree and 270 degree respectively.</p>
<h2>Inspecting the emulation</h2>

<p>You can view current emulation status by opening a "device" window (in dissi type "joyi").</p>
<br/><p align="center">
<img src="pics/device_imager.png" width="742" height="744" /><br/>
<em>emulation view</em></p><br/>

<p>Using the button <img src="pics/page_edit.png" alt="page_edit.png" /> you can start editing your own wheels:</p>
<br/><p align="center">
<img src="pics/WheelEdit1.png" width="479" height="584" /><br/>
<em>wheel editor</em></p><br/>
<h2>Additional Notes</h2>
<h3>Startup / Interrupt usage</h3>

<p>Each official game runs the game loop in a time reference frame. The frequency of the wheel is set in accordance to that timing frame (different games can have different timing parameters).</p>

<p>The official imager games have a startup phase. During this phase the imager is "powered" up with heavy duty cycles (pwm) until the speed of the wheel matches the above mentioned time frame (many "pulses" per sync round). During that powerup button 4 is polled to see if the sync hole of the wheel is triggered (button 4) - no usage of interrupts in the startup phase. <br />
</p>

<p>The measurement taken is thus that one 360 degree spin of the wheel (one sync cycle) must be done completely within the wanted time frame - if that is achieved three times, the program assumes that the wheel is up to speed.</p>

<p>Once the game runs, the PWM is realized differently. Vectrex "assumes" that the wheel is spinning about "right" and sends exactly one pulse (of a calculated length, which is adjusted all the time) per sync cylces.</p>

<p>The game "loop" is realized by using the interrupt the sync triggers. Here the difference:<br />
The normal game loop:<br />
<tt>main: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JSR WaitRecal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JSR DoSound<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JSR DisplaySomething<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JSR DoGameStuff<br />
...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BRA main</tt><br />
</p>

<p>and imager game loop looks like:</p>

<p><tt>main: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JSR DoOwnRecal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JSR DoSound<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JSR DisplaySomething<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JSR DoGameStuff<br />
...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CWAI #$ef<br />
...<br />
InterruptHandler: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ... do imager stuff<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LDS #$CBEA ; or any other kind of stack correction because of interrupt<br />
...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JMP main</tt><br />
</p>

<p>There are two dangers if not handled carefully:
<ol><li>
<p>the wheel spinning to fast<br />
If for any reason, the wheel spins to fast, the interrupt can be triggered to soon, while still in some important other routine. If this happens two things can go awfully wrong.
<ul><li>
<p>the routine is not completed and the game does not run correctly</p>
</li><li>
<p>the assumptions of the interrupt routine are not met (e.g. correct setting of the DP register)</p>
</li></ul>
</p>
</li><li>
<p>the wheel is spinning to slow<br />
Here also a "tricky" thing can happen. The imager (in opposite to the default) triggers the interrupt CA1 on "active high" (state of the line going form low to high) (which is set by storing the right bits into VIA control register $c). Within the Interrupt handler the BIOS routine <tt>"Reset0Ref"</tt> is called, which resets that setting to the default value (trigger interrupt on active low, going from high to low).<br />
If the wheel spins to slowly, the index whole has not yet reached its end, and another interrupt is triggered when the sync is shut down again - since the expected interrupt settings were not yet in place (trigger on active high). This second trigger while in itself not a catastrophy can also happen at exactly the wrong time (e.g. dp not correctly set) - so that the program also is not working anymore.</p>
</li></ol>
</p>
<hr />
<h1>What is PWM.</h1>

<p>(extracted from: <a target="_blank" href="http://www.allaboutcircuits.com/textbook/semiconductors/chpt-11/pulse-width-modulation/">http://www.allaboutcircuits.com/textbook/semiconductors/chpt-11/pulse-width-modulation/</a> - written by Tony R. Kuphaldt, Design Science License)</p>
<h1>Pulse Width Modulation</h1>

<p>Pulse Width Modulation (PWM) uses digital signals to control power applications, as well as being fairly easy to convert back to analog with a minimum of hardware.</p>

<p>Analog systems, such as linear power supplies, tend to generate a lot of heat since they are basically variable resistors carrying a lot of current. Digital systems donât generally generate as much heat. Almost all the heat generated by a switching device is during the transition (which is done quickly), while the device is neither on nor off, but in between. This is because power follows the following formula:</p>

<p>P = E I, or Watts = Voltage X Current</p>

<p>If either voltage or current is near zero then power will be near zero. PWM takes full advantage of this fact.</p>

<p>PWM can have many of the characteristics of an analog control system, in that the digital signal can be free wheeling. PWM does not have to capture data, although there are exceptions to this with higher end controllers.</p>

<p>One of the parameters of any square wave is duty cycle. Most square waves are 50%, this is the norm when discussing them, but they donât have to be symmetrical. The ON time can be varied completely between signal being off to being fully on, 0% to 100%, and all ranges between.</p>

<p>Shown below are examples of a 10%, 50%, and 90% duty cycle. While the frequency is the same for each, this is not a requirement.</p>
<br/><p align="center">
<img src="pics/pwm1.png" width="427" height="108" /><br/>
<em>pwm</em></p><br/>

<p>The reason PWM is popular is simple. Many loads, such as resistors, integrate the power into a number matching the percentage. Conversion into its analog equivalent value is straightforward. LEDs are very nonlinear in their response to current, give an LED half its rated current you you still get more than half the light the LED can produce. With PWM the light level produced by the LED is very linear. Motors, which will be covered later, are also very responsive to PWM.</p>
<hr />
<h1>Configuration</h1>

<p>Basically there are two kinds of options, general "Application" options. These can be found under the menu: <br />
File &rarr; extra &rarr; application configuration<br />
There are as of now not many configurations, in general only debugging options (of Vide - not of vectrex).</p>

<p>The second set of options are regarding Vide.<br />
These can be found at:<br />
Tools &rarr; Configuation</p>

<p>All options are now bundled in one class and can as such be easily saved and loaded.</p>

<p>So you can bundle all options to "sensible" names, like:</p>

<p>    "Fastest emulation"     "Default"     "Added Timings"     "Splines"     etc</p>

<p>Upon start allways the option "Default" is loaded!</p>
<h1>Options -  now really!</h1>

<p>Vide is some kind of a Monster!<br />
I know that.<br />
<br />
Due to Vide being 100% pure java and trying to emulate vectrex as precisley as I am knowledgable to - Vide can become slow as hell.</p>

<p>I know that I still am not able to emulate the old brute 100% - but god knows I have put much effort into the emulation - and I am quite certain that at the time beeing - emulation in VIDE is the most exact vectrex emulation around.</p>

<p>Always depending on the options you have chosen. Here some descriptions of what is emulated, and how you may alter emulation with configuration: </p>
<h1>Emulator</h1>
<br/><p align="center">
<img src="pics/config1.png" width="557" height="1089" /><br/>
<em>emulator config</em></p><br/>

<p><b> Cycle exact emulation</b><br />
Most of the time you do not need this setting. It costs a little bit of emulation time.<br />
What it does: Hm...<br />
Basically it handles emulation cycle exact, yes I know you gathered that from the name.  With this option switched on analog hardware is emulated EVERY cycle. Not just at the end of each 6809 instruction. An instruction of the CPU can take anything from 2 to dunno 20 cycles? If RAMP, Shift or timers change in the middle of a CPU instruction and this is not handled at exactly the time, the output of the emulator can differ from the real machine - but this is most of the case only true if you try squeezing optimization out of the last pore of vectrex.</p>

<p><b> Enable bankswitching</b><br />
Well just what it says. Emulator may perform a tiny little bit better if switched off, since some testing will be omitted. Barely - if at all noticable.</p>

<p><b> Ringbuffer active</b><br />
You only need that for debugging purposes, this basically saves the state of vecx every CPU instruction and thus enables you to take emulation steps back. Surprisingly this also is not one of the speed eaters. But again - if Vide is to slow and you don't intend to debug - switch this off! (at the moment the size of the ringbuffer is not yet configurable, size is hardcoded to 2000) </p>

<p><b> Use splines for curved vectors </b><br />
Some games/programs do curved vectors on vectrex. "Usual" emulation does not handle that all that well, it allways rather looks edgy. With this option you can switch enhanced emulation with "splines" (Catmull Rom) on.  Drawing splines is not optimized and slows down emulation. Although only very few roms use curved vectors, so you may as well leave it enabled.</p>

<p><b>Use Quads</b><br />
Belongs to spline configuration, this is only active if splines are switched on. Drawing "Quads" is more performant than splines, but some curves look bad... I do not recommend this setting and it is available more for historic reasons than for any real value!</p>

<p><b> Slider nearby </b><br />
The slider configures how many control points are used and how they are "translated" to the drawing routine. </p>

<p><b> Suppress double draw on line sections</b><br />
Is cheating!<br />
With this option you suppress the (normal for vectrex) double drawing at the end / begining of two vectors. Sometimes this speeds things up, sometimes it slows emulation down. Try it...</p>

<p><b>Antialiazing</b><br />
Smoother lines. Suprisingly at my place emulation is a lot faster with antializing switched on. Don't know why - try it!</p>

<p><b> Try autosync</b><br />
Nearly all vectrex programs have a different screen "refresh" rate. If you just emulate with a fixed frame sooner or later the screen flickers like mad. With this option switched on, the emulator trys to sync display with Timer T2 of vectrex, which is usually used to also sync vectrex display (WaitRecal). If Vide thinks this is not working it steps back and syncs to aproximately 50Hz - but this may result in vectrex screen flickering.</p>

<p><b>Volume setting</b><br />
With this you set the sound volume.</p>

<p><b>Line width</b><br />
The thickness of one vector line. The appearence is also dependend on "glow".  The thicker - the slower emulation!</p>

<p><b>Drift</b><br />
Nearly all vectri drift in one way or another. Drift is the slight "movement" of vectors over time without the user or programm actually changing anything. This has to do with electronic laws, old analog hardware, probably temperatur, humidty and so on. The default values represent my "no buz" vectrex.</p>

<p><b>Brightness/glow</b><br />
An option that tries to visually emulate the "glow" of vectors. Results are also dependend on "Line width". Glow really slows emulation, especially higher glow values. But it is so pretty!<br />
<br />
Some emulated "effects" are only visible if glow is switched on. 
<ul><li>
<p>e.g. "dots" are usually drawn using a dot dwell time (time the vector beam resides on one single spot). The higher the dwell time, the brigher the dot. </p>
</li><li>
<p>vectors are drawn with different "strength" values, the strength actually is the speed with which the vector is moving. The higher the speed, the less time the electrons are positioned at "one" location. Thus the higher the speed, the lower the brightness of one vector</p>
</li></ul>
</p>

<p>Both effects (the second only very barely) can only be seen if glow is enable!</p>

<p><b>Efficiency</b><br />
I don't know if this is a "real" thing. In some desperate move to find a faulty behaviour, I implemented this. Basically what it does is "reduce" efficiency of the integrator Sample/Hold value the higher the absolut value of the current integrator already is. This e.g. (extreme example):<br />

<ul><li>
<p>adding SH 100 to an integrator with a value of 0 will result in the integrator having a value of 100</p>
</li><li>
<p>adding SH 100 to an integrator with a value of 10000 will result in the integrator having a value of 10090</p>
</li></ul>
</p>

<p><b>noise factor</b><br />
Experimental! With this I try to emulate the "wobble" effect, if the integrators are not "resetted" often enough.<br />
 <br />
  <b>overflow factor</b><br />
Experimental!  <br />
And I think wrong, this will be gone in the near future</p>

<p><b> Ray Gun </b><br />
Experimental start:<br />
To not "collect" vector data and do a draw when a vector is finished, but to draw on each cycle the current beam position! This was implemented, but probably won't be finalized. The raygun is shot at the display panel, each emulated cycle, with the information:
<ul><li>
<p>old position</p>
</li><li>
<p>new position</p>
</li><li>
<p>speed (or dwell time, however you would like to look at it)</p>
</li><li>
<p>color</p>
</li><li>
<p>isCurved</p>
</li></ul>
</p>

<p>The display routine is responsible to draw the positioning information. The idea was, that color, speed and position can be used to enhance brightness of the display. If a point has its color "full" (255), than it should spill further coloring to neighbouring pixels.</p>

<p>The thing is, doing a "simple" draw right now without any further evaluation and "spilling" is already really slow (which is not really suprising either).</p>

<p><b>Boot Rom</b><br />
Select the Rom you want per default use as your vectrex BIOS. The nearby buttons allow to configure the BIOS settings for each available ROM.</p>
<h1>Delays</h1>
<br/><p align="center">
<img src="pics/config2.png" width="560" height="1094" /><br/>
<em>delay config</em></p><br/>

<p>Delays seem to be quite important in exact vectrex emulation. As it seems the analog hardware does not react immediately to changes, but rather a short time span later. All delays that can be handled here are delays to analog hardware items inside vectrex.</p>

<p>To the best of my experiments - all default values represent my "no buz" new vectrex (serial number: 3117403).</p>

<p><b>MUX-SEL</b><br />
A delay in CPU cycles the data written to the VIA bit 1-2 (Mux sel) is taking to reach (trigger) the MUX.  <br />
This setting was introduced while trying to get the same output in the emulator as the real vectrex, while displaying that raster graphics of the "lineart" demo.</p>

<p><b>ZERO</b><br />
A delay in CPU cycles the data "written" to the VIA CA2 is taking to reach (trigger) the ZERO (grounding the integrators).  <br />
This setting was introduced after some other settings and watching the "sd.bin" demo of Christopher Tumber. The shots Christopher is firing set the Zero flag very VERY early (actually while the shot should still be in the "air"). On a real vectrex this works ok, my guess is - because a delay.</p>

<p><b>XSH</b><br />
A delay in CPU cycles the data "written" to the VIA ORA is taking to reach the XSH "analog storage". </p>

<p><b>YSH</b><br />
A delay in CPU cycles the data "written" to the VIA ORA is taking to reach the YSH "analog storage".  <br />
 I noticed, that usually the "sum" of YSH and MUX-SEL should be less than Ramp Off Delay.</p>

<p><b> SSH</b><br />
Implemented, but has no effect whatsoever.</p>

<p><b> RSH</b><br />
Implemented, but has no effect whatsoever.</p>

<p><b>Ramp On/Off Delay</b><br />
These delays seem to be the MOST important delays in exact emulation. I don't know why, and I find it strange that On/Off is different - but experiments showed, that these values DO differ. The ramp delays are 1/10 cycle exact - and believe me, you even see the difference on screen for 1/10 cylce, which is 1/15,000,000 seconds worth of emulation!</p>

<p><b> Blank delay</b><br />
Implemented, but as of yet no use found! But nice effects if you use the slider :-).</p>

<p><b> Blank On Delay </b><br />
(1/10 cycle) Implemented, but as of yet no use found!</p>

<p><b> Integrator Warmup </b><br />
Implemented, but as of yet no use found (1/100 cycle exact)!</p>

<p><b> Integrator Cool down </b><br />
Implemented, but as of yet no use found (1/100 cycle exact)!</p>

<p><b> Vectrex generation </b><br />
To my knowledge there are at least 3 different versions of vectrex hardware. It seems to me, that at least in my two vectri there are different DACs used. This can be seen by sample programs which try cycle exact DAC settings (usually with DAC changes while RAMP is enabled).  Therefor &rarr; the "generation" setting hides in reality a <b>DAC-Delay</b> which seems to be different for these generations.<br />
I have not tested this extensivly, but implemented is a fixed DAC delay of 2 cycles for 3. generation, and 4 cycles for 1-2 generation (and none for "Off"). The volume of generated sound for digitized music seems to be reduced on new vectri.</p>

<p>Also... the generation influences at what value via "stall" when shiftreg is updated befor the magic 18 cycles (off never stalls).</p>
<h2>Thoughts</h2>

<p>I am still not 100% certain, that all these delays are correct emulations or are just a lucky hunch which looks like they works - but rather I should be fiddling with something entirely different. I tried many different things - but nothing else comes close to these results - so take them - or find something better :-)! (end tell me!)</p>
<h1>Disassembler</h1>
<br/><p align="center">
<img src="pics/config3.png" width="561" height="577" /><br/>
<em>disassembler config</em></p><br/>

<p><b>Assume vectrex files</b><br />
This option might surprise you in Vide, but fact is - the stand alone version of dissi could probably disasssemble other programs as well... Therefor this option sort of makes sense (nah - it doesn't...).<br />
Anyway if enabled dissi scans it's files for a typical vectrex heading, like the GCE entry and the following string list.</p>

<p><b>build generic labels</b><br />
If disassembling unkown sources, dissi generates lables (in the form of "_XXXX" - where "XXXX" is the actual address) instead of using the address directly.</p>

<p><b>codescan in Vecxi</b><br />
If enabled, vecxi while executing marks addresses as "read", "write", "executed" and gives these information to dissi for use. That way dissi has a better chance to discern data from code. <br />
If everthing else is finished in vide, this might be expanded to a more in depth automatic code analyses.</p>

<p><b>column setup</b><br />
Straight forward - configuration which columns should be displayed in the dissi main table. Changes are applied at once!</p>
<h1>Debug</h1>
<br/><p align="center">
<img src="pics/config4.png" width="560" height="295" /><br/>
<em>debug config</em></p><br/>

<p><b>draw Vectors as arrows</b><br />
Just one of those not really useful, but cool options. Lets you see in what direction vectors are drawn.</p>

<p><b>draw movement vectors</b><br />
Not implemented yet - to get a glimps of what this could look like, play with the "blank delay" option. </p>

<p><b>paint integrator position</b><br />
This started as an unneccessary "cool" option - but actually I use it pretty often. With this enabled, vecxi draws a little red circle at the current vector beam postion, this is a great option to help "visualize" debugging (obviously there is a speed impact). </p>

<p><b>MultiStep delay</b><br />
The delay in milliseconds dissi waits between multi step - steps.</p>
<h1>Assembler</h1>
<br/><p align="center">
<img src="pics/config5.png" width="559" height="231" /><br/>
<em>assembler config</em></p><br/>

<p><b>automatically expand short branches to long if needed</b><br />
Well - what the option says.<br />
<b>Note</b>:<br />
As of yet assi is a two pass assembler, and I have not changed its architecture all that much (yet). Because of that it is not possible to expand branches (to that point) to unkown locations. Expanding short to long branches therefor only works with branches "backward" not forward. If an expansion forward is necessary assi quits with an error and tells you where the branch should be expanded!</p>

<p><b>opt</b><br />
Tells assi to use optimization (what little is implemented). <br />
<b>Note</b>:<br />
The "opt" pseudo opcode not only overwrites this setting it also SETS this very setting in the config. If you use "opt" in your sources, than the last use of "opt" (or noopt) is the new "config-setting" as well!</p>

<p><b>LST output</b><br />
List output takes (in relation to actually doing the assembly) a little bit of time. Therefor you can switch the generation off.</p>

<p><b>treat undefined in if clause as 0 value</b><br />
This is actually a compatabilty option to AS09.</p>
<h1>Editor</h1>
<br/><p align="center">
<img src="pics/config6.png" width="561" height="201" /><br/>
<em>editor config</em></p><br/>

<p><b>invoke Emulator after successfull assembly</b><br />
Well this is realy self explaining - isn't it?</p>

<p><b>scan for defined ...</b><br />
If checked, vedi scans files for the entities, this allows displaying / coloring of defined and undefined variables/macros and allows the "right/doubleclick" on such an entity to jump to its definition.</p>

<p><b>scan for vectorlists ...</b><br />
If checked, vecxi scans while running, whether BIOS vectrex routines draw a vectorlist, if so - vecxi saves the list in XML format, under the cartridge name.</p>
<h1>Keyboard</h1>

<p>All kind of keyboard inputs can be defined/altered here (editor, and vectrex emulator input controls).<br />
</p>

<p>Follow the instructions given on the TAB. <br />
<br />
Note:<br />
For Joytick simulations your have to configure both "Pressed" and "Released" events!</p>
<h1>Theme/Color</h1>

<p>Follow the instructions given on the TAB.</p>
<h1>Input</h1>
<br/><p align="center">
<img src="pics/jinput.png" width="582" height="948" /><br/>
<em>input settings</em></p><br/>

<p>Here you can configure additional input settings for different inout "hardware" for use with the emulator. The code is based on the "JInput" library.</p>

<p>The tab is split into two halfs, the upper half representing the vectrex "side" the lower half representing the input device parameters.</p>

<p>There are at the moment two types of vectrex input types:
<ol><li>
<p>Joystick</p>
</li><li>
<p>spinner (like atari driving paddle)</p>
</li></ol>
</p>

<p>Pressing one button on the vectrex half enables "input chosing" - pressing (or moving) the actual hardware of the selected "real" input device - connects the two sides.</p>

<p>Pressing <img src="pics/add.png" alt="add.png" /> saves the configuration (after a valid name was entered.</p>

<p>Upon the next start of a vecxi window, the new input settings will be appear in the Joyport selection boxes.</p>

<p>Devices will be remembered for the next vide-sessions, however should the device not be available, it won't appear in the combobox.</p>
<br />

<p><b>Note</b>:<br />
There is a global setting for spinner emulation: "minimum cycles bewteen spinner events". Following an explanaition where this value is derived from, and when you might want to change it:</p>

<p>The driving atari-controller works thus, that the state of two switches form a 2 bit value, the actual spinner "rotates" the switch states 00 01 10 11 (binary).</p>

<p>The direction of rotation is computed via two of such states:<br />

<ul><li>
<p>left direction is computed when following states succeed each other:<br />
 00 &rarr; 01 <br />
 01 &rarr; 11 <br />
 10 &rarr; 00 <br />
 11 &rarr; 10  </p>
</li><li>
<p>right direction is computed when following states succeed each other: <br />
 00 &rarr; 10 <br />
 01 &rarr; 00 <br />
 10 &rarr; 11 <br />
 11 &rarr; 01</p>
</li></ul>
</p>

<p>All other succeeding "pairs" of states are "illegal" or no "movements" and are as such taken as "no movement".</p>

<p>The emulated paddle sets these paddle "button" values (button 1+2 of the used joyport) in the correct order at "fixed" intervalls. The minimum intervall these values are set is the cycle count given in the parameter "minimum cycles bewteen spinner events".<br />
(if you use analog emulation as input, than "slower" spinning is a multiple of that value)</p>

<p>So...<br />
If your vectrex game, refreshes once each 30000 cycles and you call the paddle "read"-routine every 30000 cycles everything is fine (default setting).</p>

<p>But if your game refreshes each 20000 and also reads paddle values each 20000 cylces the above state-order will "hickup" and some states will be read as "no movement".</p>

<p>Same happens if you read more paddle events per update round.</p>

<p>I think for most games the 30000 will be ok, but with the value "minimum cycles bewteen spinner events" you can actually alter the emulation of the paddle to accomodate possible slower games or multiple update readings.</p>
<hr />
<h1>Programming the Vectrex</h1>

<p>As yet unfinished, but the plan is to gather some coding resources and do some further explaining here beyond the mere source code which can be gotton from codi.</p>
<hr />
<h1>Strings - Raster</h1>
<h2>How are strings drawn by vectrex BIOS?</h2>

<p>The vectrex BIOS stores a raster "image" of all characters supported, this can be seen e.g. by using dumpi:</p>
<br/><p align="center">
<img src="pics/dumpiChars.png" width="1803" height="735" /><br/>
<em>Dumpi</em></p><br/>

<p>Each char is represented by 7 bytes, each byte repressents one row of the character and each bit position one column. So the "pixel" size of one char is 8*7 (height * width).</p>

<p>If a string is to be printed, the BIOS loads the address of the bitmap, examines each character of the string and uses the char values as a lookup reference into the raster image and outputs in one long line the first row of all characters of the string.</p>

<p>Of each char (in the string) the first byte is read and the bits which are set are output with the "light switched on" and bits which are not set are output with the "light switched off".</p>

<p>Actually each line of a String output is one long line which changes its "pattern"-byte continually along the way. Lets call this thing a "string-line" for easier reference.</p>

<p>All raster outputs on a vectrex are more or less done exactly that way.</p>
<h3>Outputting more than one line</h3>

<p>There is virtually no way the above explained can be made more efficient. To output one byte of (raster) data you need one full "shift cycle". One shift cycle takes 18 (CPU) cylces. You can finish that sooner - than you did not output 8 bits, you can finish that later, but you will not output more bits. So - exactly 18 cycles is what it takes. Fullstop!</p>

<p>The only way one can change the output of "complete" strings is to change the things which are done in between the output of each string-line.</p>

<p>Take a look at the following image, here I show three different ways what can be done:</p>
<br/><p align="center">
<img src="pics/printString.png" width="516" height="687" /><br/>
<em>PrintString</em></p><br/>
<h3>BIOS routine - the original</h3>

<p>This I call "uni directional output", in short:</p>

<ul><li>
<p>output one string line</p>
</li><li>
<p>go a little bit down</p>
</li><li>
<p>go back to the start of the line</p>
</li><li>
<p>do the above 7 times</p>
</li></ul>
<h3> Moon Lander routines (and some of "thomas")</h3>

<p>This I call "bi directional output", in short:<br />

<ul><li>
<p>output one string line</p>
</li><li>
<p>go down a little bit</p>
</li><li>
<p>while going back output an "inverse string line"</p>
</li><li>
<p>do above for all 7 lines</p>
</li></ul>
</p>
<h3>Alex Herbert/Kristof Tuts (?) routines</h3>

<p>This I call "synced output", in short:</p>

<ul><li>
<p>    output one string line</p>
</li><li>
<p>    zero the integrators, and wait</p>
</li><li>
<p>    reposition beam to start and move down a little</p>
</li><li>
<p>    do the above 7 times</p>
</li></ul>

<p> </p>
<h3>Pros /Cons</h3>

<p><i>uni directional output</i><br />

<ul><li>
<p>Speed - medium (shown example 10486 cycles for "Hello world this is - a wonderfull day")</p>
</li><li>
<p>vulnerable to vectrex drift, the longer the text the more "italic" it gets</p>
</li></ul>
</p>

<p><i>bi directional output</i><br />

<ul><li>
<p>Speed - fast (shown example 6209 cycles for "Hello world this is a wonderfull day")</p>
</li><li>
<p>vulnerable to vectrex drift, but not as much as "uni", tends to be a bit more "grizzly"</p>
</li><li>
<p>reports, that it does not work on all vectri (although I have not seen that in real live yet)</p>
</li></ul>
</p>

<p><i>synced output</i><br />

<ul><li>
<p>Speed - slow (shown example 12443 cycles for "Hello world this is a wonderfull day")</p>
</li><li>
<p>not! vulnerable to vectrex drift</p>
</li></ul>
</p>

<p>Example routines can be found in codi:<br />
<tt>codelib/Snippets/Malban/Print_Tests/ </tt></p>

<p> </p>
<hr />
<h1>Sound (Bios) - more or less</h1>

<p>Following I am assuming the length of a "gameloop" as 0,02 seconds (30000 cycles) - 50Hz, 0,02 seconds will further be references to as "soundticks".</p>

<p>(each calling of the BIOS function: "Init_Music_chk" executes one soundtick, the function is usually called once per gameloop)</p>

<p>The PSG supports 3 voices at the time, so our music can also be played utilizing three voices. Furthermore it has the ability to create noises, so we can not only play music, but can also have some shooting or explosion or the like sounds (snare drums...).</p>
<h3>Notes</h3>

<p>The music playing routines the BIOS provides us with, enables us to use 64 notes, ranging from G2 to AS7 (S=Sharp). In each octave we have 12 different notes, look at a BIOS for a list of all notes [BIOS location: $FC8D, using mod2Vectrex you can generate a human readable table of the notes+offset, you can also look in vide at "library&rarr;programming&rarr;Tutorial Malban&rarr;AppendixF" ]. If you absolutely hate music and do not even want any further information, the BIOS has several pieces of music built into (13 I think), you can use them in your programs for several usages, they range from simple songs, to some noise and bonus sounds. </p>
<h3>Music format</h3>

<p>The music structure the BIOS provides is described in Bruce Tomlins BIOS disassembly:<br />
</p>

<p><tt> ; Music data format:<br />
; <br />
; header word &rarr; $C84F 32 nibble ADSR table <br />
; header word &rarr; $C851 8-byte "twang" table <br />
; data bytes <br />
; <br />
; The ADSR table is simply 32 nibbles (16 bytes) of amplitude values. <br />
; <br />
; The twang table is 8 signed bytes to modify the base frequency of <br />
; each note being played. Each channel has a different limit to its <br />
; twang table index (6-8) to keep them out of phase to each other. <br />
; <br />
; Music data bytes: <br />
; Bits 0-5 = frequency <br />
; Bit 6 clear = tone <br />
; Bit 6 set = noise <br />
; Bit 7 set = next music data byte is for next channel <br />
; Bit 7 clear, play note with duration in next music data byte: <br />
; bits 0-5 = duration <br />
; bit 6 = unused <br />
; bit 7 set = end of music <br />
  </tt></p>

<p>While the above description is 100% correct IMHO it is hard to understand.</p>

<p>I will try to explain the format a little bit more closely.</p>

<ul><li>
<p>each data entry consists of 1,2 or 3 notes (1 channel, 2 channels or 3 channels) plus one entry for duration of the note </p>
</li><li>
<p>the notes are values from the frequency table</p>
</li><li>
<p>there are $3f different notes</p>
</li><li>
<p>but the "note" entry in the music structure uses all bits, the top most bits ... (see below)</p>
</li><li>
<p>in binary the bits %AONN NNNN are used (N = used) for notes</p>
</li><li>
<p>O bit (bit 6) is used to indicate whether an actual note or noise is played (0 = note, 1 = noise)</p>
</li><li>
<p>A bit (bit 7) indicates whether an additional channel is used, if so, the next value is expected to be another note, not the duration marker (up to a maximum of 3 channels)</p>
</li></ul>

<p>Example for one "line":<br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;FCB&nbsp;&nbsp;&nbsp;&nbsp;$80+2,$80+26, 14, 12&nbsp;&nbsp;&nbsp;&nbsp;;<br />
</tt></p>

<ul><li>
<p>plays the note "2" (A2) in channel 1, and continues to channel 2(+$80)</p>
</li><li>
<p>plays the note "26" (A4) in channel 2, and continues to channel 3(+$80)</p>
</li><li>
<p>plays the note "14" (A3) in channel 3</p>
</li><li>
<p>for a duration of 12</p>
</li></ul>

<p>The length of the note is in "soundticks". The maximum "sensible" length of a note is $1f (31) - because this is the maximum of the ADSR envelope - after that the note sound will be silenced.</p>
<h3>ADSR</h3>

<p>For a general explanation see google (or some other parts of this documentation).<br />
In relation to vectrex the ADSR used with BIOS routines consists of 16 bytes </p>

<p>These 16 bytes are split into nibbles (two 4 bit pieces in each byte), which each represent a 4 bit number, thus ranging from 0 to 15. Alltogether there are 32 nibbles.</p>

<p>Each note played will be "enveloped" in the ADSR table given. Each nibble (4 bit value) is read as a volume parameter ranging from 0 - 15. These volume parameters are applied over the duration of the note to the output volume of the note. </p>

<p>Thus each note is played with a volume level corresponding to the ADSR (nibble) value of the duration timer of the note at each soundtick. <br />
Example:<br />
</p>

<p><tt>adsr: db $cc, $fe, $dd, $dd, $aa, $88, $44, $00, $00, $00, $00, $00, $00, $00, $00, $00</tt></p>

<p>will play a note with following volume levels at each tick:<br />

<ol><li>
<p>Tick: volume 12 (of 15) ; Attack </p>
</li><li>
<p>Tick: volume 12 (of 15)</p>
</li><li>
<p>Tick: volume 15 (of 15) ; Decay</p>
</li><li>
<p>Tick: volume 14 (of 15)</p>
</li><li>
<p>Tick: volume 13 (of 15) ; Sustain (in vectrex the sustain IS timed)</p>
</li><li>
<p>Tick: volume 13 (of 15)</p>
</li><li>
<p>Tick: volume 13 (of 15)</p>
</li><li>
<p>Tick: volume 13 (of 15)</p>
</li><li>
<p>Tick: volume 10 (of 15) ; Release</p>
</li><li>
<p>Tick: volume 10 (of 15)</p>
</li><li>
<p>Tick: volume 8 (of 15)</p>
</li><li>
<p>Tick: volume 8 (of 15)</p>
</li><li>
<p>Tick: volume 4 (of 15)</p>
</li><li>
<p>Tick: volume 4 (of 15)</p>
</li><li>
<p>silence thereafter...</p>
</li></ol>
</p>

<p>If the duration of the note is shorter than the ADSR table, the played note will be cut off - and the next note will start directly.</p>

<p>The ADSR envelope "defines" (more or less) the type of instrument you like to play (again - google is your friend).</p>
<h3>Twang</h3>

<p>With the twang values you can define a kind of "vibrato" effect to. The Twang table consists of 8 bytes, each byte representing a signed byte value (-128 to +128). The value gotten from the twang table is added "directly" to the PSG sound registers for the frequency of the used channel (PSG registers 5/4, 3/2, 1/0) [remember, the frequency for each note is kept in the table located at: <tt>Vec_Freq_Table</tt> - $FC8D].<br />
  An internal counter for the twang table is increased with each soundtick and each soundtick the "next" value is used. The counter will be reset to 0 after a number of soundticks (and again increased). For each channel the rollover (soundtick-) timer is different:
<ul><li>
<p>channel 0: Twang rollover after 6 soundticks</p>
</li><li>
<p>channel 1: Twang rollover after 7 soundticks</p>
</li><li>
<p>channel 2: Twang rollover after 8 soundticks</p>
</li></ul>
</p>

<p>The internal TWANG counter is increased (and rolled over) whether a sound is actually played or not. The twang counter is not resetted when a note starts. That means a note can start of playing at any twang location.<br />
<br />
(Note:<br />
Even though the above table <tt>Vec_Freq_Table</tt> is called "frequency table", the values stored there are <b>not</b> frequencies, but values for the PSG-frequency registers. This means for example, for the note "C" there is a 12 bit value stored: $06 $AE this value put into the frequency registers of the correct channel translates to a frequency 65.416 Hz (which is pretty near the 65.406 Hz of the actual note "C".))<br />
</p>
<br />

<p><b>Note:<br />
</b> The routines used in mod2Vectrex is a modified version of the vectrex sound routines, while in general very similar, following changes were made:
<ul><li>
<p>allowing the use of "silence" as a note (value $3f), this also means one note less for the user</p>
</li><li>
<p>using "silence" (for the other channels) you can play each channels independendly</p>
</li><li>
<p>each channel has its own ADSR and TWANG setting</p>
</li></ul>
</p>

<p>What is still missing: <br />
Different "duration" timers for each channel.</p>
<h3>PSG accessing</h3>

<p>The PSG hardware is a bit "cumbersome" to access, from a programmers point of view. Therefor the BIOS developers  "shadowed" all soundchip registers in RAM.</p>

<p>If you only use BIOS functions, it is sufficient to modify the shadow registers of the PSG chip and call the "Do_Sound" routine ones per update round.</p>

<p>The RAM locations of the shadow is located at $C800.  That location should not be confused with "Vec_Music_Work" (located at: $C83F).</p>
<br />

<p>For a more in depth reading, please head over to: <br />
<tt> codi&rarr;Snippets&rarr;Christopher Tumber&rarr;Sound </tt> There you will also find Christophers own play routines, which allow more controll over single notes (like adsr length dependency), or playing each channel selectively.</p>

<p> </p>
<hr />
<h1>... a demo written</h1>

<p>Under the "projects" directory you can find a small demo written using Vide. The demo was "written" in a couple of hours and is merely ment as an example for vide-usage.</p>

<p>Here some clues what is done:<br />
<b>part 1</b><br />
</p>

<ul><li>
<p>When started the vectorlist "MALBAN" is displayed. That vectorlist was generated from an raster image using the utiliy "vector images" - and slightly edited thereafter in vecci. The drawing routine used was "draw_synced_list" - the routine was optimized for the used scale factor (since the orginal routine always assumes the worst), movetod was inlined.</p>
</li><li>
<p>A raster image is displayed showing a picture of me. That image was generated using the utility "raster images". The image is display uni directional, the display routine was also "optimized" the same way as the above mentioned vectorlist routine. The raster-image was also bit-shifted by hand to save one byte per line.</p>
</li><li>
<p>The displayed cube was generated using vecci, hiddenline removal was done by hand (but took only about 10 minutes). The cube is a "standard"- animation displayed by the BIOS-routine "Draw_VL_mode".</p>
</li><li>
<p>The background music a converted mod, nothing special done here, only selecting instruments in the mod converter.</p>
</li></ul>

<p><b>part 2</b> (after pressing any key)<br />

<ul><li>
<p>The "running" man was again created in vecci, using image to vector conversion and a little bit of editing afterwards. The vectorlist was further repositioned and scaled to use "good" vector strengths.<br />
The vectorlists are of arbitrary size some with lose ends and "inner circles". The list consists of a maximum of about 40 vectors. Therefor this animation is displayed using the "synced" list again. But I didn't bother to optimize the drawing routine all that much.</p>
</li><li>
<p>The music is a YM-converted (and packed) piece I found in the internet (Bitmap). I modified the YM_player slightly to not write to the soundchip, but to the shadow-registers in ram, with that it was easy to... </p>
</li><li>
<p>using the buttons 1-3 you can play 3 different AYFX sounds parallel to the YM-file using a modified AYFX-play routine. The modified routine also writes to the shadow register, doing that after the YM-routine "overlays" the ym generated sounds with the AYFX sounds.</p>
</li><li>
<p>The scrolltext was something I did some time ago, there must somewhere be a version that enters and exits the letters "clipped" but I have not found that one yet.</p>
</li></ul>
</p>
<hr />
<h1>Vectrex32</h1>
<h2>What is that?</h2>

<p>From the announcement of the author:<br />
</p>

<div class="code">
<p>I have created a new cartridge for the Vectrex that effectively upgrades it to 32 bits and allows you to write Vectrex games in interactive interpreted BASIC.</p>

<p>The cartridge, which I call the Vectrex32 SmartCart, is based on the Microchip PIC32. It's a 32 bit microcontroller that runs at 200 MHz, has a floating point unit, 2MB of flash, and 512KB of RAM. By comparison, the Vectrex's 6809 is an 8/16 bit processor with 8KB of ROM and 1K of RAM.</p>

<p>The BASIC interpreter and the game run on the PIC32. There's a dual-port memory chip readable and writable by both the PIC32 and the 6809. The PIC32 writes 6809 machine code into the dual-port memory and the 6809 runs it. Thirty times per second, the PIC32 writes the instructions needed to draw the screen, play sounds, and read the controller. Since the game logic is running on the PIC32, games can be far more sophisticated than anything the Vectrex could do alone.</p>

<p>The SmartCart also has a USB interface. When connected to a PC, it appears as a mass storage drive and a serial port. The drive holds BASIC programs and the serial port can be used with a terminal emulator. You can interactively debug a BASIC program (my version of BASIC supports breakpoints, single-stepping, printing out variables, and more). You can also interactively change things on the screen, e.g. you can experiment to get your shapes looking right and moving right.</p>

<p>The SmartCart provides advanced graphics features like sprites, scaling, rotating, and clipping.</p>

<p>Read more: <a target="_blank" href="http://vectrex32.com/">http://vectrex32.com/</a></p>
</div>
<h2>Vec32 Terminal</h2>

<p>Vide has some preliminary support for the above device. Like above described the device is accessed via:
<ul><li>
<p>9600 8n1 terminal (communication)</p>
</li><li>
<p>file system (usb drive - files)</p>
</li></ul>
</p>

<p>This makes handling/programming sometimes a bit cumbersome. For that reason I added editing and starting to vide.</p>

<p>You can access the Vec32 Terminal under the menu tools. If you do so, a window similar to vedi appears:</p>
<br/><p align="center">
<img src="pics/Vec32Help.png" width="1239" height="983" /><br/>
<em>Vec32 Terminal</em></p><br/>

<p>In the upper region of the window you must define the Vectrex32 device parameters
<ol><li>
<p>give the serial port, the <img src="pics/arrow_refresh.png" alt="arrow_refresh.png" /> rescans the available ports (in case you switched on vectrex "later")</p>
</li><li>
<p>the location of the usb drive</p>
</li></ol>
</p>
<h3>serial connection</h3>

<p>The combobox gives you all currently available serial ports. Please chose the correct one. There is no internal testing if you chose the correct port! (probably nothing but will come from a wrong port choice - but you won't be able to run your BASIC programs)</p>

<p>The serial port selection was tested with <i>Windows 7</i>, <i>Mac OSX</i> and <i>Linux Ubuntu</i>. If there is any problem establishing a connection, you may try reaching out to Malban.</p>

<p><b>Note:</b><br />
Under my linux installation it was neccessary to change file system permissions for the tty. You may need to do so too. With my system following line was neccessary:<br />
 <br />
<tt>sudo chmod 666 /dev/ttyACM0<br />
</tt></p>

<p>(your terminal might have a different name)</p>
<h3>file system connection</h3>

<p>The usb drive of Vectrex 32 stores the BASIC programs that can be run "on" the vectrex. In order to store files there, naturally the drive must be mounted to some place.</p>

<p>Chose the right drive/folder/mountpoint using the file selection button.<br />
The contents of the drive will be displayed in the treeview to the left.</p>

<p>Only if that location is chosen correctly the transport of your edited files to the Vectrex32 cart will succeed!</p>
<h2>Connect</h2>

<p>If you selected the above two entities, press "connect" to connect to the Vectrex 32 device. If the connection was successfull a green "connected" will appear next to the button (a red "not connected" otherwise).</p>

<p>The device settings will be stored. But can naturally only be used if the Vectrex 32 device is connected and switched on.</p>
<h2>Buttons</h2>

<p><img src="pics/new.png" alt="new.png" /><br />
Creates a new file.<br />
</p>

<p><img src="pics/arrow_refresh.png" alt="arrow_refresh.png" /><br />
Refresh the current display tree (if you externally added files - e.g.).<br />
</p>

<p><img src="pics/page_go.png" alt="page_go.png" /><br />
Load a file (from anywhere).<br />
Pressing shift with the button, will reload the current edited file.</p>

<p><img src="pics/page_save.png" alt="page_save.png" /><br />
Save the current file.<br />
Pressing shift with the button, will "save as" - opens a file dialog.</p>

<p><img src="pics/text_columns.png" alt="text_columns.png" /><br />
Restarts syntax highlighting.</p>

<p><img src="pics/control_play_blue.png" alt="control_play_blue.png" /> <br />
Saves the current file to its original location (probably on the Vectrex 32 device) and tries to run it as a BASIC program.</p>

<p>In order to do that following "terminal"-commands are send:</p>

<ul><li>
<p><tt>CRTL/C</tt><br />
(breaks any currently running Vectrex 32 programs)</p>
</li><li>
<p><tt>STOP</tt><br />
(stops any currently running Vectrex 32 programs)</p>
</li><li>
<p><tt>LOAD "currentFile"</tt><br />
(tries to load the just saved program)</p>
</li><li>
<p><tt>RUN</tt><br />
(... and starts it)</p>
</li></ul>
<h2>The tree</h2>

<p>If "initialization" of Vectrex 32 went alright, than the tree shows the files which are stored on the Vectrex 32 usb device. Clicking on such a file will open it in the editor to the right. There are no popup menus (yet).</p>
<h2>Editor</h2>

<p>The editor is basically the same as vide, with a different syntax highlighting. Inserting vectorlists and quickhelp is <b>not</b> available.</p>
<h2>Terminal</h2>

<p>The lower part of the window is the "Terminal". <br />
The terminal window provides the two way communication with the Vectrex 32 device.</p>

<p>Basically I tried to implement a "C64"-like screen. Within the terminal you can move accross the panel using cursor keys. Pressing return will send <i>that</i> line (up to the cursor position) to the Vectrex 32 device.</p>

<p>Hitting CTRL/C will send a "CTRL/C" to the device.</p>

<p>Letters are <b>not</b> send when typed - they are only send after hitting "return" (CTRL/C being an exception).</p>

<p><b>Caveats</b><br />
The terminal "emulation" is not as "clean" as I would like. Since the serial device is both an input and an output device, some communications (sometimes) when printing to the used jEditorPane (Java thingy) seem to "overlap". Everything works alright but some letters are sometimes printed in the wrong place.</p>

<p>Without doing a completely different "thing" I don't think this can be changed easily (I <i>tried! </i>). What I usually do when "talking" to the device is, "CTRL/A" + delete to clear the screen and start fresh (or just press the little "sun" button).</p>

<p>I also noticed, that sometimes the "CTRL/C" is not accepted immediatly, if that is the case, press "return" after the "CTRL/C".</p>

<p>After implementing the "terminal" emulation - I have not used any "real" terminal with Vectrex 32, so I don't know if the next behaviour does also exist in the "normal" environment.<br />
Sometimes, when running a BASIC program the serial communication seems to "stumble". The 5 different parts are executed right after another (SAVE, CTRL/C, STOP, LOAD, RUN), sometimes it seems, that the filesystem transfer is not finished, when the "LOAD" is commited to the device. Than the BASIC program is loaded in an "unfinished state" - which results in any kind of BASIC error. If a totally unexpected error happens, just try another "RUN"(YES, I already implemented a delay after the saving...).  </p>
<h2>Vecci support</h2>

<p>Vectorlists that are build in vecci and are exportable as "Draw_VL_mode" can also be exported in BASIC format. To do that check the little checkbox at the side of the corresponding button. If done, a vectorlist usable in BASIC programs will be generated. Example:<br />
<tt> VectorList={&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{MoveTo, +$20, -$40}, &nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{DrawTo, +$20, +$00}, &nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{DrawTo, +$00, +$40}, &nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{DrawTo, -$20, +$00}, &nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{DrawTo, -$20, -$40}, &nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{DrawTo, +$20, +$00}, &nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{DrawTo, -$20, +$00}, &nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{DrawTo, +$20, -$40}}<br />
</tt></p>

<p>If you also check the "runnable" button, a Vectrex 32 runable BASIC program which displays your vectorlist will be generated.</p>

<p>To transport the generated vectorlist to your own BASIC program you (as of now) must use copy/paste from vecci to Vec32.</p>
<h2>YM support</h2>

<p>In the middle of the iconbar is a "YM"-button, with that you can call the YM-editor and load and convert YM-data to BASIC.<br />
The only output option as of now is UNPACKED (and not switchable).  <br />
Beware, that the storage space of the Vectrex32 is "only" 430KB and that can be easily filled with a moderatly long YM files and its BASIC data output.<br />
A BASIC ym-player can also be generated.</p>
<h2>Attention!</h2>

<p>Following facts can be confusing when using Vectrex 32:
<ul><li>
<p>the BASIC text files must be "windows" like, thus a line must end with  0x0d + 0x0a characters (vide does that for you)</p>
</li><li>
<p>all vectorlists have the coordinates switched to "usual" vectrex usage, thus a vectorlist is stored with x, y as coordinates, <b>not</b> y, x</p>
</li><li>
<p>coordinates within a vectorlist are "absolut" not relative</p>
</li></ul>
</p>
<hr />
<h1>Draw_VLc - Optimizations</h1>
<h2>Motivation</h2>

<p>In this section I would like to demonstrate possible steps to optimize vectorlist drawing.</p>

<p>The shown possible steps are not ment to be "complete", exclusively right or particulary engenious.</p>

<p>Each scenario of ones own coding base provides grounds for other or more specific optimization technics.</p>

<p>I will show different versions of printing a vectorlist, which in each version step will be slightly more optimized in specific ways. </p>

<p>The demonstration program(s) will draw a vectorlist which represents a "hut" like:</p>
<br/><p align="center">
<img src="pics/Hut.png" width="366" height="508" /><br/>
<em>Hut</em></p><br/>

<p>(The hut is pretty small, but as you will see, drawing a "small" list is easier to optimize - also in many games drawing many small objects is the predominant scenario)</p>
<h2>Version 1 - 3164 cycles - basis</h2>

<p>Basis:</p>

<div class="code">
<p><tt> ;*****************************************************<br />
; DEFINE SECTION<br />
;*****************************************************<br />
; load vectrex bios routine definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INCLUDE  "VECTREX.I"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; vectrex function includes<br />
<br />
;*****************************************************<br />
; Variable / RAM SECTION<br />
;*****************************************************<br />
; insert your variables (RAM usage) in the BSS section<br />
; user RAM starts at $c880 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BSS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$c880&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; start of our ram space <br />
<br />
;*****************************************************<br />
; HEADER SECTION<br />
;*****************************************************<br />
; The cartridge ROM starts at address 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 <br />
; the first few bytes are mandatory, otherwise the BIOS will not load<br />
; the ROM file, and will start MineStorm instead<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"g GCE 1998", $80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; "g' is copyright sign<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;music1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; music from the rom <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$F8, $50, $20, -$80&nbsp;&nbsp;&nbsp;; hight, width, rel y, rel x (from 0,0) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"DRAW LINES V1", $80&nbsp;&nbsp;; some game information, ending with $80<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; end of game header <br />
<br />
;*****************************************************<br />
; CODE SECTION<br />
;*****************************************************<br />
; here the cartridge program starts off<br />
main: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wait_Recal&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Vectrex BIOS recalibration <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intensity_5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Sets the intensity of the <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; vector beam to $5f <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$b0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; scalefactor<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_t1_cnt_lo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; position relative Y <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; position relative X<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Moveto_d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; sets up VIA control register after a wait recal<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#vData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; address of string <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Draw_VLc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Vectrex BIOS print routine <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; and repeat forever <br />
<br />
<br />
;*****************************************************<br />
; DATA SECTION<br />
;*****************************************************<br />
<br />
vData = VectorList<br />
VectorList:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; number of lines to draw<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$00, +$06 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07, +$00 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$05, -$03 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$05, -$03 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$07, +$00 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07, +$06 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$00, -$06 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$07, +$06 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; draw to y, x<br />
</tt><br />
</p>
</div>
<h2>Version 2 - 1637 cycles - scale factor!</h2>

<p>In the above version (for demonstration purposes) I used a large scale factor and small vector strengths. Using a small scale factor and large vector strength results in huge optimization effects.</p>

<p>The scale factor and strength changes are not 1:1 - you have to experiment to get the same "sizes" of the resulting lists.</p>

<p>In the example I changed the scale factor from $b0 to $06, and multiplied each (original) strength by 18.</p>

<div class="code">
<p><tt> ;*****************************************************<br />
; DEFINE SECTION<br />
;*****************************************************<br />
; load vectrex bios routine definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INCLUDE  "VECTREX.I"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; vectrex function includes<br />
<br />
;*****************************************************<br />
; Variable / RAM SECTION<br />
;*****************************************************<br />
; insert your variables (RAM usage) in the BSS section<br />
; user RAM starts at $c880 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BSS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$c880&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; start of our ram space <br />
<br />
;*****************************************************<br />
; HEADER SECTION<br />
;*****************************************************<br />
; The cartridge ROM starts at address 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 <br />
; the first few bytes are mandatory, otherwise the BIOS will not load<br />
; the ROM file, and will start MineStorm instead<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"g GCE 1998", $80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; "g' is copyright sign<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;music1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; music from the rom <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$F8, $50, $20, -$80&nbsp;&nbsp;&nbsp;; hight, width, rel y, rel x (from 0,0) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"DRAW LINES V2", $80&nbsp;&nbsp;; some game information, ending with $80<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; end of game header <br />
<br />
;*****************************************************<br />
; CODE SECTION<br />
;*****************************************************<br />
; here the cartridge program starts off<br />
main: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wait_Recal&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Vectrex BIOS recalibration <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intensity_5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Sets the intensity of the <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; vector beam to $5f <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; scalefactor<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_t1_cnt_lo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; position relative Y <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; position relative X<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Moveto_d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; sets up VIA control register after a wait recal<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#vData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; address of string <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Draw_VLc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Vectrex BIOS print routine <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; and repeat forever <br />
<br />
<br />
;*****************************************************<br />
; DATA SECTION<br />
;*****************************************************<br />
<br />
BLOW&nbsp;UP = 18<br />
vData = VectorList<br />
VectorList:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; number of lines to draw<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$00*BLOW_UP, +$06*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07*BLOW_UP, +$00*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$05*BLOW_UP, -$03*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$05*BLOW_UP, -$03*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$07*BLOW_UP, +$00*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07*BLOW_UP, +$06*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$00*BLOW_UP, -$06*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$07*BLOW_UP, +$06*BLOW_UP; draw to y, x<br />
</tt><br />
</p>
</div>
<h2>Version 3 - 1630 cycles - macro!</h2>

<p>This version is a step "in between". Nothing really changed, only  the call of "<tt>JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Draw&nbsp;VLc</tt>" was replaced with a macro call of exactly the same routine.</p>

<div class="code">
<p><tt> ;*****************************************************<br />
; DEFINE SECTION<br />
;*****************************************************<br />
; load vectrex bios routine definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INCLUDE  "VECTREX.I"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; vectrex function includes<br />
<br />
DRAW_VLC            macro    <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;direct&nbsp;&nbsp;$d0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; following code uses d0 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,X+ <br />
Draw_VL_a_macro? <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$C823 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,X <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Send Y to A/D <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Enable mux <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAX&nbsp;&nbsp;&nbsp;&nbsp;2,X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Point to next coordinate pair <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Wait a moment <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Disable mux <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Send X to A/D <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$FF00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Shift reg=$FF (solid line), T1H=0 <br />
LF3ED\?: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_shift_reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Put pattern in shift register <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_t1&nbsp;cnt_hi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Set T1H (scale factor?) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$0040&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;B-reg = T1 interrupt bit <br />
LF3F4\?: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BITB&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_int_flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Wait for T1 to time out <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEQ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LF3F4\? <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Wait a moment more <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_shift_reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Clear shift register (blank output) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$C823&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Decrement line count <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DECA&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BPL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Draw_VL_a_macro\?&nbsp;&nbsp;&nbsp;&nbsp;;Go back for more points <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check0Ref&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Reset zero reference if necessary <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endm     <br />
<br />
;*****************************************************<br />
; Variable / RAM SECTION<br />
;*****************************************************<br />
; insert your variables (RAM usage) in the BSS section<br />
; user RAM starts at $c880 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BSS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$c880&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; start of our ram space <br />
<br />
;*****************************************************<br />
; HEADER SECTION<br />
;*****************************************************<br />
; The cartridge ROM starts at address 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 <br />
; the first few bytes are mandatory, otherwise the BIOS will not load<br />
; the ROM file, and will start MineStorm instead<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"g GCE 1998", $80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; "g' is copyright sign<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;music1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; music from the rom <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$F8, $50, $20, -$80&nbsp;&nbsp;&nbsp;; hight, width, rel y, rel x (from 0,0) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"DRAW LINES V3", $80&nbsp;&nbsp;; some game information, ending with $80<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; end of game header <br />
<br />
;*****************************************************<br />
; CODE SECTION<br />
;*****************************************************<br />
; here the cartridge program starts off<br />
main: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wait_Recal&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Vectrex BIOS recalibration <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intensity_5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Sets the intensity of the <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; vector beam to $5f <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; scalefactor<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_t1_cnt_lo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; position relative Y <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; position relative X<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Moveto_d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; sets up VIA control register after a wait recal<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#vData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; address of string <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DRAW_VLC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Macro print routine <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; and repeat forever <br />
<br />
<br />
;*****************************************************<br />
; DATA SECTION<br />
;*****************************************************<br />
<br />
BLOW&nbsp;UP = 18<br />
vData = VectorList<br />
VectorList:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; number of lines to draw<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$00*BLOW_UP, +$06*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07*BLOW_UP, +$00*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$05*BLOW_UP, -$03*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$05*BLOW_UP, -$03*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$07*BLOW_UP, +$00*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07*BLOW_UP, +$06*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$00*BLOW_UP, -$06*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$07*BLOW_UP, +$06*BLOW_UP; draw to y, x<br />
</tt><br />
</p>
</div>
<h2>Version 4 - 1531 cycles - optimized macro!</h2>

<p>The above introduced macro was changed to a manualy optimized version.</p>

<div class="code">
<p><tt> ;*****************************************************<br />
; DEFINE SECTION<br />
;*****************************************************<br />
; load vectrex bios routine definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INCLUDE  "VECTREX.I"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; vectrex function includes<br />
<br />
DRAW_VLC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;macro    <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;direct&nbsp;&nbsp;$d0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; following code uses d0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,X++&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$C823&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLRA<br />
_DRAW_VLA\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_b<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,X+<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Send X to A/D<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_shift_reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Put pattern in shift register<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_t1_cnt_hi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;enable timer 1<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,X+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; 6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$C823&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; 7<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEQ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DRAW_END\?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; 3 Go back for more points<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;B-reg = T1 interrupt bit<br />
LF_1\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BITA&nbsp;&nbsp;&nbsp;&nbsp;VIA_int_flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Wait for T1 to time out<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEQ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LF_1\?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Wait a moment more<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_shift_reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Clear shift register (blank output)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DRAW_VLA\?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; 3<br />
_DRAW_END\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;B-reg = T1 interrupt bit<br />
LF_2\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BITA&nbsp;&nbsp;&nbsp;&nbsp;VIA_int_flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Wait for T1 to time out<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEQ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LF_2\?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Wait a moment more<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_shift_reg<br />
; one more round<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_b<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,X+<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Send X to A/D<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_shift_reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Put pattern in shift register<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_t1_cnt_hi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;enable timer 1<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;B-reg = T1 interrupt bit<br />
LF_3?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BITA&nbsp;&nbsp;&nbsp;&nbsp;VIA_int_flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Wait for T1 to time out<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEQ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LF_3\?<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_shift_reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Clear shift register (blank output)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endm<br />
<br />
;*****************************************************<br />
; Variable / RAM SECTION<br />
;*****************************************************<br />
; insert your variables (RAM usage) in the BSS section<br />
; user RAM starts at $c880 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BSS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$c880&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; start of our ram space <br />
<br />
;*****************************************************<br />
; HEADER SECTION<br />
;*****************************************************<br />
; The cartridge ROM starts at address 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 <br />
; the first few bytes are mandatory, otherwise the BIOS will not load<br />
; the ROM file, and will start MineStorm instead<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"g GCE 1998", $80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; "g' is copyright sign<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;music1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; music from the rom <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$F8, $50, $20, -$80&nbsp;&nbsp;&nbsp;; hight, width, rel y, rel x (from 0,0) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"DRAW LINES V4", $80&nbsp;&nbsp;; some game information, ending with $80<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; end of game header <br />
<br />
;*****************************************************<br />
; CODE SECTION<br />
;*****************************************************<br />
; here the cartridge program starts off<br />
main: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wait_Recal&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Vectrex BIOS recalibration <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intensity_5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Sets the intensity of the <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; vector beam to $5f <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; scalefactor<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_t1_cnt_lo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; position relative Y <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; position relative X<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Moveto_d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; sets up VIA control register after a wait recal<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#vData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; address of string <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DRAW_VLC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Macro print routine <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; and repeat forever <br />
<br />
<br />
;*****************************************************<br />
; DATA SECTION<br />
;*****************************************************<br />
<br />
BLOW_UP = 18<br />
vData = VectorList<br />
VectorList:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; number of lines to draw<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$00*BLOW_UP, +$06*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07*BLOW_UP, +$00*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$05*BLOW_UP, -$03*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$05*BLOW_UP, -$03*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$07*BLOW_UP, +$00*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07*BLOW_UP, +$06*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$00*BLOW_UP, -$06*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$07*BLOW_UP, +$06*BLOW_UP; draw to y, x<br />
</tt><br />
</p>
</div>
<h2>Version 5 - 1416 cycles - loop unrolling and cycle specific!</h2>

<p>The loop in the vector drawing was unrolled, and the actual drawing routine does not have  a wait loop anymore, since we <i>now</i> that the length of the loop (= scalefactor) is 6. We can use the information, that we only draw for 6 cycles, to NOT wait for these 6 cycles to finish - we know how many cycles our instructions take.</p>

<p>To do the loop unrolling and some of the math involved (jump into a unrolled vector drawing routine) we changed the first parameter of the vectorlist to have a unrolled offset counter instead of the vectorlist length.</p>

<p>The maximum unrolled loop in this version is 11 vectors (maximum vectorlist size).</p>

<p>The size of the header (10) and one line (16) is manually computed, but could also be automatically gotten from address "math".</p>

<div class="code">
<p><tt> ;*****************************************************<br />
; DEFINE SECTION<br />
;*****************************************************<br />
; load vectrex bios routine definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INCLUDE  "VECTREX.I"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; vectrex function includes<br />
<br />
ONE_LINE_LENGTH&nbsp;&nbsp;&nbsp;EQU 16<br />
LENGTH_OF_HEADER&nbsp;&nbsp;EQU (4+2+2+2)<br />
MAX_LINE_NUM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQU 23<br />
<br />
<br />
ONE_LINE_DRAW macro&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; cycles<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [6] Disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [6] Send X to A/D<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_shift_reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [6] Put pattern in shift register<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_t1_cnt_hi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [4] enable timer 1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,X++&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [8] load Y coordinate to A, X coordinate to B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [4] Send Y to A/D<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [4] enable mux, thus y integrators are set to Y<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_shift_reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [4] turn the lights off<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endm<br />
<br />
MY_SPRITE_DRAW_VLC_UNLOOP_SMALL&nbsp;macro<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ,X++&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;(2)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;(2) [4] Send Y to A/D<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;(2) [4] enable mux, thus y integrators are set to Y<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JMP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[i_jump]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;(4)<br />
JUMP_INTO_ALL\?:<br />
JUMP_INTO_11\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ONE_LINE_DRAW<br />
JUMP_INTO_10\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ONE_LINE_DRAW<br />
JUMP_INTO_09\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ONE_LINE_DRAW<br />
JUMP_INTO_08\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ONE_LINE_DRAW<br />
JUMP_INTO_07\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ONE_LINE_DRAW<br />
JUMP_INTO_06\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ONE_LINE_DRAW<br />
JUMP_INTO_05\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ONE_LINE_DRAW<br />
JUMP_INTO_04\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ONE_LINE_DRAW<br />
JUMP_INTO_03\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ONE_LINE_DRAW<br />
JUMP_INTO_02\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ONE_LINE_DRAW<br />
JUMP_INTO_01\?:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [6] Disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [6] Send X to A/D<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_shift_reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [6] Put pattern in shift register<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_t1_cnt_hi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [4] enable timer 1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endm<br />
<br />
;*****************************************************<br />
; Variable / RAM SECTION<br />
;*****************************************************<br />
; insert your variables (RAM usage) in the BSS section<br />
; user RAM starts at $c880 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BSS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$c880&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; start of our ram space <br />
<br />
;*****************************************************<br />
; HEADER SECTION<br />
;*****************************************************<br />
; The cartridge ROM starts at address 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 <br />
; the first few bytes are mandatory, otherwise the BIOS will not load<br />
; the ROM file, and will start MineStorm instead<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"g GCE 1998", $80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; "g' is copyright sign<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;music1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; music from the rom <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$F8, $50, $20, -$80&nbsp;&nbsp;&nbsp;; hight, width, rel y, rel x (from 0,0) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"DRAW LINES V5", $80&nbsp;&nbsp;; some game information, ending with $80<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; end of game header <br />
<br />
;*****************************************************<br />
; CODE SECTION<br />
;*****************************************************<br />
; here the cartridge program starts off<br />
main: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wait_Recal&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Vectrex BIOS recalibration <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intensity_5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Sets the intensity of the <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; vector beam to $5f <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; scalefactor<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_t1_cnt_lo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; position relative Y <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; position relative X<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Moveto_d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; sets up VIA control register after a wait recal<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#vData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; address of string <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,X++&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; load offset of vector list draw<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDD&nbsp;&nbsp;&nbsp;&nbsp;#(unloop_start_address0+LENGTH_OF_HEADER-12*ONE_LINE_LENGTH); 4=JMP [], 2=LDD ,X++<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_jump<br />
unloop_start_address0:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MY_SPRITE_DRAW_VLC_UNLOOP_SMALL  <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VIA_shift_reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [4] turn the lights off<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; and repeat forever <br />
<br />
<br />
;*****************************************************<br />
; DATA SECTION<br />
;*****************************************************<br />
<br />
BLOW&nbsp;UP = 18<br />
vData = VectorList<br />
VectorList:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DW (MAX&nbsp;LINE&nbsp;NUM-(7+1))*ONE&nbsp;LINE&nbsp;LENGTH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$00*BLOW_UP, +$06*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07*BLOW_UP, +$00*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$05*BLOW_UP, -$03*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$05*BLOW_UP, -$03*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$07*BLOW_UP, +$00*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$07*BLOW_UP, +$06*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB +$00*BLOW_UP, -$06*BLOW_UP; draw to y, x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB -$07*BLOW_UP, +$06*BLOW_UP; draw to y, x<br />
</tt><br />
</p>
</div>
<h2>Version 6 - 1376 cycles - tricking VIA!</h2>

<p>- unfinished - </p>
<hr />
<h1>Drawing vectors - differently</h1>

<p>Simply put vector drawing goes like this:
<ul><li>
<p>place the beam on the screen</p>
</li><li>
<p>switch the light on</p>
</li><li>
<p>move the beam with light switched on</p>
</li><li>
<p>switch the light off</p>
</li></ul>
</p>

<p>Less simple:<br />
The way BIOS (and most other implementations) draw vectors is:<br />
(drawing characters or raster data is slightly different)
<ul><li>
<p>place the beam somewhere (MoveTo)</p>
</li><li>
<p>set the scale factor (Timer1 Lo)</p>
</li><li>
<p>set y strength (integrator Y)</p>
</li><li>
<p>set x strength (integrator X)</p>
</li><li>
<p>write $ff to shift register (the light is switched on)</p>
</li><li>
<p>start timer 1 (which, starts the ~RAMP (vector beam is moving))</p>
</li><li>
<p>wait for timer 1 to expire (~RAMP is switched off)</p>
</li><li>
<p>write $00 to shift register (switch the light off)</p>
</li></ul>
</p>

<p>A short via side explanation (for more in depth see "Vectrex internals &rarr; Analog").</p>

<p><b>~RAMP<br />
</b> Moving the beam internally is realized using integrator circuits which are connected to the deflection coils. Whether the integrators are integrating or not is controlled by a single "flag" (one BIT), which is called ~RAMP. </p>

<p>~RAMP is a zero active flag, meaning the integrators are WORKING when the ~RAMP flag equals zero, this is indicated by the "~" in front of the flag.</p>

<p><b>~BLANK<br />
</b> Switching the light on and off is internally nearly the same thing, the brightness of the light is set equally to the strength of the vectors [NOT using the blank flag], and the circuit telling the CRT to actually send a "strong" electron beam (which illuminates the phosphor coated tube) is not really that much different than the deflection coil circuits. <br />
What the "~RAMP" signal is for moving - that is the "~BLANK" signal for light on off.<br />
The ~BLANK is also a single (zero active) flag, which tells vectrex to switch the light off ~BLANK equals zero, or to switch the light on (~BLANK non zero).</p>

<p><b>VIA<br />
</b> To communicate the state of the flags (set/unset) VIA 6522 is used.</p>

<p>~RAMP flag is connected the seventh bit of VIA port B (in the following the short form of PB7 is used (<b>P</b>ort <b>B</b> bit <b>7</b>).</p>

<p>~BLANK flag is connected to the VIA Control line Port B 2 (in the following the short form CB2 is used (<b>C</b>ontroll line Port <b>B 2</b>))</p>

<p><b>Versatile<br />
</b> As the name VIA (Versatile Interface Adapter) implies - there are more than one way to handle things. Via has a couple of control registers, that influence the way it behaves. In relation to the above two "flags" (PB7 = ~RAMP and CB2 = ~BLANK) following information is "interesting":<br />
</p>

<p>Default BIOS settings:<br />
VIA register $b (auxiliary control register) is set to $98, which in bits is %10 0 110 00. (See also Vide documentaion: Vectrex internals&rarr; VIA)<br />

<ul><li>
<p>Bit 7 and 6 ["10"]: sets the behaviour of Timer T1, in short "10" means:<br />
<i>count down to zero and than stop, also while counting down set PB7 to zero, when countdown is finished, set PB7 to one</i></p>
</li><li>
<p>Bit 4, 3 and 2 ["110"]: sets the bevaviour of the SHIFT Register of VIA, the "combined" behaviour setting result is:<br />
<i>every two processor cycle shift out the MSB (most significant bit) to CB2, at the same time shift the MSB back to the LSB (least significant bit). Keep on shifting till I tell you something else [the actual shifting starts once the Shiftreg is read or written to]</i>.</p>
</li></ul>
</p>

<p>What this boils down to is the above described "less simple" way of drawing a vector.<br />
</p>

<p>Starting the timer 1 "automatically" starts moving the vector. Programatically writing "$ff" to the shift register switches the light on for every shift cycle following (~BLANK = 1 means the light is on).</p>

<p>When the timer t1 reaches zero, the vector automatically stops moving. Than one programatically has to switch the light of by writing 0 to the shift register.<br />
(Note: it is better to do a <tt><br />
&nbsp;&nbsp;clra<br />
&nbsp;&nbsp;sta via_shiftreg</tt><br />
than to do a<br />
<tt>&nbsp;&nbsp;clr via_shiftreg</tt>, <br />
the speed (processor cycles) is the same, but doing a "<tt>clr via_shiftreg</tt>"  also READS the shiftreg, which inherently starts shifting and does output at least one other shift cycle to CB2). <br />
<br />
As you might notice, the switch light off using the above method always switches the light off after the moving stops - actually the light is switched off (due to instructions being not immediate) after some additional cycles (at least 4). Meaning the light is kept on for that number of cycles for to long!</p>

<p>You can see that on your vectrex, each vector has a brighter spot at its end, this is because the light is switched of a few cycles to late.</p>
<h2>Differently</h2>

<p>As you might have guessed with the above mentioning of "versatile" - you can also access the above flags differently.</p>

<p>One other ways to access both bits is to set them "manually".</p>

<p>Below given example (in X register given a Draw_VLc compatible vectorlist) draws vectors "manually" - meaning without using a timer and without using the shift register.</p>

<p>Following settings were used:<br />
VIA register $b (auxiliary control register) is set to $00, which in bits is %00 0 000 00. (See also Vide documentaion: Vectrex internals&rarr; VIA)<br />

<ul><li>
<p>Bit 7 and 6 ["00"]: sets the behaviour of Timer T1, in short "00" means:<br />
<i>Do not influence PB7 by timer 1.</i></p>
</li><li>
<p>Bit 4, 3 and 2 ["110"]: sets the bevaviour of the SHIFT Register of VIA, the "combined" behaviour setting result is:<br />
<i>Disable Shift register activity</i>.</p>
</li></ul>
</p>

<p>By setting the via auxiliary control register to above values, both flags can be set manually. 
<ul><li>
<p>PB7 <br />
can manually be set by writing appropriate values to  "VIA_port_b" (Bit 7).</p>
</li><li>
<p>CB2<br />
 can manually be set by setting appropriate values to "VIA_cntl" (Bit 5, 6 and 7 are responsible for CB2 bevaviour)</p>
</li></ul>
</p>

<div class="code">
<p><tt> fixDraw: <br />
; setup fixdraw<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda&nbsp;&nbsp;&nbsp;,x+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; load the count of vectors to draw <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta&nbsp;&nbsp;&nbsp;tmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; and remember them somewhere <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;#$81&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;; mux disabled, ramp disables <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;#$00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&lt;VIA_aux_cntl&nbsp;&nbsp;; Shift reg mode = 000 free disable, T1 PB7 disabled<br />
  noEnd:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda&nbsp;&nbsp;&nbsp;#$ce <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&lt;VIA_cntl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; ZERO disabled, and BLANK enabled <br />
nextv:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldd&nbsp;&nbsp;&nbsp;,x++&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; a = y, b = x <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&lt;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;; Y &rarr; Send it to the D/A <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda&nbsp;&nbsp;&nbsp;#$80 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;; ramp disabled, mux enabled &rarr; to Y <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inca&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;; ramp disabled, mux disabled &rarr; to Y <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STB&nbsp;&nbsp;&nbsp;&lt;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;; X &rarr; Send it to the D/A <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldd&nbsp;&nbsp;&nbsp;#$8101 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stb&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;; below are x cycles RAMP switched on!<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldb&nbsp;&nbsp;&nbsp;#$ee <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stb&nbsp;&nbsp;&nbsp;&lt;VIA_cntl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; ZERO disabled, and BLANK disabled <br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop&nbsp;&nbsp;&nbsp;10 ; DELAY<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;; disable ramp ; should again be $81 <br />
; and x +y cycles light switched on<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop&nbsp;&nbsp;&nbsp;2 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dec&nbsp;&nbsp;&nbsp;tmp <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bpl&nbsp;&nbsp;&nbsp;noEnd <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldb&nbsp;&nbsp;&nbsp;#$ce <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stb&nbsp;&nbsp;&nbsp;&lt;VIA_cntl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; ZERO disabled, and BLANK enabled <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;#$98 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&lt;VIA_aux_cntl <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rts&nbsp;&nbsp;&nbsp;<br />
</tt><br />
</p>
</div>

<p>The line with "<tt>nop&nbsp;&nbsp;&nbsp;10&nbsp;; DELAY</tt>" is resonsible for the size of the resulting image (much like the scale factor).</p>
<br />

<p><b>Note:</b><br />
Although the code above suggests otherwise  in consideration of VIA internal timings - the above vector drawing done is (at least using my vectri) cycle exact. ~RAMP and ~BLANK are set and unset at the correct times, and there are no bright spots on either side of the drawn vectors. (~BLANK is switched off for 20 cycles <i>longer</i> than ~RAMP - I have no clue what VIA is doing in those 20 cycles!)<br />
</p>
<br />

<p><b>Note:</b><br />
The timings given in above example have been experimentally gotten by trial an error using real life vectrex systems. While Vide is able to display the result correctly, emulation of VIA internal timing is not good enough to trust the emulator on timing experiments.</p>
<hr />
<h1>Vectrex internals</h1>

<p>Different texts I started writing along the ways...</p>

<p>These are not finished, sorted or in places even coherent...</p>
<hr />
<h1>VIA Versatile Interface Adapter  6522A MOS Technology</h1>

<p>Sometimes people also say PIA (Periphal Interface Adapter, but that name usuall goes to another chip 6520), although since VIA is more "versatile" it includes all stuff PIA can do - and more!</p>

<p>VIA is accessed from Vectrex programs using 16 registers which are mapped to the memory location ranging from: <br />
$d000 to $d00f<br />
That mapping is shadowed 128 times in the following regions, that means VIA registers are mapped from $d000 to $d800.</p>

<p>For general 6522 description see elsewhere, here I will only collect vectrex relevant stuff.</p>
<h2>Registers</h2>
<h3>Register $0 VIA Port B Input/Output</h3>
<h4>Bit 0 MUX Enable</h4>

<p>This bit is responsible for enabling the multiplexer which selects where the Sample/Hold values the DAC at this time "produces" are switched to.</p>

<p>if set to 0 the multiplexer is ENABLED  if set to 1 the multiplexer is DISABLED </p>
<h4>Bit 1 and bit 2 Mux Select</h4>

<p>These two bits are used together to build a 2 bit value. This two bit value ranges from 0 to 3. According to the resulting number, the multiplexer switches the output of the DAC to the respective recieving hardware:<br />
0 (binary: 00) Integrator for vector y-position<br />
1 (binary: 01) X, Y integrator offset values<br />
2 (binary: 10) Z-value of vector hardware (brightness)<br />
3 (binary: 11) audio hardware<br />
</p>

<p>Note:<br />
The only known use of state 3 is the playing of samples, since this is a direct connection of the DAC value to the audio hardware... "Eek", "Help", "Spike"...</p>

<p>Note:<br />
The same select lines are used to demultiplex the joystick analog potentiometers:<br />
0 (binary: 00) port 0 horizontal<br />
1 (binary: 01) port 0 vertical<br />
2 (binary: 01) port 1 horizontal<br />
3 (binary: 11) port 1 vertical<br />
 <br />
For more information regarding joystick input, see Joyport devices.</p>
<h4>Bit 3 sound BC1  + Bit 4 sound BDIR</h4>

<p>The above two bits are again "bundled" to 4 different possible states of communication with the PSG chip:</p>

<ol><li>
<p>0 (binary: 00) PSG Inactive<br />
The PSG/CPU bus is inactive DA7--DA0                             are in high impedance state.</p>
</li><li>
<p>1 (binary: 01) Read from PSG<br />
This signal causes the contents                             of the register which is currently addressed to                             appear on the PSG/CPU bus. DA7--DA0 are in the                             output mode.</p>
</li><li>
<p>2 (binary: 10) Write to PSG<br />
This signal indicates that the bus                             contains register data which should be latched into                             the currently addressed register. DA7--DA0 are in                             the input mode.</p>
</li><li>
<p>3 (binary: 11) Latch address<br />
This signal indicates that the bus                             contains a register address which should be latched                             in the PSG. DA7--DA0 are in input mode.</p>
</li></ol>

<p>Communication to any devices connected to the joyport is done via PSG. See ALSO Joyport devices for more information about accessing PSG chip.</p>
<h4>Bit 5 comparator input</h4>

<p>See Joyport devices ...</p>
<h4>Bit 6 external device (slot pin 35) initialized to input</h4>

<p>Communication with cartridge, &rarr; Bankswitching, RAM, eEprom etc</p>
<h4>Bit 7 /RAMP</h4>

<p>The ramp bit controls the activity of the integrators. If RAMP is zero, the integrators are active. If RAMP is one the integrators are not active. Depending on the settings of the VIA auxiliary register this bit can be set by accessing bit 7 of port B - or is controlled by Timer T1.</p>
<h3>Register $01 VIA Port A Input/Output</h3>

<p>For vectrex purposes via port A is: 
<ol><li>
<p>simply the digital register that serves as input to the Digital to Analog Converter (DAC).</p>
</li><li>
<p>if BC1 and BDIR are configured - the port that sends (receives from) data to the PSG</p>
</li></ol>
</p>
<h3>Register $02 DDRB (Data Direction Register port B)</h3>

<p>Port B can be used as an output register (referred to as ORB) or as an input register (referred to as IRB). The configuration for input and output can be set for each bit of the port. Usually all bits except bit 5 and 6 are configured as output. Bit 5 and 6 are configured as input.</p>

<p>Bit 6 is connected to the "external line" of the cartridge interface of the vectrex. Because of this bit 6 can be used to "communicate" with hardware "inside" cartridges. </p>

<p>Many multicards and other hardware use bit 6 for this purpose (see bankswitching). </p>

<p>The "tricky" thing with vectrex is, if PB6 is configured as input, bit 6 goes automatically high. If set to output it goes to low automatically. Even if in output mode and a "ONE" is written to pb6, it only goes high for a short period of time and than switches back to low automatically.   </p>
<h3>Register $0a SHIFTREG</h3>

<p>In vectrex terms the shiftreg is one of the most important registers of VIA, since it can control the CB2 (~BLANK) line. The shift modes can be set with Reg $0b and are described there. Each time a shift "outputs" a bit that bit is placed into the CB2 line. Shifting out a 0 enables blank (light is switched off), each time a 1 is shifted out blank is disabled (light is switched on). The shift direction is: most significant bit first, the bit 7 is rotated back to position 0. </p>

<ul><li>
<p>Shifting is done each 2 two processor cycles (shift out at system clock). </p>
</li><li>
<p>A complete Shift cycle takes 18 cycles, the last shifted value is held for an additional 2 cycles.</p>
</li><li>
<p>If a shift cycle is interrupted (a new shift initiated) VIA can stall (current shifted out value is held, no further shifting occurs). The time at which a stalling occurs appears to be dependend on the VIA generation. Known values (cycle counts) are 14 cycles and 15 cycles.</p>
</li><li>
<p>Attention: <br />
 The 6809 instruction CLR also READS the value befor it clears it, thus an instruction<br />
<tt> CLR &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shiftreg</tt><br />
 reads the shift register after 4 cycles and writes the shift register after an additional 2 cycles.</p>
</li><li>
<p>a shift is started by reading and by writing to the shiftreg</p>
</li></ul>

<p><b>Note:</b><br />
Why 18 cycles and 9 shifts?<br />
This is because (most) VIA ships (all vectrex used ships to my knowledge) have a bug.<br />
<br />
<i>When shifting using Phi2 (System clock) [Mode 110, see below], VIA outputs 9 shift pulses, the last shifted value is repeated.</i></p>

<p>[See: Synertek sy6522 Applications Information AN5 March 1982]</p>
<h3>Register $b VIA Auxiliary control register</h3>

<p>With the auxilary control register the behaviors of the timers and the shift register can be configured (also latching for ORA and ORB, but I am not aware that this makes any sense for vectrex).</p>

<p><tt> +---+---+---+---+---+---+---+---+<br />
| 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |<br />
+---+---+---+---+---+---+---+---+<br />
|___T1__|T2_|___SHIFT___|PB_|PA_|                   </tt></p>

<p>SHIFT Mode is contolled by bit 2-4 with these 3 bits 8 SHIFT mode can be configured<br />
The first mode is DISABLE. The next 3 modes are SHIFT IN modes, which is not used by vectrex.</p>

<p>The other four modes:
<ul><li>
<p>100 SHIFT out free running at T2 rate</p>
</li><li>
<p>101 SHIFT out under control of T2</p>
</li><li>
<p>110 SHIFT out under control of system clock</p>
</li><li>
<p>111 SHIFT out under control of ext clock</p>
</li></ul>
</p>

<p>Usually shift mode is allways set to 110 - shift out under control of system clock.</p>

<p>Timer 1 modes (bit 7 and bit 6):
<ul><li>
<p>bit 7: 1x if set, on timer start ORB bit 7 goes LOW (RAMP = active), on timer stop, ORB bit 7 goes high (RAMP = not active)</p>
</li><li>
<p>10 One shot mode (timer runs till zero than stops)</p>
</li><li>
<p>11 continues mode (timer runs till zero than "reloads" latch and starts anew)</p>
</li><li>
<p>01  &amp; 00 same as above without ORB bit 7</p>
</li></ul>
</p>

<p>On normal vector draw bit 7 is usually set.<br />
On normal "raster" draw bit 7 is often not set.<br />
</p>

<p>So you may see:
<ul><li>
<p>$18: T1 OneSHotMode WITHOUT Ramp control, Shift out under System clock</p>
</li><li>
<p>$98: T1 OneSHotMode WITH Ramp control, Shift out under System clock</p>
</li></ul>
</p>
<h3>Register $c VIA control register</h3>

<p>VIA Control register "controls" the Control lines of via. Control lines are:<br />
CA1<br />
CA2<br />
CB1<br />
CB2<br />
</p>

<p>All control lines act as interrupt inputs or as handshake Outputs.</p>

<p><tt> +---+---+---+---+---+---+---+---+<br />
| 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |<br />
+---+---+---+---+---+---+---+---+<br />
|____CB2____|CB1|____CA2____|CA1|</tt></p>

<p>For vectrex anlog parts (and for now) the lines CA2 (ZERO) and CB2 (BLANK) are <i>most</i> interesting.</p>

<p>CA1<br />
The CA1 line is connected to the second joystickport of the vectrex, more specific to button4. For joystick activity the controlline is not used. However, the lightpen device and the 3d Imager make use of that control line!<br />
The lightpen for example "triggers" CA1 when it sees some "light" :-). Bit 0 controls the interrupt behaviour of the CA1 line. Usually the bit is (left ) to 0. If this bit is a logic 0, the CAl interrupt flag will be set by a negative transition (high to low) of the signal on the CAl pin. If bit 0 is a logic 1, the CAl interrupt flag will be set by a positive transition (low to high) of this signal. The Imager 3d (at least in Narrow Escape), sets this bit to 1 to receive the "signal" from the index hole.</p>

<p>CA2 - ZERO<br />
Responsible bits are bit 1-3: 
<ul><li>
<p>110 = LOW output (translated to vectrex analog - ZERO is enabled)</p>
</li><li>
<p>111 = HIGH output (translated to vectrex analog - ZERO is diaabled)</p>
</li></ul>
</p>

<p>CB2 - BLANK<br />
Responsible bits are bit 5-7: 
<ul><li>
<p>110 = LOW output (translated to vectrex analog - BLANK is enabled)</p>
</li><li>
<p>111 = HIGH output (translated to vectrex analog - BLANK is diaabled) Although blank is "usually" controlled by the shift register (output)!</p>
</li></ul>
</p>

<p>Together in vectrex terms:<br />
(assuming bit 0 and 5 (interrupt controls for CA1 and CB1) are zero)
<ul><li>
<p>%110x110x = $cc means ZERO enabled, and BLANK enabled</p>
</li><li>
<p>%111x110x = $ec means ZERO enabled, and BLANK disabled</p>
</li><li>
<p>%111x111x = $ee means ZERO disabled, and BLANK disabled</p>
</li><li>
<p>%110x111x = $ce means ZERO disabled, and BLANK enabled</p>
</li></ul>
</p>

<p><b>Note:</b><br />
The manual appliance to the BLANK singnal with the control register only has any effect if SHIFT is switched to OFF. </p>
<h3>Via Interrupt Flag Reg $d</h3>

<p>Write one to a bit resets the interrupt flag.</p>

<ul><li>
<p>0x01 : bit 0 CA2 interrupt (cleared by read/write port A depeneding on "independed" interrupt)</p>
</li><li>
<p>0x02 : bit 1 CA1 interrupt (edge is determined by PCR bit 0, cleared by read/write of Port A)</p>
</li><li>
<p>0x04 : bit 2 Shiftreg interrupt (complete 8 shifts)</p>
</li><li>
<p>0x08 : bit 3 CB2 interrupt</p>
</li><li>
<p>0x10 : bit 4 CB1 interrupt</p>
</li><li>
<p>0x20 : bit 5 Timer2 interrupt </p>
</li><li>
<p>0x40 : bit 6 Timer1 interrupt</p>
</li><li>
<p>0x80 : bit 7 indicates whether ANY interrupt happened</p>
</li></ul>
<h3>Via Interrupt enable Reg $e</h3>

<p>if bit 7 is 1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 interrupt disabled<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 interrupt enabled<br />
<br />
if bit 7 is 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 interrupt disabled<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 interrupt enabled<br />
</p>

<ul><li>
<p>0x01 : bit 0 CA2 interrupt</p>
</li><li>
<p>0x02 : bit 1 CA1 interrupt</p>
</li><li>
<p>0x04 : bit 2 Shiftreg interrupt</p>
</li><li>
<p>0x08 : bit 3 CB2 interrupt</p>
</li><li>
<p>0x10 : bit 4 CB1 interrupt</p>
</li><li>
<p>0x20 : bit 5 Timer2 interrupt</p>
</li><li>
<p>0x40 : bit 6 Timer1 interrupt</p>
</li><li>
<p>0x80 : bit 7 indicates whether ANY interrupt happened</p>
</li></ul>
<h2>Timers</h2>

<p>VIA has two timers, both are "used" by the vectrex.  How these timer exactly operate &rarr; see Manual of VIA.</p>

<p>Timer operations are controlled by the AUXILIARY Control register ($b). The timer relevant bits are:<br />

<ul><li>
<p>Timer 1: bit 6-7</p>
</li><li>
<p>Timer 2: bit 5</p>
</li></ul>
</p>

<p>The "usual" setting for the timers is:
<ul><li>
<p>Timer 1: 10 (One Shot Mode, Timed interrupt each time T1 is loaded)</p>
</li><li>
<p>Timer 2:  0 (Timed interrupt)</p>
</li></ul>
</p>
<h3>Timer 1</h3>

<p>Timer 1 is usally used to move the beam across the vectrex screen. Both for just "moving" and "drawing" (only difference is, whether the light of the beam is switched on or off).</p>

<p>For this the timer 1 is configured to the so called "one Shot Mode" ("timing stops after the coundown finished). <br />
Note:<br />
Timer starts when something is written to the high byte. So you usually see something like "clr t1h", when timing starts.</p>

<p>Using Timer 1 in one shot mode has one neat effect, the 7 bit of VIA ORB is "automatically" set to LOW when the timer starts (clr t1h), and "automatically" set to "HIGH" when the timer is finished. Bit 7 of ORB is the analog equivalent to RAMP. Setting PB7 to low means enabling RAMP, and setting it to high means disabling RAMP.</p>

<p>Using Timer 1 in combination with its ability to directly "control" the analog integrators makes it just about "perfect" to draw vectors for vectrex!</p>

<p>In vectrex Timer 1 (low value) is usually reffered to as "the scale" of a vector.  </p>
<h3>Timer 2</h3>

<p>Is used to track "system" time, and wait for 50Hz to be reached and than to do a recalibration (30.000 cycles). This value can be set to vectrex ram: </p>
<hr />
<h1>Glossar/Hardware</h1>
<h3>DAC Digital Analog Converter<br />
</h3>

<p>Converts 8 bit digital input values (-128 to +127) to analog "voltages" ranging from -5 volt to +5 volt.
<ul><li>
<p>Vector Hardware</p>
</li><li>
<p>Sound</p>
</li><li>
<p>Joystick</p>
</li></ul>
</p>

<p>Vectrex used the Chip: MC1408</p>
<h3>Integrators<br />
</h3>

<p>Integrates (summarizes) voltages which are at its input pins over time and gives a "summarized" output voltage.  Vectrex used the Chip: IC LF347</p>
<h3>Multiplexer</h3>

<p>Vectrex has only one DAC chip, but several "client" chips that use analog values which must be "translated" from digital to analog. In order to serve all clients and only using one DAC the inventors of Vectrex designed the circuit such, that the DAC output can be switched to different clients. The Multiplexer depending on its select lines transfers the (one) DAC value to one of the four output lines:
<ul><li>
<p>00: Integrator for vector y-position</p>
</li><li>
<p>01: X, Y integrator offset values</p>
</li><li>
<p>10: Z-value of vector hardware (brightness)</p>
</li><li>
<p>11: audio hardware</p>
</li></ul>
</p>

<p>If you are wondering where Integrators for vector x-position get there values, there is a trivial answer - x Integrators ALWAY receive the DAC value!</p>

<p>Vectrex used the Chip:  CD4052b</p>

<p>The chip also supports DeMultiplexing, this is chosing 1 of four input lines to output to one specific line. The select lines are the same as for the multiplexing.</p>

<p>Withing vectrex this is used to select one of the four analog joytick potientiometers to access the comparator logic cicuit.
<ul><li>
<p>00: port 0 horizontal</p>
</li><li>
<p>01: port 0 vertical</p>
</li><li>
<p>10: port 1 horizontal</p>
</li><li>
<p>11: port 1 vertical</p>
</li></ul>
</p>
<h3>Sample and and Hold<br />
</h3>

<p>For y-integration and Brightness<br />
Vectrex used the Chip:   IC LF347<br />
</p>
<h3>Analog switches </h3>

<p>- "in front" of the integrators<br />
Vectrex used the Chip:   4066B</p>
<hr />
<h1>Analog </h1>
<br/><p align="center">
<img src="pics/vec_art_scheme.png" width="960" height="360" /><br/>
<em>basic scheme</em></p><br/>

<p>(picture stolen from: <a target="_blank" href="http://enlight.ru/post/9479/">http://enlight.ru/post/9479/</a>)</p>

<p>For a <i>very</i> general idea of the vectrex hardware, look at the diagram.</p>

<p>I will try to describe the diagram with my own words, perhaps it will help :-).</p>

<p>What do you want Vectrex to do?</p>

<p>YES, draw Vectors, that is what this is all about. To draw something you need something to draw upon, back in the 80ies screens to draw upon were large, heavy and were powered with huge voltages. The underlying principal was called Cathode Ray Tube, or short CRT, thats what is on the utter left of the diagram. Your vectrex "monitor".</p>

<p>To draw a vector you basically shoot some electrons at a phosphor coated piece of glass, the phosphor begins to glow and you recognise that as a bright spot on the outside. To draw just one point is sort of boring, thats why people wanted to "move" the spot. Luckily electrons happen to interact to magnetism. And luckily technology enables us to "control" magnetism. We don't need a man standing beside the screen and juggling with little magnets to deflect the electron beam :-)!</p>

<p>If you have a copper wire, and some current running thru it, you also have a magnetic field around the wire. With some mathematical background you can calculate the magnetism and build nice things, like transformers, wireless iphone rechargers, induction cookers etc - all the same principal. But lucky for us also deflection coils for CRTs... ehm, I am drifting away...</p>

<p>Where was I? With  the help of deflection coils you can change the path the electrons take and so move the bright spot on the screen any way you like.</p>

<p>If you move the spot from left to right switched "on" than from right to left switched off, this 625 times with a tiny bit down every line, you are pretty near the PAL television norm, at least if you do that 25 times in one second.</p>

<p>Vectrex can't draw 625 "fullscreen" lines 25 times a second. It's no TV. </p>

<p>Anyway, going back to vectrex, and what it CAN actualy do.</p>

<p>Vectrex has more or less DIRECT controll over the beam. In the diagram you can see three lines connected to the CRT: X, Y and Z. </p>

<p>X - is the X position of the spot Y - is the Y position of the spot Z - is the brightness of the spot </p>

<p>These input lines to the CRT are ANALOG voltages. </p>

<p>How do we get from our digital world to analog values for the positioning of the spot on the CRT?</p>

<p>Ok</p>

<p>Lets go to the other side of the diagram.</p>

<p>The Microprocessor of the vectrex does not communicate directly with any analog part. It uses the VIA 6552 to comunicate with all periphals.</p>

<p>The CPU only knows 16 registers of VIA and pokes and peeks to/from them to achieve control over the beam.</p>

<p>The relevant VIA parts and its analog pendants are:<br />
</p>

<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CA2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- ZERO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CB2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- BLANK<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bit 7 of ORB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- RAMP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bit 0 of ORB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- mux enable<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bit 1-2 of ORB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- mux select<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- input to DAC<br />
</p>

<p>This is a wild mixture of "things" Via has to offer!<br />
CA and CB are "Control Lines" there are 2 control lines each for "A" and "B". The control lines can generate interrupts, can be used as input or output and "B" can be "driven" by timers. The behaviour of these control lines is internally controlled by register $c [Control Register].</p>

<p>The bits of the ORB can theoreticall be both input and output, the above bits are ONLY used as output! Bit 7 is "special" in the way, that output can also be "controlled" by the timer 1 of VIA.</p>

<p>ORA is used as "direct" input to the DAC.</p>

<p>No matter how these signals are generated internally by VIA the following for the analog section of vectrex is the result:</p>

<p><b>CA2 - ZERO</b><br />
If CA2 is 0 than the "ZERO" signal is active! If CA2 is 1 than the "ZERO" signal is NOT active!</p>

<p><b>CB2 - BLANK</b><br />
If CB2 is 0 than the "BLANK" signal is active! If CB2 is 1 than the "BLANK" signal is NOT active!</p>

<p><b>bit 7 of ORB - RAMP</b><br />
If bit7 is 0 than the "RAMP" signal is active! If bit7 is 1 than the "RAMP" signal is NOT active!</p>

<p><b>bit 0 of ORB - mux enable</b><br />
If bit0 is 0 than the mux is enabled! If bit0 is 1 than the mux is NOT enabled!</p>

<p><b>bit 1-2 of ORB - mux select</b><br />
If mux is enabled, this two bit number selects the DAC output.</p>

<p><b>ORA - DAC Value</b><br />
The DAC input is THAT value.</p>
<h2>What does that mean?</h2>
<h3>ZERO</h3>

<p>In short zero means "ground", if you look at the diagram the zero line is connected to both integrators. If ZERO is active, than the integrators are grounded, and no matter what values are present there is no integration ongoing. If an integration happend befor, values are resetted! If zero is active and you as a programmer try to draw something - all you will see is a bright spot in the middle of the screen - the point zero!</p>

<p>ZERO ing the integrators takes time. Measures at my vectrex show e.g.: If you move the beam with a to x = -127 and y = -127 at diffferent scale values, the time to reach zero:
<ul><li>
<p>scale $ff &rarr; zero 110 cycles</p>
</li><li>
<p>scale $7f &rarr; zero 75 cycles</p>
</li><li>
<p>scale $40 &rarr; zero 57 cycles</p>
</li><li>
<p>scale $20 &rarr; zero 53 cycles</p>
</li></ul>
</p>

<p>After these I stopped my (tedious) measurements.</p>

<p>Just remember, not to draw vectors to early after doing a ZERO.</p>
<h3>BLANK</h3>

<p>The same thing as ZERO only this time for the brightness of the beam, not the position. If BLANK is active, the beam is switched off, no matter what other brightness you might have set befor.</p>
<h3>RAMP</h3>

<p>The RAMP signal enables or disables integration. In the diagramm the RAMP line is connected to "switches" befor the integrators. If RAMP is active, the switch is in ON position and integration happens. If not, NO integration is possible. But the integrators "hold" their values (well for a little time anyway). It is not possible to switch only one of the integrators on or off, you do allways set RAMP for both! If you don't want to integrate the other one, set the "integration value" to 0.</p>
<h3>mux enable</h3>

<p>As seen in the diagram, the output of the DAC goes as input into the MUX. If mux is enabled, than the DAC (analog) value is sent to its destination (given by mux select). If mux is disabled, NO output is done to any of the mux lines. (BUT: as you can see the output of the DAC goes directly to the X-Integrator input (switch). Regardless of the MUX, x-integrator ALWAYS recieves the current DAC output!)</p>
<h3>mux select</h3>

<p>These two bits are used together to build a 2 bit value. This two bit value ranges from 0 to 3. According to the resulting number, the multiplexer switches the output of the DAC to the respective recieving hardware:<br />
0 (binary: 00) Integrator for vector y-position<br />
1 (binary: 01) X, Y integrator offset values<br />
2 (binary: 10) Z-value of vector hardware (brightness)<br />
3 (binary: 11) audio hardware<br />
</p>

<p>Not discerable on the diagram is, that for the line 0 and line 2 (y-Integration and Brightness) the values that are set are hold till set to another value. Responsible for holding are the op-amps of type IC LF347(s).For setting a value one can also say, that the current DAC value is a (short) "sample", and these sample values are on hold till new samples arrive. In many documentations you may find "sample and hold" values.  The values that are set to the above four different destinations are those "sample and hold" values.</p>
<h3>DAC Value</h3>

<p>The DAC translates a 8bit input (-128 - +127) to an analog voltage ranging from -5 volt to +5 volt to its output</p>
<h2>Putting it all together</h2>

<p>If you want to draw a vector there are some items you allways have:
<ol><li>
<p>start position e.g. 10, -10</p>
</li><li>
<p>end position e.g. 20, -20</p>
</li><li>
<p>brightness e.g. 50</p>
</li></ol>
</p>

<p>If you want the analog hardware to draw a vector you must give it these values in a form that it can understand.</p>

<p>There are some things to assume befor we start drawing.
<ul><li>
<p>BLANK is ENABLED</p>
</li><li>
<p>ZERO is ENABLED</p>
</li><li>
<p>RAMP is DISABLED</p>
</li><li>
<p>MUX is DISABLED</p>
</li></ul>
</p>

<p>This is the "standard" beginning of a draw procedure. In terms of analog hardware the following must be done:
<ol><li>
<p>set brightness
<ul><li>
<p>DAC = 50 (brightness value to DAC)</p>
</li><li>
<p>mux sel = 10 (select brightness output in mux)</p>
</li><li>
<p>mux enable</p>
</li><li>
<p>mux disable<br />
[note: blank is still enabled!]<br />
[This short "mux enable/disable" is "enough" so that the brightness is set to 50. The "storage" position (sample/hold) for brightness is nowhere to be found in the diagram]</p>
</li></ul>
</p>
</li><li>
<p>move to 10, -10
<ul><li>
<p>DAC = -10 (y coordinate)</p>
</li><li>
<p>mux sel = 00 (y integrator)</p>
</li><li>
<p>mux enable</p>
</li><li>
<p>mux disable<br />
now y integration value is set to -10 [one could say (regarding the diagram) that the y-integration value is stored by the "y-switch" (- again sample/hold)]</p>
</li><li>
<p>DAC = 10 (this sets X-intgeration value to 10)</p>
</li><li>
<p>ZERO = 1 (ZERO not active!)</p>
</li><li>
<p>RAMP = 0 (enable RAMP, integrators are working)</p>
</li><li>
<p>wait for a defined time (in real life this is the scale factor)</p>
</li><li>
<p>RAMP = 1 (disable RAMP, integrators are not working)<br />
[now we are at position 10, -10]</p>
</li></ul>
</p>
</li><li>
<p>draw vector to 20, -20 <br />
The drawing of a vector is usually relative, so here we are not using 20, -20 but the difference (offset) to our "current" position, which is exactly 10, -10 again, so we can reuse the values for the integrators we already set above! 
<ul><li>
<p>BLANK = 1 (disable BLANK, the phosphor is shining!)</p>
</li><li>
<p>RAMP = 0 (enable RAMP, integrators are working)</p>
</li><li>
<p>wait for a defined time (in real life this is the scale factor)</p>
</li><li>
<p>RAMP = 1 (disable RAMP, integrators are not working)<br />
</p>
</li><li>
<p>BLANK = 0 (enable BLANK, beam is switched off)<br />
[now we are at position 20, -20, and have just drawn a vector]</p>
</li></ul>
</p>
</li></ol>
</p>

<p>The actual assembler code looks a little bit more complicated, since the analog "objects" can not be set directly. The BLANK is usually set "through" the SHIFT register of VIA, which in turn is set up by the auxiliary control register. The RAMP is (often) controlled by the timer, which in term is controlled by the control register ...</p>
<hr />
<h1>Clean Sweep</h1>
<br/><p align="center">
<img src="pics/sweep.png" width="878" height="1079" /><br/>
<em>Sweep</em></p><br/>

<p>Why do emulators hate Clean Sweep?</p>

<p>Because it brings vectrex to do something that we don't understand, which is not (yet) calculable.</p>

<p>Let me tell you how cleansweep draws its maze, look at the picture. <br />
(Red colors)<br />

<ol><li>
<p> First it draws the two vertical outer maze walls (top down)</p>
</li><li>
<p>Then it draws 13 "inner" vertical "stripes", these are generated to RAM locations, since they contain the eatable dots in the maze (top down)</p>
</li><li>
<p>Then it draws the 8 horizontal maze walls. Wall 7 (counting from top to bottom) is also a RAM vector, since it includes the shutable doors (pink)</p>
</li></ol>
</p>

<p>Clean sweep uses an "own" drawing routine for the maze. All above vectors use this routine. For convenience let us call this routine: "<b>DrawMazeVector</b>"<br />
</p>

<p>So that we know that we talk about, let us assume the following is a correct disassembly of that routine.</p>

<div class="code">
<p>; In $c8C9 length of vector Data<br />
; in D position to move to<br />
; resets to Zero after work<br />
; In X Pointer to Vector Data (Shift Update data)<br />
<br />
DrawMazeVector: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;port&nbsp;A&nbsp;data&nbsp;IO&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; DAC = a = y pos<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;port&nbsp;B&nbsp;data&nbsp;IO&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; mux enable <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$CE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; disable zero (periphal control reigster, set lover nibble to $e, bit 0 doesnt matter) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;control&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; VIA Control register <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;shift&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; clear shift register (blank line) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmpx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[d,x]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; wait (13 cycles) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;port&nbsp;B&nbsp;data&nbsp;IO&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; disable mux <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmpx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[d,x]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; wait (13 cycles) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;port&nbsp;A&nbsp;data&nbsp;IO&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; DAC = b = x pos <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tfr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x,x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; wait (6 cycles) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;timer&nbsp;1&nbsp;count&nbsp;reg&nbsp;hi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Clear Timer 1H (start timer)[low = $80], this also enables RAMP <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; lade interrupt flag bit 6 (timer1) <br />
&nbsp;0039: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bita&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;interrupt&nbsp;flags&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; interrupt flag time 1 gesetzt? <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0039&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; No, wait till it is set <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jsr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    &gt;Delay&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Wait more (20 cycles), after timer finished, RAMP is disabled! <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;drawMazeVectorSpeedYX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; load next vector to draw <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;port&nbsp;A&nbsp;data&nbsp;IO&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; put y value to DAC <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; keep RAMP off and enable mux <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;port&nbsp;B&nbsp;data&nbsp;IO&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; to ORB <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmpx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[d,x]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; wait (13 cycles) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$81&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; keep RAMP off and disable mux <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;port&nbsp;B&nbsp;data&nbsp;IO&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; to ORB <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;port&nbsp;A&nbsp;data&nbsp;IO&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; put x value to DAC <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; T1 in interrupt mode, SHIFT as usual, this means, contol of RAMP lies not within TIMER 1! <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;auxiliary&nbsp;control&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; to auxiliary control <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; manually enable RAMP (mux disabled) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;port&nbsp;B&nbsp;data&nbsp;IO&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [4]to orb <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [2]delay 2 cycles <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [2]delay 2 cycles <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;mazeVectorSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [5]load size y of maze (y-$13, x-$0f) <br />
&nbsp;005E: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,x+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [6]load maze byte <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;shift&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [4]put that in Shift reg to "configure "Blank" <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [2]delay 2 cycles <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [2]delay 2 cycles <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [2]configure next byte load <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;005E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [3]if not done, go fetch next <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$81&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [2]manually disable RAMP (mux disabled) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;port&nbsp;B&nbsp;data&nbsp;IO&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [4]to orb <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$98&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Restore OneShot mode of T1 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA&nbsp;auxiliary&nbsp;control&nbsp;reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; to auxiliary control <br />
Reset0Delay12: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jsr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;Reset0Ref&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Go to zero <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jsr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   &gt;Delay&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Delay 12 Cycles <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rts    <br />
  </p>
</div>

<p>In short terms:
<ul><li>
<p>the routine first moves to a start point, the start point is always one of:
<ul><li>
<p>topmost position of the maze</p>
</li><li>
<p>leftmost position of the maze (seen from the maze point of view)</p>
</li></ul>
</p>
</li><li>
<p>the positioning is done "old school" and very "moveto_d" alike. It uses some more delays, but thats fine</p>
</li><li>
<p>it than sets T1 to "interrupt" mode, which basically means, it disables the T1 control of ORB bit 7 (RAMP) and for its vector drawing it enables and disables RAMP "manually"</p>
</li><li>
<p>it gets from its input values the "length" of the vector and a pointer to a vector list</p>
</li><li>
<p>the vector list does not consist coordinates, its a number (= length of list) of shift register values</p>
</li><li>
<p>this means, the maze is more something like a really wide spread "raster" image</p>
</li><li>
<p>the raster image has a size of "$0f * $13" (x * y)</p>
</li><li>
<p>after each of these "rasterlines" is drawn the routine is finished and leaves with a Reset0</p>
</li><li>
<p>the raster is "blown" up, each shiftregister entry is an 8bit value, but the complete drawing of one shift register takes 19 cycles. That means the shift register is only used for the first 16 of these 19 cycles, and keeps "drawing" with the last bit of that shift reg value till it is "reloaded"!</p>
</li></ul>
</p>

<p><b>So, where is the problem?</b></p>

<p>Part 1<br />
The problem seems to be, that RAMP is not controlled by the timer, but manually!<br />
When RAMP gets "activated" the shift register has a value of zero, nothing is drawn, but the integrators do already integrate. Befor the first shift-register value is used, the RAMP is already integrating for 19 cycles. (when you look at the picture, the pretty "blue" lines mark the starting point of the RAMP (well approximately).</p>

<p>Part 2<br />
You have horizontal and vertical vectors and you want to start the maze at a "corner" not at a "crossing".  Obviously while drawing vertical lines x-integration is 0 (zero) and y-integration is summing up, horizontal lines the opposite. <br />
The developers now had an efficient drawing routine for an huge raster-image-maze-thingy, but with the problem, that after positioning correctly, the vectrex "beam" began to move befor drawing. At one time it began beforhand to move vertically, the other time it began to move horizontally. And they somehow hat to start those lines "somewhere" that the overhead would compensate itself.</p>

<p>The solution the developes came up with is two fold. Not only did they use an "overhead" for the starting position, they also used different scale factors for positioning!</p>

<p><i>* OUTER VERTICAL Maze is positioned with scale $80, speed $56 </i><br />
<i>* INNER HORIZONTAL Maze is positioned with scale $78, speed $69 </i></p>

<p>My guess is, they used trial and error on a vectrex and just happened to use values where those lines DO match. I wouldn't have a clue how they would have calculated the difference. </p>

<p><b>Still, why is that a problem? Why doesn't the emulators do that right?</b><br />
Because, the analog hardware is just that - analog!<br />
At least I do not have enough data to figure out how that analog hardware reacts in all different circumstances.</p>

<ul><li>
<p>maybe, the RAMP signal is delayed when switched on?</p>
</li><li>
<p>maybe, the RAMP signal is delayed when switched off?</p>
</li><li>
<p>or both, or with different timing values?</p>
</li><li>
<p>maybe integrators need a timing parameter befor they can integrate again?</p>
</li><li>
<p>maybe such a timing is different for the degree (or sign) of voltage they receive?   (the orginal disassembly of the the ROM suggests something like that (see MoveTo_D)?</p>
</li><li>
<p>maybe, the "drift" of the integrators is relevant?</p>
</li><li>
<p>maybe the drift of integrators gets greater the higher the absolut value they have already stored?</p>
</li></ul>

<p> <b>What is the solution?</b><br />
Timing!<br />
Defenitive it is a timing issue.<br />
 The only thing is WHAT to time HOW and WHEN.</p>

<p>I have been able to counter EVERY single faulty behavior I encountered in the emulator by "fiddling" with timing parameters. The only thing is I have not found the "one" that is a solution to all issues.</p>

<p>And I hate to check the CRC of a ROM and switch to the solution for that specific ROM, that seems pretty "lame".</p>
<h2>Some number crunching</h2>

<p>The emulator and vectrex are in x-position exactly 873 vectrex pixels off!<br />
(on the left side, on the right side double that value)</p>

<p>Vectrex pixel:<br />
I define the maximum resolution of vectrex with 32767 in every direction. I am aware that the lines drawn by ranges above (about) 20000 are way out of bounds. But for easy "math" lets assume it is a 8 bit machine. Than a maximum scale of $ff and a maximum speed of -128 ($80) or +127 ($7f) gives us about the above vector ranges and a base to calculate with. (And yes - I am aware that scale can theoretically go up google... since it is time)</p>

<p>How do I arrive at that number?<br />
Vertical vector X start:<br />
The positioning of the left outer vertical wall gives us number one. It is positioned with a scale of $80 and a speed of $56, that multiplied gives us: <b>11008</b> (decimal)<br />
<br />
</p>

<p>Horizontal vector X start:<br />
Here it gets tricky. Following steps are needed for calculation:
<ul><li>
<p>positioning of horizontal vector: scale of $78 speed $69: 12600 (decimal)</p>
</li><li>
<p>speed of x vector is $AB, which is in decimal -85</p>
</li><li>
<p>after the RAMP is switched on, exactly 19 cycles are used by the vector drawing routines, befor a value is written to the SHIFT register of VIA and shifting starts</p>
</li><li>
<p>the first value that is put into SHIFT register is $07 (binary: 0000 0111)</p>
</li><li>
<p>this means after 5 shift operations BLANK is the first time disabled</p>
</li><li>
<p>this means from start RAMP to first BLANK disabled 29 cycles have passed</p>
</li><li>
<p>-85 * 29 = -2465</p>
</li><li>
<p>this added to our starting position: 12600 - 2465= <b>10135</b></p>
</li></ul>
</p>

<p>Thus the difference in our X-starting position is 11008 - 10135 = <b>873</b>.</p>

<p>On the REAL vectrex this difference mysteriously is not existant due to analog "differences".</p>
<hr />
<h1>Print_Str</h1>

<p>In the disassembly from Bruce Tomlin there are many "garbled" comments (Ramp on/off switched, T1 one shot enabled disabled...)</p>

<p>Here a corrected version: </p>

<p><tt> ;-----------------------------------------------------------------------<br />
;       F495    Print_Str                                               <br />
;                                                                       <br />
; This is the routine which does the actual printing of a string. The  <br />
; U register points to the start of the string, while $C82A contains    <br />
; the height of the character, cell, and $C82B contains the width of    <br />
; the character cell. The string is terminated with an 0x80.           <br />
;                                                                       <br />
; The string is displayed by drawing 7 horizontal rows of dots. The    <br />
; first row is drawn for each character, then the second, etc. The     <br />
; character generation table is located at ($F9D4 + $20). Only         <br />
; characters 0x20-0x6F (upper case) are defined; the lower case         <br />
; characters a-o produce special icons.                                 <br />
;                                                                       <br />
; ENTRY DP = $D0                                                        <br />
;       U-reg points to the start of the string                         <br />
;                                                                       <br />
; EXIT: U-reg points to next byte after terminator                      <br />
;                                                                       <br />
;       D-reg, X-reg trashed                                            <br />
;-----------------------------------------------------------------------<br />
<br />
Print_Str:      <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vec_Str_Ptr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Save string pointer<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Char_Table-$20&nbsp;;Point to start of chargen bitmaps<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$1883&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;a&rarr;AUX: b&rarr;ORB: $8x = Disable RAMP, Disable Mux, mux sel = 01 (int offsets)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Clear D/A output<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_aux_cntl&nbsp;&nbsp;&nbsp;;Shift reg mode = 110 (shift out under system clock), T1 PB7 disabled, one shot mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Char_Table-$20&nbsp;;Point to start of chargen bitmaps<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; first entry here, ramp is disabled<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; if there was a jump from below<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; ramp will be enabled by next line<br />
LF4A5:          <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;ramp off/on set mux to channel 1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Enable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$8081&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;both to ORB, both disable ram, mux sel = 0 (y int), a:&rarr;enable mux: b:&rarr;disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Wait a moment<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Disable RAMP, set mux to channel 0, disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Enable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$C800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;I think this is a delay only<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vec_Text_Width&nbsp;&nbsp;;Get text width<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Send it to the D/A<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$0100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;both to ORB, both ENABLE RAMP, a:&rarr; disable mux, b:&rarr; enable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vec_Str_Ptr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Point to start of text string<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[4]enable RAMP, disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LF4CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[3]<br />
; one letter is drawn (one row that is) in 18 cycles<br />
; 13 cycles overhead<br />
; ramp is thus active for #ofLetters*18 + 13 cycles<br />
LF4C7:          <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A,X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[+5]Get bitmap from chargen table<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_shift_reg&nbsp;&nbsp;;[+4]rasterout of char bitmap "row" thru shift out in shift register<br />
LF4CB:          <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,U+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[+6]Get next character<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BPL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LF4C7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[+3]Go back if not terminator<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$81&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[2]disable mux, disable ramp <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[4]disable RAMP, disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Negate text width to D/A<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;enable ramp, disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;enable RAMP, disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CMPX&nbsp;&nbsp;&nbsp;&nbsp;#Char_Table_End-$20;[4]Check for last row<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEQ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LF50A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[3]Branch if last row<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAX&nbsp;&nbsp;&nbsp;&nbsp;$50,X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[3]Point to next chargen row<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TFR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U,D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[6]Get string length<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUBD&nbsp;&nbsp;&nbsp;&nbsp;Vec_Str_Ptr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[7] <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUBB&nbsp;&nbsp;&nbsp;&nbsp;#$02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[2] -  2 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASLB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[2] *  2 calculate return "way"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BRN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LF4EB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[3]Delay a moment<br />
LF4EB:          <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$81&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[2]disable RAMP, disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[2]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DECB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[2]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BNE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LF4EB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Delay some more in a loop<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;disable RAMP, disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vec_Text_Height&nbsp;;Get text height<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Store text height in D/A [go down &rarr; later]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Enable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$8101<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Wait a moment<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;disable RAMP, disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Clear D/A<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;enable RAMP, disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_port_b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;disable RAMP, disable mux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;$0x = ENABLE RAMP?<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LF4A5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Go back for next scan line<br />
<br />
LF50A:          <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#$98<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;VIA_aux_cntl&nbsp;&nbsp;&nbsp;;T1&rarr;PB7 enabled<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JMP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reset0Ref&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;Reset the zero reference<br />
<br />
</tt></p>
<hr />
<h1>Sound / PSG Chip</h1>

<p> </p>
<h2>Programming/accessing PSG</h2>

<p>See programming section... <br />
For  a glimpse look at Joysport devices, since they are accessed via PSG.</p>
<h2>Non programming stuff</h2>
<h2>Vectrex BIOS</h2>

<p>One "update" for the PSG is usualy done once in a typical vectrex game loop.</p>

<p>Thus the update is done every 1/50 seconds (more or less) since vectrex programs <i>try</i> do update with 50Hz. Each vectrex note can have a "length", the length is simply a counter of "update rounds" that the note stays the same.<br />
</p>

<p>While "staying the same" the below given changes are done to the "note", it is wrapped in a ADSR envelope and a vibrato is added.</p>

<p>The ADSR envelope can be at maximum 32 nibbles (vibrato only 8 changes). If the next note is played befor the ADSR is completely done (or the vibrato), than the next note will be played nonetheless and the counter for the ADSR and vibrato will reset. </p>

<p>This for example means, if notes are played with a speed of two, only the first two nibbles of the ADSR will be used for that note!</p>
<h3>ADSR</h3>

<p>(<b>A</b>ttack, <b>D</b>ecay, <b>S</b>ustain, <b>R</b>elease)</p>

<p>ADSR table = 32 nibbles<br />
Theoretically this could be set per channel! Than that would be one ADSR for each "instrument", but with the BIOS routine the one ADSR table is used thru all three channels</p>

<p>ADSR is a "software ADSR", the 4 bit values are written each PSG "update round" (optimally 50Hz) to the corresponding lower 4 bit of the amplitude control register of PSG (ModeBit is always 0).</p>
<h3>TWANG / Vibrato</h3>

<p>Can be negative  / positive and updates the base frequence of the note with the value (of the twang).<br />
</p>

<p>As with ADSR the twang table updates the value for the vibrato each PSG "update round".</p>

<p>The twang table consists of 8 TWANG/Vibrato bytes. Each channel has a different limit to its update count (see below).   It seems like TWANG entry 0 is not used [or only used as last in channel C, since that is the only one, that "rolls over" the 3 bit counter limit], since the routine increments the counter always <b>befor</b> it is used (and it starts at 0).  </p>

<p>RAM location: Vec_Music_Twang<br />
Is a 3 times Counter/Twang value storage in RAM like:<br />
<tt> Channel A: db TWANG&nbsp;COUNTER, CURRENT&nbsp;TWANG&nbsp;VALUE ; TWANG Counter limit 6<br />
Channel B: db TWANG&nbsp;COUNTER, CURRENT&nbsp;TWANG&nbsp;VALUE ; TWANG Counter limit 7<br />
Channel C: db TWANG&nbsp;COUNTER, CURRENT&nbsp;TWANG&nbsp;VALUE ; TWANG Counter limit 8<br />
</tt></p>

<p>Some links to more information for ADSR/TWANG:<br />
<a target="_blank" href="http://en.wikiaudio.org/ADSR_envelope">http://en.wikiaudio.org/ADSR_envelope</a><br />
<a target="_blank" href="http://www.audiosonica.com/en/course/post/15/Sound_theory_Envelope">http://www.audiosonica.com/en/course/post/15/Sound_theory_Envelope</a><br />
</p>

<p>PSG in general:<br />
<a target="_blank" href="http://f.rdw.se/AY-3-8910-datasheet.pdf">http://f.rdw.se/AY-3-8910-datasheet.pdf</a><br />
</p>
<hr />
<h1>Bankswitching</h1>

<ul><li>
<p>Bankswitching is handled in class Cartridge (triggered by emulation)</p>
</li><li>
<p>cartridge can hold an arbitrary number of banks</p>
</li><li>
<p>dissi memory is now loaded via cartridge (after vecxi has been initialized), that is new!</p>
</li><li>
<p>dissi adds itself to cartridge as a listener and reacts to bankswitched</p>
</li><li>
<p>the Memory (dissi/dasm) class has been updated to handle banks too, MemoryInformation is still held seperately from cartridge</p>
</li><li>
<p>in Memory ALL memory data is switched upon a bankswitch, even ROM data</p>
</li><li>
<p>that enables us e.g. to have different label names systemwide (mainly interesting for ram locations)</p>
</li><li>
<p>breakpoints have now a field "bank" and should be banks considered, meaning setting a breakpoint for address 1000 on bank 0 should not trigger a breakpoint at address 1000 while in bank 1 (not tested)</p>
</li><li>
<p>development wise I must still consider the options of building seperate bin files and concat, or in one go or or or</p>
</li><li>
<p>done: generate dissi: dasm output</p>
</li><li>
<p>done: generate dissi: CNT out</p>
</li><li>
<p>not done: reading lst, cnt for banks &gt;0</p>
</li><li>
<p>not done: actually compiling without manual interference of multi banks</p>
</li><li>
<p>done: consequently building information for different banks</p>
</li></ul>
<hr />
<h1>Joyport Devices</h1>
<h2>Part one - Buttons!</h2>

<p>Below I mainly explain how to use buttons to "transport" data to a device connected to the joyport. If you understand the below things - it will be easy to read such simple things as buttons states. So - for now I will not explain that :-)!</p>

<p>Vectrex has two joyports, both are wired:</p>

<div class="code">
<p> <tt> Vectrex Controller &amp; Port Connections:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pin 1: Button 1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pin 2: Button 2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pin 3: Button 3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pin 4: Button 4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pin 5: Joystick: Horizontal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pin 6: Joystick: Vertical<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pin 7: +5V<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pin 8: Ground<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pin 9: -5V<br />
</tt></p>
</div>

<p>For easier writing, in the following I will say "button x" whenever I refer to "Pin x".  And what I really mean is: the device connected to Pin x. 		 	<br />
<br />
	 <b>Specials:<br />
</b> Port 0 Button 4 is wired to 6809 FIRQ line<br />
Port 1 Button 4 is wired to 6522 CA1 line<br />
</p>

<p>Both lines are DIRECTLY connected to the button outputs, these connections are not  going thru PSG chip first!</p>

<p>Devices (except for e.g. paddles) on the joyports usually only use the four "buttons" to communicate with vectrex (Lightpen, Imager, LinkCables, VecSpeech).</p>

<p>Although in theory all devices can be plugged into both ports usually only port 1 is used for these devices, since:
<ol><li>
<p>the vectrex "user" is used to having a joystick in port 0</p>
</li><li>
<p>all programs making use of the devices have to adjust to the ports, and they usually don't do that</p>
</li></ol>
</p>

<p>The only device known, that actually IS used in port 0 is the lightpen. There is one program (Engine Analyzer) which expects the lightpen in port 0.</p>

<p><b><br />
Communication<br />
</b></p>

<p>There are  two types of communication possible:</p>
<br />

<p><b>direct</b><br />
Uni directional communication: Device &rarr; vectrex.</p>

<p>The direct communication can only be used FROM the device TO vectrex. This can only be done via "button 4" which is connected to CA1 or FIRQ.</p>
<br />

<p><b>indirect</b><br />
Bi directional communication is possible using the PSG chip.</p>

<p>Port 0 button 1-4 are connected to the four lower bits of Port A of the PSG chip.<br />
(button 1 to bit 0, button 2 to bit 1, button 3 to bit 2, button 4 to bit 3)<br />
Port 1 button 1-4 are connected to the four upper bits of Port A of the PSG chip.<br />
(button 1 to bit 4, button 2 to bit 5, button 3 to bit 6, button 4 to bit 7)</p>
<br />

<p><i>interlude PSG</i><br />
 <br />
It is worth noting, that the Port A has two modes:
<ul><li>
<p>Input mode (port A of PSG can be written to from the outside[a device in the joyports])</p>
</li><li>
<p>Output mode (port A of PSG can output data to the outside [a device in the joyports])</p>
</li></ul>
</p>

<p>The mode of the port is set by bit 6 of register 7 of the PSG (0 = input, 1 = output).</p>

<p>It seems, that internally the PSG has a special storage area for output values. This "storage" is not effected by the values which are put to the port A lines (from the outside). Upon switching from input to output mode, the values from that internal storage are  always restored and set to port A.</p>

<p>In INPUT-mode<br />
It seems that the output values can ALSO be set while PSG is in input mode. (Setting output data while in input mode, sets the data to that internal "storage" area,  the actual port A will always read $ff when read[from the outside] while in input mode.)</p>

<p>In OUTPUT-mode<br />
The opposite does not seem to be true. When PSG is in output mode, it seems data can still be "correctly" read from the PSG side  (meaning: reading from the vectrex side, reading out PSG register (reg 14) reads the state  of the buttons (NOT $ff) - my first guess would have been to read a $ff  if in output mode - but this is NOT the case)<br />
[I have not written extensive test programs for this behaviour. I don't know if the returned value is the CURRENT input value on the ports, or the last known input value. In the later case that would mean, that there also is an internal storage area for input values,  as there is for output values. The known implementation of the game BerzerkArena seem to indicate, that even though port A of the PSG is set to output mode, input values (coming in this case from the other vectrex) can be read as "usual". The complete game BerzerkArena is played with PSG Port A set to output, and the serial communication works in both directions.]</p>
<br />

<p><i>interlude end</i><br />
</p>
<br />

<p><b>Accessing the Buttons</b><br />
As mentioned above, the joyport buttons are directly connected to PSG port A. To read or write to the buttons the programmer must access Port A of PSG.</p>

<p>The PSG on the other hand is not connected/mapped to any memory location. To access PSG  one has to go through VIA 6522.</p>

<p>Now it gets confusing. <br />
VIA also has a Port A (Reg 1), the lines of VIA port A are "passed" through the PSG chip to the DAC. We are ignoring DAC and all that follows at the moment and just acknowledge the fact, that PSG chip is connected  (with its DA0-7 lines [DA stands for Data/Address, you will see why later]) to VIA.<br />
 <br />
So - at the end of the day to read or write values to the PSG one has to go thru VIA (port A). (Needless to say, that Via port A also can be input or output, which in turn is configured by Via Reg 3 DDRA).</p>

<p>Now, PSG has only one 8 bit "line" (DA0 - DA7) as Input/Output for data. But we also have to tell the PSG what we want to do (read or write, and from where or where to). For that purpose there are two other PSG "pins" available (in reality 3, but we are ignoring BC2 here).<br />
Pin: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BDIR (Bus direction)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BC1 (Bus Control 1)<br />
</p>

<p>Those two pins taken together can be read as a two bit number with following meaning:<br />
BDIR/BC1: 00 - inactive<br />
BDIR/BC1: 01 - read from PSG<br />
BDIR/BC1: 10 - write to PSG<br />
BDIR/BC1: 11 - latch address<br />
</p>

<p>With configuring these pins in conjunction with the DA lines we access the PSG and can read or write values.</p>

<p>Simple example:<br />
 Task: read value of register 7 <br />
 <br />
We set following "things" of PSG:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DA       =  7<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BDIR/BC1 = 00<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BDIR/BC1 = 11<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BDIR/BC1 = 00<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BDIR/BC1 = 01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DA can now be read with the value of PSG Reg 7<br />
  <br />
Comments:
<ol><li>
<p>first set the register we are interested in to DA <br />
(hence D"A" (ADDRESS we want to read))</p>
</li><li>
<p>set BDIR/BC1 = 00 to INACTIVE, this is NEEDED!<br />
   Switching the state of BDIR/BC1 can not be done directly!<br />
   Switching to a state (different 00) must ALLWAYS be done from state 00!</p>
</li><li>
<p>set BDIR/BC1 = 11, PSG remembers the value in DA (7) as the current latched address<br />
   meaning: the next read or write access will be done with that latched address</p>
</li><li>
<p>set BDIR/BC1 = 00 see above</p>
</li><li>
<p>set BDIR/BC1 = 01 read the currently latched register (7) to DA <br />
(hence "D"A    (since now it is filled with DATA of reg 7)) <br />
 </p>
</li></ol>
</p>

<p> <br />
<b>BDIR and BC1</b><br />
These two pins are again set (can not be read!) by setting appropriate bits to VIA.<br />
More specific both pins are connected to VIA port B.<br />
Even still more specific:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BDIR is bit 4 of via port B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BC1 is bit 3 of via port B<br />
  <br />
  Real world vectrex example:</p>

<p>Writing a value to joystick buttons </p>

<p>(value of A is "split" to two nibbles, <br />
the lower nibble will end up in Port 0 buttons<br />
the upper nibble will end up in port 1 buttons<br />
- with vectrex, writings to port 0 will usually be discarded<br />
  by an ignorant joystick :-) ) </p>

<p><tt><br />
; value given in A<br />
; write value to joystick ports (buttons)<br />
; Port A of PSG is kept in OUTPUT mode<br />
; assuming that port A of VIA is in output mode<br />
; and also that port B of VIA is otherwise configured to correct IO settings<br />
write&nbsp;A&nbsp;toJoy2:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta -01,s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; store given value on stack<br />
<br />
; Latch Reg $07 of PSG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda #$07&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Register 7 of PSG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta &lt;VIA&nbsp;port&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; VIA A = 0x07 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldd #$9981&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; 1001 1001 / 1000 0001 1) bit 3+4 == 11, 2) bit 3+4 = 00 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; VIA Port B = 99, mux disabled, RAMP disabled, BC1/BDIR = 11 (Latch address)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stb &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; VIA Port B = 81, mux disabled, RAMP disabled, BC1/BDIR = 00 (PSG inactive)<br />
     <br />
; write value of $7f to reg $07 (latched)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda #$7F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; $7f to VIA A (DAC) $7f = 0111 1111, disable all noise and tone in psg, <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; ENABLE OUTPUT on port A of PSG (port B irrelevant since it is a 8912)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta &lt;VIA&nbsp;port&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; $7f to VIA A (DAC)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldd #$9181<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; VIA Port B = 91, mux disabled, RAMP disabled, BC1/BDIR = 10 (Write to PSG)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stb &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; VIA Port B = 81, mux disabled, RAMP disabled, BC1/BDIR = 00 (PSG inactive)<br />
<br />
; now port A of PSG is in output mode and can be written to	 <br />
	 <br />
; Latch Reg $E of PSG (Port A)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda #$0E<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta &lt;VIA&nbsp;port&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; $0e to VIA A (DAC)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldd #$9981&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; 1001 1001 / 1000 0001 1) bit 3+4 == 11, 2) bit 3+4 = 00 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; VIA Port B = 99, mux disabled, RAMP disabled, BC1/BDIR = 11 (Latch address)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stb &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; VIA Port B = 81, mux disabled, RAMP disabled, BC1/BDIR = 00 (PSG inactive)<br />
     <br />
; write A to port<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda -01,s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; read value from stack<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta &lt;VIA&nbsp;port&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; output value to via VIA port A to Port A of PSG (Joystick buttons)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldd #$9181&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; 1001 0001 / 1000 0001 1) bit 3+4 == 10, 2) bit 3+4 = 00 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; VIA Port B = 91, mux disabled, RAMP disabled, BC1/BDIR = 10 (Write to PSG)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stb &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; VIA Port B = 81, mux disabled, RAMP disabled, BC1/BDIR = 00 (PSG inactive)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rts<br />
<br />
</tt> Note:<br />
BC1/BDIR = 00 is used at the end of each command. This is ok, if this is followed strictly, since before each setting BC1/BDIR must be 00, which is still "honoured".</p>

<p>Note:<br />
The vectrex BIOS also supports PSG "operations". If you only use BIOS functions to access PSG, than all registers of the PSG are shadows at the RAM locations:<br />
<br />
$c83f (register 14)<br />
...<br />
$c84c (register 0)<br />
<br />
Yes - in reverse order!<br />
You can read those values and use them as you would do "directly". To poke a value at register 7 you would do:<br />
</p>

<p><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldb #$00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; value to set<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda #$07&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; Register 7 of PSG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jsr Sound&nbsp;Byte&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; write byte to soundchip and to shadow registers <br />
</tt></p>
<h2>Part two - Joystick!</h2>

<p>Reading values of the joystick is not as easy as one might think.<br />
(Or - you just use the available BIOS functions - THAT makes it quite easy, but that is explained elsewhere).</p>

<p>The vectrex was one of the first machines to have analog joysticks. Below I will try to explain how they are implemented and accessed.</p>

<p>Each joystick direction is implemented as a potentiometer. Alltogether there can be four such potentiometers:
<ul><li>
<p>port 0: horizontal</p>
</li><li>
<p>port 0: vertical</p>
</li><li>
<p>port 1: horizontal</p>
</li><li>
<p>port 1: vertical</p>
</li></ul>
</p>

<p>Do you remember how the integrators have access to DAC values? The DAC value goes "thru" a multiplexer. The multiplexer has two "SELECT" lines (Via port B bit 1+2). The select values "multiplex" the one input signal to one of four output lines. The output line is chosen by the value of the select lines.</p>

<p>Why am I telling you that?</p>

<p>Because with the joystick potentiometers this is the same.</p>

<p>REALLY the same, since the physical electronic part inside the vectrex is the same (4052b). That chip is a Multiplexer/DeMultiplexer. The same select lines (Via port B bits 1+2) select which of the 4 potentiometers is taken as input:<br />
Bit2+Bit1:
<ul><li>
<p>00: port 0 horizontal</p>
</li><li>
<p>01: port 0 vertical</p>
</li><li>
<p>10: port 1 horizontal</p>
</li><li>
<p>11: port 1 vertical</p>
</li></ul>
</p>

<p>The demultiplexer sets the voltage of the one selected potentiometer to a circuit which is connected to the DAC and a special other pin.</p>

<p>The circuit compares the value of the potentiomenter to the analog value received from the DAC. If the contents of the DAC (the analog representation of a digital signed value ranging from -128 to +127) is smaller than the value gotten from the potentiometer, than the above mentioned pin is set to true - otherwise false.</p>

<p>The pin (how could it be otherwise) is again part of Via - it can be found in Via port B bit 5. The bit/pin is cleverly named "comparator input bit" (meaning: input <i>from</i> the comparator, not input <i>to</i> the comparator!).</p>

<p>With that information, a digital request in pseudo code can be done like:</p>

<p>Question: is Joystick port B moved to right?<br />
<br />

<ul><li>
<p>disable mux<br />
</p>
</li><li>
<p>dac = 0<br />
</p>
</li><li>
<p>mux sel = 00<br />
</p>
</li><li>
<p>enable mux<br />
</p>
</li><li>
<p>delay short<br />
</p>
</li><li>
<p>disable mux<br />
</p>
</li><li>
<p>delay "long"<br />
</p>
</li><li>
<p>load dac with some positive value<br />
</p>
</li><li>
<p>check compare bit<br />
</p>
</li><li>
<p>if set than joystick was moved right<br />
</p>
</li></ul>
</p>

<p>To get an analog value in principle the same must be done, but you have to test more. The line "load dac with some positive value" - and the checking afterwards has to be done with increasing values till a point is reached where the flag is not set anymore. The last set value (or the first unset value) is the digital representation of the potentiometer of the current joystick axis.</p>

<p>This is, why it is usually a good idea to only use analog values if it absolutely neccessary, since it is time consuming to do the aproximation.</p>

<p>Real life example of a digital joystick "request" for port 0:<br />
(not the BIOS function)<br />
<br />
<tt> queryInputPort0: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda      #$D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; setup DP <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tfr      a,dp <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;direct   $D0 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda      #$03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; mux disabled, mux sel = 01 (vertical pot port 0) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta      &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clr      &lt;VIA&nbsp;port&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; dac = 0 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dec      &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; mux enabled, mux sel = 01 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldb      #$20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; a wait loop 32 times a loop (waiting for the pots to "read" values, and feed to compare logic) <br />
waitLoopV: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; ... <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bne      waitLoopV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; wait... <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inc      &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; disable mux <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldb      #$20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; load b with comparator bit (0010 0000) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda      #$40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; load a with test value (positive y) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta      &lt;VIA&nbsp;port&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; test value to DAC <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda      #$01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; default result value y was pushed UP <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitb     &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; test comparator <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bne      yReadDone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; if comparator not cleared - joystick was moved up <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neg      &lt;VIA&nbsp;port&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; "load" with negative value <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nega&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; also switch the possible result in A <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitb     &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; test comparator again <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beq      yReadDone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; if cleared the joystick was moved down <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; if still not cleared, we clear a as the final vertical test result (no move at all) <br />
yReadDone: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta      &gt;joy&nbsp;y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; remember the result in "our" joystick data <br />
;<br />
; now the same for horizontal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda      #$01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; mux disabled, mux sel = 00 (horizontal pot port 0) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta      &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clr      &lt;VIA&nbsp;port&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; dac = 0 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dec      &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; mux enabled, mux sel = 01 <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldb      #$20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; a wait loop 32 times a loop (waiting for the pots to "read" values, and feed to compare logic) <br />
waitLoopH: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; ... <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bne      waitLoopH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; wait... <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inc      &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; disable mux <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldb      #$20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; load b with comparator bit (0010 0000) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda      #$40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; load a with test value (positive x) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta      &lt;VIA&nbsp;port&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; test value to DAC <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lda      #$01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; default result value x was pushed right <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitb     &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; test comparator <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bne      xReadDone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; if comparator not<br />
 cleared - joystick was moved right <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neg      &lt;VIA&nbsp;port&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; "load" with negative value <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nega&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; also switch the possible result in A <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitb     &lt;VIA&nbsp;port&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; test comparator again <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beq      xReadDone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; if cleared the joystick was moved left <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; if still not cleared, we clear a as the final vertical test result (no move at all) <br />
xReadDone: <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sta      &gt;joy&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; remember the result in "our" joystick data <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; done <br />
</tt></p>
<br />
<hr />
<h1>FAQ general</h1>
<h2>What java version do you need to start/use VIDE?</h2>

<p>I do all development with the - at the time - newest java version. I was told, that you need at least Java 1.8.<br />
 An exception:<br />
<i>Exception in thread "main" java.lang.UnsupportedClassVersionError: de/malban/VideMain: Unsupported major.minor version 52.0<br />
at java.lang.ClassLoader.defineClass1(Native Method)<br />
...<br />
</i> will occur if your java version is to old.</p>
<h2>I (try) to run Vide under Win 10 and it is REALLY slow!</h2>

<p>Apparently this has to do with the correct/incorrect java version. I myself do not have a windows 10 system available. But "Manu" discovered, that under under windows 10 [Quote]:<br />
<tt><br />
"The solution is here: <a target="_blank" href="https://java.com/en/download/manual.jsp">https://java.com/en/download/manual.jsp</a> - you need to download (also) the 64-bit version of Java, and it's not the &gt;normal&lt; download that they offer on the front page."</tt></p>
<h2>How do I enter new cartridges to the Starter?</h2>

<ul><li>
<p>Open the cartridge panel (menu: File&rarr;Extra&rarr;EditCartridgeInfo)</p>
</li><li>
<p>press new</p>
</li><li>
<p>enter at least a "name", a "cart name" and either a "bin" file or a Binary Link, all other fields are more or less optional.</p>
</li></ul>
<h2>Vide behaves strange, are there any bugs?</h2>

<p>Well... yes probably.<br />
Most bugs that I know of are history. New bugs should be reported to Malban. There are some things you can do to discover bugs and get information:
<ul><li>
<p>run from command prompt may show output to the command line</p>
</li><li>
<p>in the menu: File&rarr;Extra&rarr;Application Configuration<br />
you can set the debug level (3, pretty high) is as of now default.</p>
</li><li>
<p>in the menu: Window&rarr;Debug Window you can show a "Debug-Log" window, here some additional information may be displayed.</p>
</li></ul>
</p>
<h2>I used rightclick on a file in the vide - tree and accidently deleted a file. What can I do?</h2>

<p>Nothing, the file was deleted.</p>
<h2>Closing project/file/vide does not save or ask for save, why is that?</h2>

<p>Because I programmed it that way, you should know what you do!</p>
<h2>I just want to play some games, why is dissi always starting?</h2>

<p>Because the program is called vide and not gami!<br />
Update: Starting a game starts dissi iconified now!</p>
<h2>Is there a fullscreen mode, with just vecxi?</h2>

<p>Nope, this is only 10 lines of code, but the program is called vide, not gami!</p>
<h2>Why don't you use OpenGL and some shaders, the results would be much prettier, look at paraJVE?</h2>

<p>Because Vide is an developement environment, not a game center!<br />
Also...  Vide is (was :-( ) pure java.<br />
Actually I started a openGL version using LWJGL, but using that library send shivers down my spine. I aborted it after 1 day. I <i>might</i> at some stage start another try with JOGL, but don't wait for it.</p>
<h2>There are more vectrex programs available, why aren't they in the starter listing?</h2>

<p>Most homebrewlers are pretty strict with their creations. No homebrew program is bundled with vide (apart from the sources in the codi area). If vide is able to download the programs, than I have added them. If they are behind some internet walls, they are not included.</p>
<h2>Why does vide need an internet connection to start some programs?</h2>

<p>See last answer.</p>
<h2>Can I get the source code to VIDE?</h2>

<p>Yup, the source comes along with it.</p>
<h2>What kind of copyright/licencing does the source have?</h2>

<p>VIDE consists of different parts, which are programs collected from different sources. The old copyrights still apply. I only used sources which are freely available, but that does NOT mean they are public domain. With all sources I included copyright notices and license files (if available) - look at the respective places in the code. Code done by me (Malban) is open source and licenced with GPL V2.0.</p>
<h2>The source is huge, at least compared to the "compactness" of vecx, any tips?</h2>

<p>I use Netbeans version 8.x. All development was done with Netbeans, so that is what I recommend as IDE.<br />
Add the libraries in the "lib" (jars) folder, and you should be able to build. I use quite a lot of sourcecode from my other projects, for that reason there are probably many sources in the archive not really NEEDED for VIDE, nonetheless they are there.<br />
</p>

<p>The "Main" program can be found under: de.malban.VideMain, this mainly just instantiates a "CSAMainFrame", which is the main desktop application, from here all events are triggered.<br />
All things directly "vide"-related can be found under: de.malban.vide.*</p>
<h2>Do you support any other input devices than keyboard?</h2>

<p>You can configure many input devices. For accessing them I use the JInput library, which needs native support. For Windows, Mac and Linux the native libraries are included in the lib directory. If you use another OS, you are not able to configure other input devices. To configure, go to "Configuration" and than tab "Input".</p>
<hr />
<h1>FAQ emulation</h1>
<h2>How do I start a game?</h2>

<p>There are several ways:
<ul><li>
<p>Use the starter panel. You find it in the menu "Tools&rarr;Starter". From the list select the cartridge you want to start and double click the entry.</p>
</li><li>
<p>Open a vecx panel (menu: Tools&rarr;vecx), press the "folder" button and select a binary file. Press the start button (if another program is still running, press stop first)</p>
</li><li>
<p>Open a "codi" panel (menu: Tools&rarr;codi) navigate in the tree to an assembler program you would like to run and press the start button</p>
</li><li>
<p>do "the same" in vedi (menu: Tools&rarr;vedi), here load a project or a "single" source, and press the start button</p>
</li></ul>
</p>
<h2>I have a xxxx.bin file - how do a run that?</h2>

<p>See "How do I start a game", second bullet point.</p>
<h2>My own new game should have an overlay, what can I do?</h2>

<p>Overlays are just "normal" pictures where some regions have some alpha values. Try your favourite paint program. Save them as "png" images. (The overlay provided were stolen from MESS!) The filename of the overlay should be the same as the "bin" file, only with a different extension (png). </p>
<h2>Where should I put my own overlay image?</h2>

<p>Several options:
<ul><li>
<p>in the same directory as the binary</p>
</li><li>
<p>in the directory "overlay"</p>
</li><li>
<p>if the overlay belongs to a "cartridge" file, than just put the path to the image in the appropriate place</p>
</li></ul>
</p>
<h2>Some vectors in games seem wrong, vector lists appear to have lose ends?</h2>

<p>An analoge fault: "drift" is emulated. If you want (unnatural) correctness of all vectors, you should set drift to 0 (slider to the center).</p>
<h2>Some texts are printed "more diagonal" than others, why is that?</h2>

<p>See answer to last question, this also is a drift "feature".</p>
<h2>On my real vectrex some programs look different, why is that?</h2>

<p>Because the emulator is not a real vectrex. IMHO vide is pretty exact at emulating vectrex. But knowledgable programmers can certainly still outsmart vide with just a few lines of code.</p>

<p>Appart from that nothing comes close to the vector glow of a real vectrex :-)!</p>
<h2>Can I do something, that Vide emulation is more close to my own vectrex?</h2>

<p>Yes.<br />
Well, probably<br />

<ul><li>
<p>first: there is the drift (mentioned above), this may be slightly different for each vectrex</p>
</li><li>
<p>second: "timing" parameter seem to differ for different vectrex generations. Just fiddle with the timings till emulation comes close to your vectrex. But be sure to try different cartridges with your settings - all of them should be working, not just one!</p>
</li><li>
<p>also, you may fiddle with "pure" display settings, like vector glow, brightness, line width, drawing splines, antialiazing etc...</p>
</li></ul>
</p>
<h2>Most programs display very clearly, but some seem to flicker a lot, what is that?</h2>

<p>In the configuration there is an option "Try autoSync". Well - if autosyncing is switched off, or the "auto" part did not work, display will "flicker".</p>
<h2>Emulation seems to be awfully slow, can I speed things up?</h2>

<p>Yep. Just remember, vide was never build for speed! <br />
you can (in descending order):
<ul><li>
<p>be absolutley sure that "ray gun" is switched off!</p>
</li><li>
<p>disable ringbuffer</p>
</li><li>
<p>antialiazing ON (on is faster on my system, why? I don't now!)</p>
</li><li>
<p>disable glow</p>
</li><li>
<p>set line width to 1</p>
</li><li>
<p>disable persistence</p>
</li><li>
<p>don't use an overlay</p>
</li><li>
<p>disable codescan</p>
</li><li>
<p>disable cycle exact emulation</p>
</li><li>
<p>switch off the use of splines</p>
</li></ul>
</p>
<h2>When I start one of the 3d games only a black screen is shown after the start, why?</h2>

<p>For all known 3d-Imager games the configuration includes "imager". If for some reason in the second joystick port no imager is present, that might be the problem. Chose "Imager" in the combobox for port 1.</p>
<h2>When I debug my program, I notice vectors are drawn differently, what is that?</h2>

<p>Depending on your VIDE settings ("activate direct draw on debug"), vectors while single stepping/multistepping are REALLY drawn differently!<br />
Explanation:<br />
Usually vecxi emulates and "collects" vectors for a certain amount of time (one frame, depending on sync settings). All collected vectors are than drawn in one go, while in the background vector "collecting" continuous (different thread). When single stepping,  a user is probably not amused, if the vector that should be drawn NOW is drawn 30000 cycles later... so while in debug mode vectors are drawn "directly". Directly here means after one "vector" is finished (if not in "ray mode" vectors are drawn as a whole, not in "single steps"). To be able to discern the just drawn vector, it is drawn in "yellow" (not in grayscale), the yellow is only visible for one frame in which the vector was drawn! (this can be best seen if "glow" is disabled in emulation, since the glow effect is still grayscaled!)</p>
<hr />
<h1>FAQ development</h1>
<h2>I am new to vectrex development, what can do I do to get started?</h2>

<ul><li>
<p>hm, difficult, where to start?</p>
</li><li>
<p>There are two good starters you should read:
<ul><li>
<p>the introduction texts of the two "Chris"s <br />
&nbsp;&nbsp;1) go to menu: Library&rarr;Programming&rarr;Tutorial Christopher Tumber <br />
&nbsp;&nbsp;2) go to menu: Library&rarr;Programming&rarr;Tutorial Malban</p>
</li><li>
<p>The first emphasises assembler for starters</p>
</li><li>
<p>The second emphasises vectrex/vectrex BIOS for starters</p>
</li></ul>
</p>
</li><li>
<p>in relation to VIDE open a vedi panel (menu: Tools&rarr;vide)</p>
</li><li>
<p>create a new project (button NEW&rarr; new Project)</p>
</li><li>
<p>give your trial project a name, and check create game loop</p>
</li><li>
<p>now you have your first "hello world" program, with the two reads from above you should start to experiment</p>
</li></ul>
<h2>I have an asm-file - how do I assemble that?</h2>

<p>Again there are (at least) two options, for both - open vedi and:
<ul><li>
<p>First: 
<ul><li>
<p>Create a project without checking "create game" loop</p>
</li><li>
<p>right click the root of the project and select add file, select the asm file you want, it will be copied to the project directory</p>
</li><li>
<p>right click on the file and select "set as main"</p>
</li><li>
<p>now click the build button</p>
</li></ul>
</p>
</li><li>
<p>Second:
<ul><li>
<p>click on the Open File button, select the source you have. It will open in a new editor</p>
</li><li>
<p>click the assemble/run button</p>
</li></ul>
</p>
</li></ul>
</p>
<h2>Assi is not optimizing as good as my older assembler.</h2>

<p>Yep that might be true. Optimizing is sometimes tricky. And since I did not develope the core code of assi myself, I felt sometimes restrained to change the very core of it (or in other words I did not dare). Anyway I think a good solution is to let the programmer do optimization - I don't think any assembler (or compiler) can be as good as a programmer.</p>
<h2>But... even a extended addressing is sometimes not translated to direct addressing even when possible!</h2>

<p>Yes. If you use extended addressing with a variable (ram location e.g.) that is defined further down the source (or an include file loaded at a later stage), that address is not optimized to direct addressing. This also has to do with the inner working of assi. The decision whether an instruction is direct or extended is made in pass 1. In pass 1 also the includes and variables are evaluated. If a variable comes later down the line it is at that stage "unkown" and a decision whether the DP-register is the correct one can not be made. Doing extended addressing is the save path. The correct way for assi would be to do a pass in between and try to assert all "fixed" variables so at least they can be evaluated - I have not done that yet! Two fixes are possible for that particular "optimization":
<ul><li>
<p>do not use variables before they are declared!</p>
</li><li>
<p>"force" direct addressing with the "&lt;" prefix</p>
</li></ul>
</p>
<h2>My sources are spread over several files, how do I assemble them?</h2>

<p>Look at the answer to the last question, both work.
<ul><li>
<p>build a project and select add and all files, set the "main" as main</p>
</li><li>
<p>all the other files are included by the assembler </p>
</li></ul>
</p>

<p>If the files represent different banks for bankswitching, create a new project according to your bankswitching scheme. Set to each bank the according file as main (this can only be done from the project properties panel)</p>
<h2>I love my old assembler I don't want to use assi, what can I do?</h2>

<p>Easy answer, well than don't - umpf! (so much work wasted....)<br />
<br />
Not so easy answer...<br />
You don't have to, but building and error editing in vedi won't be as comfortable.<br />
 <br />
</p>

<p>Each file can have it's own properties. Even your main ASM file. Create a property file for your main ASM file(s):
<ul><li>
<p>right click in the tree on that file and select "Properties"</p>
</li><li>
<p>check the "no internal processing" button (with that you switch assi for that file off)</p>
</li><li>
<p>to still assemble the file with the "build" button, you can/should configure a script for pre build commands</p>
</li><li>
<p>an example is provided for a MS Windows calling of AS09 to configure/view it:
<ul><li>
<p>press configure script</p>
</li><li>
<p>select the class "Utility"</p>
</li><li>
<p>select name: "execute Win command"</p>
</li><li>
<p>than the script sources are displayed, the script as it is shovels the current file to as09 (which is expected to be in the same directory, if you have some "central" position, edit the script)</p>
</li><li>
<p>output is done to Vedi-Messages, but you can not jump to errors with double clicks etc...</p>
</li></ul>
</p>
</li></ul>
</p>
<h2>How can I insert vectorlists into vedi?</h2>

<p>There are actually two easy ways:
<ul><li>
<p>generate the data in vecci, all data is after generation available in the system clipboard, so you after generation you can PASTE the data</p>
</li><li>
<p>in vedi go to the place you want to insert the data, right click with the mouse in the editor and select "insert vectorlist". A filechoser appears where you can chose any saved vectorlist. If it is exportable you can chose the export method and the generated code is inserted to the selected position in vedi.</p>
</li></ul>
</p>
<hr />
<h1>FAQ vecci</h1>
<h2>How can I "draw" vectors?</h2>

<p>You can draw vectors only if vecci is set to mode: "Set" than you can use the mouse buttons:
<ul><li>
<p>(left)click, drag and release and you have drawn a vector</p>
</li><li>
<p>or (in the top you always see displayed the current "start" position) if you (right) click, a vector is drawn from   that start position to the current position (in non continuous mode these vectors are NOT joined)</p>
</li><li>
<p>in "continuous" mode right click is the same as left click</p>
</li></ul>
</p>
<h2>How can I delete vectors?</h2>

<p>You can delete vectors only if vecci is set to mode: "Select vector" Than you can:
<ul><li>
<p>select one or more vectors, use the right mousebutton to access the popup and chose the delete option you want</p>
</li><li>
<p>you can also use the button "cut" (on the vectorlist tab), the "deleted" vectors are than also put into the internal buffer </p>
</li></ul>
</p>
<h2>What does the lilac color of vectors indicate? </h2>

<p>These vectors are "totally" relative, meaning both start and end are shared between this vector and its "neighbours".</p>
<h2>I want to change one "frame" of an animation, but it seems I always work on a copy!</h2>

<p>Yes, that is true. If you click on an animation frame, the editor is always filled with a copy of that frame. There is no direct editing. However, you can edit to your hearts content, when finished use the "apply" button (in the animation section), the edited vector list than replaces the current selected animation frame. <br />
There also is an option to "auto" apply all changes, but this might be dangerous, since all editing is directly applied to the animation list.</p>
<h2>What is the "add view" button useful for?</h2>

<p>At first it looks like it is just the same as the "add current" button. The difference is, that it does not add the current vectorlist of the editor, but rather the "displayed" vectorlist in the little panel below that. If that panel is not in play mode, it displays the currently edited vectorlist. The "trick" is, that the displayed vectorlist can be viewed from different angles.<br />
Switch to the tab "3d axis settings", here you can change the 3d display settings of the "viewport" perspective (if you might want to call it that).<br />
You will notice as you either change the object angle or the coordinate system axis, that the displayed vectorlist changes its display. Using the "add view" button, you add the currently shown viewport "version" of the edited vectorlist to the animation. This might be usefull if you do not want to create a rotation animation with all angles, but rather would like to add specific viewport versions of your vectorlist.<br />
 <br />
Note:<br />
The display panel always uses the given 3d settings. If you just added a view to your animation the new "view" to that vectorlist instantly changes, since the 3d settings are applied to the new vectorlist (the settings are thus applied TWICE in relation to the original vectorlist). To view the "correct" list, you must reset the 3d settings!</p>
<h2>If I rotate a vectorlist, it is not as smooth as I want it, why?</h2>

<p>The "smoothness" depends in general on two factors:
<ol><li>
<p>the count of steps you specified between your start angle and your end angle. If you specified (for example) only 10 steps for a 360 degree rotation, that means each frame will differ with 36 degrees, which IS rather "unsmooth" - just chose to use more steps</p>
</li><li>
<p>all vector coordinates are integers, if your vectors are rather short (like each coordinate below 20) than the resulting rotation vectors tend to "jump" from one integer point to the next upon one step, which is also rather "unsmooth". In that case you should use a larger scale to draw your vectors, the resulting rotation will be much smoother, since it results in a better differentiation of coordinates.</p>
</li></ol>
</p>

<p>Note:<br />
Beware! That "sensible" coordinates range from -128 to +127!</p>
<h2>It seems you only allow anti clockwise rotation, darn!</h2>

<p>Well, just you hit the "reverse" button of your animation and have it your way!</p>
<h2>Reverse is a nice feature for the animation list, but what if I want to reorder the animation manually?</h2>

<p>There are the two "arrow" buttons. Just "clicking" them changes the selection, but SHIFT clicking on them moves the selected animation frame in the animation list! </p>
<h2>Can I somehow "grab" vectors from other games/cartridges?</h2>

<p>Well - apart from disassembling and using dissi features there are actually two other things you might try:
<ul><li>
<p>vector - screenshort<br />
In dissi you can take a screenshort in form of a (very big) vectorlist. These vectorlists can be loaded in vecci. There you can select/edit/delete/save the vectors you are interested in. <br />
Note:<br />
You should set the emulation to "pure emulation", since things as drift or others will offset the vectors and the resulting grabbed lists will not be "nice fitting"<br />
 <br />
</p>
</li><li>
<p>scan for vectorlists<br />
in the configuration under "editor" you can enable "scan for vectorlists". This option tells vecxi to actually "watch" known BIOS draw routines for vectorlists. If vecxi thinks it has found a vectorlists it saves it (using the cartridge name as a filename).<br />
Note:<br />
This obviously only works if the program you want to "grab" from uses BIOS routines! </p>
</li></ul>
</p>
<h2>I can't export my vectorlist, what have I done wrong? What can I do?</h2>

<p>In general free drawn vectorlists are not immediately exportable, since vectrex always wishes to have continuous vectorlists. There are several ways to get going:
<ol><li>
<p>draw in continuous mode, that way you are insured to have a drawing in "one go"</p>
</li><li>
<p>this is not always possible, I realize that, appart from doing continuous drawing by hand, vecci is strong at supporting you to do that later!
<ul><li>
<p>pressing the 3 shortcuts: <br />
<b> "connect where possible"<br />
"order vectorlist"<br />
"split where needed"<br />
</b> in general only does good things, you should use them often!</p>
</li><li>
<p>if that was not enough you obviously do not have continuous vectors, than you must insert them. <br />
You can do so manually (be sure to also "join" them) or automated, the later is done by using the shortcut <b>"fill gaps"</b>. <br />
Usually you want gaps filled with "moves" (invisible vectors), this is what the default does. If you however want to use the "Draw&nbsp;VLx" routines, than moves inherent in a vectorlists are not allowed. Than you can TRY checking the "line" checkbox nearby. This inserts "lines" instead of "moves", but that will probably look bad and you have to go back to the drawing board!</p>
</li></ul>
</p>
</li></ol>
</p>
<hr />
<h1>FAQ debugging/dissi</h1>
<h2>I realy like program XY and I would like to know how it functions, what is the best way to start disassembling and commenting it?</h2>

<p>Wow that question should have a real long answer.<br />
Here are some tips:
<ul><li>
<p>be sure in configuration the options under disassembler: <br />
codescan in vecxi is checked<br />
build generic labels is checked <br />
assume vectrex files is checked </p>
</li><li>
<p>just run the cartridge!<br />
</p>
</li><li>
<p>play as much as you like, go to dissi and press the "reset dissi" button</p>
</li><li>
<p>while playing dissi should have collected some information about what part is code, and what is data (this can still be optimized!)</p>
</li><li>
<p>just to be on the save side, press the button "save gathered information to cnt file"</p>
</li><li>
<p>get used to the button, this is important! With that all your entered information is persisted!</p>
</li><li>
<p>go to the start of the program, in the first line set a breakpoint</p>
</li><li>
<p>go to dissi command line and type "sr" (soft reset) the cartridge restarts and enters debug mode as soon as the breakpoint is reached</p>
</li><li>
<p>write your comments to the comment column of dissi (seperate comments in one line with ":")</p>
</li><li>
<p>if ram locations are accessed, open a vari panel (show variables)</p>
</li><li>
<p>all "used" ram locations are listed, you can edit the column "variables" and give the memory location nice names (source in dissi is updated!)</p>
</li><li>
<p>if loops or other labels are encountered, give them meaningfull names (column label in dissi can be edited), source is updated accordingly</p>
</li><li>
<p>if you know what the dp register is at some location, select the lines in dissi, right click, and tell dissi the dp register with the menu item DP</p>
</li><li>
<p>repeat until you documented all</p>
</li><li>
<p>and allways save a CNT file</p>
</li><li>
<p>if you want to assemble or reuse parts, click on "save dissi as asm file", and a asm file is generated in the same directory as the bin file</p>
</li></ul>
</p>
<h2>My program seems to have a bug, how do I start debugging it?</h2>

<p>When a program starts, there is ALWAYS a dissi window! Click on the only button without a tooltip, that is a BUG button. With that you start debugging. Alternatively you can go in dissi to an address you like, and press space or the "Breakpoint" button. With that you enable a breakpoint at that location and once the emulator reaches that address it will switch to debugging mode.</p>
<h2>I use assembler xy for many years now, I don't like using assi, can I debug my programs anyway using Vide?</h2>

<p>Yep!</p>
<h2>I disassemble a file and after a jump to BIOS dissi jumps to $7fff what is that?</h2>

<p>Per default the BIOS area is not displayed in dissi. If you want dissi to display BIOS area, check the "BIOS" checkbox.</p>
<h2>How do I best start debugging unkown sources?</h2>

<p>See answer about debugging above.<br />
Apart from that, some more tips:
<ul><li>
<p>to got to interesting places in foreign programs it is often a good start to look where vectors are drawn</p>
</li><li>
<p>go to dissi, check the ckeckbox "select vectors and show information"</p>
</li><li>
<p>pause emulation and select a particularly interesting vector ( :-) )</p>
</li><li>
<p>click with the mouse on it opens a vinfi panel</p>
</li><li>
<p>there are two interesing things:
<ul><li>
<p>PC, this is the address where this vector was finished (usually where the blank signal was enabled)</p>
</li><li>
<p>the callstack listing below PC, this shows the stack (addresses where subroutines will return to)</p>
</li></ul>
</p>
</li><li>
<p>clicking on these addresses will set dissi to these addresses</p>
</li><li>
<p>if still interested in these locations, set a breakpoint there</p>
</li><li>
<p>continue running till breakpoint is hit</p>
</li><li>
<p>if hit and you want to know "how" this vector was drawn, use the "take last instruction back" and go to the start of the drawing</p>
</li><li>
<p>if particulary interested in exact drawing procedures, go to configuration and  check (debug section) "paint integrator position" - a little red circle will appear (next step) and show where the electron beam of vectrex at the moment is placed!</p>
</li></ul>
</p>
<h2>How can I persist my comments I did with dissi?</h2>

<p>Press button "save gathered information to cnt file"!</p>
<h2>Why would I want to "select a vector with the mouse"? And what can I use that for?</h2>

<p>See two questions above.</p>
<h2>Tracki - some programs do not show any tracki information, why is that?</h2>

<p>They do to!<br />
Most probably you didn't configure tracki correctly. Tracky measure cycles between two memory locations the CPU (pc - program counter) passes.<br />
The default configuration is set up to measure cycles between the exit and the entry of the BIOS routine "WaitRecal". Many programs use that routine to do vector recalibration at the end of their game loop. Therefor for these programs the given locations measures the cylces of a game loop round.<br />
For programs which do not use the "WaitRecal" routine for their recalibration, the setup does not show any results. You must figure out what the program you are interested in uses for a game loop and/or recalibration. You can enter the so found addresses into the supplied start/end addreesses of tracki - than you can measure those programs.<br />
Also: Remember to switch the "always update" button to "on" - otherwise you won't see anything either :-)</p>
<h2>In dissi, what is the advantage of setting DP register knowledge to a location?</h2>

<p>DP - Variable names can be automatically used. Some DP variables (like VIA addresses) are "automatically" used if DP is set correctly. "VIA&nbsp;ORB" is IMHO better readable than "$d000". </p>
<h2>In dissi, sometimes something is marked bright green what happened?</h2>

<p>If you click on a "Label" (coloumn label, and a label must be present) all usages of that label are highlighted in bright green. That way you can find branches to a location very easily!</p>
<h2>In dissi, when I search something, what exactly is searched?</h2>

<ul><li>
<p>searching always starts with the current selected row</p>
</li><li>
<p>first the label(s) of the row (are) searched, </p>
</li><li>
<p>second if nothing was found, the comment(s) of the row is (are) searched</p>
</li><li>
<p>if something was found, searching is halted and dissy jumps to the row</p>
</li><li>
<p>if nothing was found searching continues with next (previous) row</p>
</li></ul>
<h2>In dissi, the number of cycles sometimes do not match with the table I got from motorola, what the...?<br />
</h2>

<p>Well yes.<br />
Dissi displays the REAL number of cycles, some official tables only show the "base" number of cycles.  For indirect and/or indexed addressing you must add some cycles because the address has to be calculated by the CPU. Believe me, the cycle information in dissi is "more" correct!</p>
<h2>In dissi, what is "highlight op" usefull for?</h2>

<p>Well, depends what your definition of usefull is. Play with it! The column "Operand" is taken as a string, if (case independend) the string you entered in "highlight op:" was part of the string, the operand column for that row is highlighted (yellow). This can be anything you like, a label, an address or anything that can be an operand. Great for a quick visual search! </p>
<h2>In dissi is a "Label" panel, what can I use that for?</h2>

<p>As the name suggests, this is a listing of all known labels. The advantage of the list is, that you can use it as a "table of contents" and quickly move to locations, double click on any entry jumps dissi to the given address, shift double click moves dumpi to the given address.</p>
<hr />
<h1>VIDE: Copyrights and Licenses...</h1>

<p><tt> <b>Code done by Jerry Huxtable</b><br />
---------------------------<br />
All code in the directory: de\malban\gui\image <br />
was done by: Jerry Huxtable<br />
<br />
Copyright 2006 Jerry Huxtable<br />
<br />
and is distributed under the Apache License, Version 2.0.<br />
<br />
The only changes to the code I made was to:<br />

<ol><li>
<p>move the files to a package in my code structure<br />
</p>
</li><li>
<p>use only the filters I needed in my code.<br />
</p>
<br />
</li></ol>
</tt></p>

<p><tt> In the directory you find a <br />
LICENSE<br />
and a <br />
README<br />
<br />
file of the original author. The original project website can be accessed under:<br />
<a target="_blank" href="http://www.jhlabs.com/ip/filters/">http://www.jhlabs.com/ip/filters/</a><br />
<br />
<br />
<b>Icons done by Mark James</b><br />
------------------------<br />
All icons in the directory: de\malban\vide\images <br />
were made by: Mark James<br />
In the directory you find a <br />
"legalcode"</tt></p>

<p><tt>The original website can be accessed under: <a target="_blank" href="http://www.famfamfam.com/lab/icons/silk/">http://www.famfamfam.com/lab/icons/silk/</a>  <br />
 <br />
The icons can also be used under Creative Commons Attribution 2.5 License.</tt></p>

<p><tt> <b>Code done by Finn Kuusisto</b><br />
--------------------------<br />
All code in the directory: de\malban\sound\tinysound <br />
was done by: Finn Kuusisto<br />
<br />
Copyright (c) 2012, Finn Kuusisto <br />
<br />
TinySound is licensed under the BSD 2-Clause license.<br />
<br />
I made some code changes:<br />

<ol><li>
<p>move the files to a package in my code structure<br />
</p>
</li><li>
<p>added some code to stream sound from the emulator.<br />
</p>
</li></ol>
</tt></p>

<p><tt> In the directory you find a<br />
LICENSE<br />
and a <br />
README<br />
<br />
file of the original author. The original project website can be accessed under:<br />
<a target="_blank" href="https://github.com/finnkuusisto/TinySound">https://github.com/finnkuusisto/TinySound</a><br />
<br />
</tt></p>

<p><tt> <b>Code done by Bill Yakowenko</b><br />
--------------------------<br />
All code in the directory: de\malban\vide\assi <br />
was done by: Bill Yakowenko<br />
<br />
Bill placed the complete package in the public domain!<br />
<br />
The code changes I made are numerous, see the "assi" pages.<br />
<br />
The original project website can be accessed under:<br />
<a target="_blank" href="http://sourceforge.net/projects/asmj">http://sourceforge.net/projects/asmj</a><br />
</tt></p>

<p><tt> <b>Code done by Sean Riddle</b><br />
------------------------<br />
In the directory: de\malban\vide\dissi <br />
the orginal code for the disassembler was done by: Sean Riddle<br />
<br />
Copyright (c)1995 Sean Riddle <br />
<br />
DASM6809 may be distributed with the following remark:<br />
"Freely distributable on any medium given all copyrights are retained by the author and no charge greater than $7.00 is made for obtaining this software." <br />
<br />
I made MANY changes, to many to list!<br />
 <br />
  The original project website can be accessed under:<br />
<a target="_blank" href="http://www.seanriddle.com">http://www.seanriddle.com</a><br />
<br />
</tt></p>

<p><tt> <b>Code done by Valavan Manohararajah</b><br />
----------------------------------<br />
In the directory: de\malban\vide\vecx <br />
the orginal code for vecxi was done by: <br />
Valavan Manohararajah<br />
<br />
Apart from others picking like vultures on the orginal code and placing dubious copyright notice like:<br />
 <br />
"hey dude, I added SDL (10 lines of code) I hereby claim copyright of that!"<br />
 <br />
 (sorry, I am in a foul mood...)<br />
I didn't find any information on copyright in the original code. I can't even find a homepage of Valavan or any notice of what has become of him.   I hope in using your great vecx-start in vide didn't upset you in any way, thanks for your code!  <br />
 <br />
 In that directory there is also the AY-3-8910 emulation code. This was taken of an old version of the MAME project and diverse people were involved here:<br />
 <br />
 "Based on various code snippets by Ville Hallik, Michael Cuddy, Tatsuyuki Satoh, Fabrice Frances, Nicola Salmoria. "  <br />
</tt></p>

<p><tt> <b>Code by Gabe Johnson</b><br />
--------------------<br />
Code in the directory: de\malban\vide\vecx\spline <br />
was inspired by a blog entry of: Gabe Johnson<br />
<br />
To get to the source code, you have to download a 250MB package with all stuff (seemingly) Gabe Johnson ever did, including CV and a dissertation. It <i>might be</i> that somewhere there is a copyright notice, but I didn't find one on a quick search.<br />
<br />
<br />
I made some code changes:<br />

<ol><li>
<p>I extracted the code I needed, and just about THAT.<br />
</p>
</li></ol>
</tt></p>

<p><tt> <br />
The original blog website can be accessed under:<br />
<a target="_blank" href="http://johnsogg.blogspot.de/2010/01/cardinal-splines-and-catmull-rom.html">http://johnsogg.blogspot.de/2010/01/cardinal-splines-and-catmull-rom.html</a><br />
<br />
</tt></p>

<p><tt> <b>Code by Martin Cameron</b><br />
----------------------<br />
Code in the directory: de\malban\vedi\sound\ibxm <br />
was done by: Martin Cameron<br />
<br />
(c)2011 mumart@gmail.com <br />
<br />
IBXM license allows usage and distribution.<br />
<br />
I made some code changes:<br />

<ol><li>
<p>move the files to a package in my code structure<br />
</p>
</li><li>
<p>added some code to have a stripped down panel, and be able to switch off voices.<br />
</p>
<br />
</li></ol>
</tt></p>

<p><tt> In the directory you find a <br />
LICENSE<br />
and a <br />
README<br />
<br />
file of the original author. The original project website can be accessed under:<br />
<a target="_blank" href="https://code.google.com/archive/p/micromod/downloads">https://code.google.com/archive/p/micromod/downloads</a><br />
<br />
</tt></p>

<p><tt> <b>Code by FieserWolf/Nitro</b><br />
------------------------<br />
The original Pascal code to the file: de\malban\vedi\sound\Mod2Vectrex.java <br />
was done by: FieserWolf, additions by Nitro<br />
<br />
The source for inclusion to VIDE was kindly given by the two guys above. <br />
The closest thing to a homepage is:<br />
<a target="_blank" href="http://metalvotze.de/files/vecsrc">http://metalvotze.de/files/vecsrc</a><br />
<br />
</tt></p>

<p><tt> <br />
<br />
I Also use the following libraries:<br />
<br />
<b>TinyLAF</b><br />
-------<br />
Author: Hans Bickel  <br />
Licence: GNU Lesser General Public License. <br />
Homepage: <a target="_blank" href="http://www.muntjak.de/hans/java/tinylaf/index.html">http://www.muntjak.de/hans/java/tinylaf/index.html</a><br />
Homepage: <a target="_blank" href="http://sourceforge.net/projects/tinylaf/">http://sourceforge.net/projects/tinylaf/</a><br />
<br />
<b>Java Beanshell</b><br />
--------------<br />
Author: Pat Niemeyer<br />
Licence: Sun Public License / GNU Lesser General Public License. <br />
Homepage: <a target="_blank" href="http://www.beanshell.org/">http://www.beanshell.org/</a><br />
<br />
<b>Syntax Highlighting</b><br />
-------------------<br />
Author: Stephen Ostermiller <br />
Licence: GNU General Public License (GPL) V2.0<br />
Homepage: <a target="_blank" href="http://ostermiller.org/syntax/">http://ostermiller.org/syntax/</a><br />
<br />
<b>Classmexer agent</b><br />
----------------<br />
Licence: use as you like, do not redistribute<br />
Author: Neil Coffey, Copyright (c) Javamex UK 2008<br />
Homepage: <a target="_blank" href="http://www.javamex.com/classmexer/">http://www.javamex.com/classmexer/</a><br />
<br />
<br />
Used to build the documentation:<br />
<b>HelpSetMaker</b><br />
------------<br />
Author: Cantamen [Dirk Hillbrecht, Peter Peterburgskyy]<br />
Licence: GNU General Public License (GPL) V2.0 (or later)<br />
Homepage: <a target="_blank" href="http://www.cantamen.de/helpsetmaker.php">http://www.cantamen.de/helpsetmaker.php</a><br />
</tt> <br />
<tt> Used to build vectorized images:<br />
<b>Potrace</b><br />
-------<br />
Author: Peter Selinger<br />
Licence: Copyright (c) 2001-2015 Peter Selinger, GNU General Public License (GPL) V2.0 (or later)<br />
Homepage: <a target="_blank" href="http://potrace.sourceforge.net/">http://potrace.sourceforge.net/</a><br />
</tt> <br />
<tt> Used for digital sound processing:<br />
<b>TarsosDSP</b><br />
---------<br />
Main Maintainer: Joren Six<br />
Tarsos and TarsosDSP are developed at University College Ghent, Faculty of Music<br />
Licence: GNU General Public License (GPL) V3.0 (or later)<br />
Homepage: <a target="_blank" href="https://github.com/JorenSix/Tarsos">https://github.com/JorenSix/Tarsos</a><br />
</tt></p>
<hr />
<h1>Code: Copyrights and Licenses...</h1>

<p><tt> <b>Documentation/Code by Christopher L. Tumber</b><br />
-------------------------------------------<br />
The document:<br />
documents\programming\Introduction to Vectrex Programming.pdf<br />
<br />
and the assembler sources in directories under:<br />
\programming\...\Christopher Tumber <br />
 <br />
 were done by Christopher L. Tumber and are <br />
(c) Copyright Christopher L. Tumber 1998 <br />
 <br />
He kindly allowed redistribution with VIDE.   <br />
<br />
Chris has a new website:<br />
<a target="_blank" href="http://www.ctumber.com/vectrex.html">http://www.ctumber.com/vectrex.html</a><br />
<br />
<br />
<b>Code by Alex Kazik</b><br />
------------------<br />
The assembler sources in directories under:<br />
\programming\...\Alex Kazik <br />
 <br />
 were done by Alex Kazik <br />
    <br />
License<br />
-------<br />
This work is licensed under the Creative Commons Attribution-ShareAlike 4.0 International License. To view a copy of this license, visit <a target="_blank" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US">http://creativecommons.org/licenses/by-sa/4.0/deed.en_US</a> <br />
<br />
The original release was on Alex' blog:<br />
<a target="_blank" href="http://alex.kazik.de/278/vectrex-p1x3l-pushr/">http://alex.kazik.de/278/vectrex-p1x3l-pushr/</a><br />
<br />
  <br />
<b>Code by John Dondzila</b><br />
---------------------<br />
The assembler sources in directories under:<br />
\programming\...\John Dondzila <br />
 <br />
 were done by John Dondzila <br />
    <br />
John placed the sources in the public domain, although his original website is gone and I can't find any current text that proves that. But I have been around at that time and I remember :-)!  <br />
<br />
  <br />
<b>Code by Manu Paerssinen</b><br />
----------------------<br />
The assembler sources in directories under:<br />
\programming\...\Manu <br />
 <br />
 were done by Manu Paerssinen <br />
    <br />
Manu placed the sources in the public domain!  <br />
  <br />
Manu has a website:<br />
<a target="_blank" href="http://pelikonepeijoonit.net/files/vec/">http://pelikonepeijoonit.net/files/vec/</a><br />
    <br />
<b>Code by Michael Simonds</b><br />
-----------------------<br />
The assembler sources in directories under:<br />
\programming\...\Michael Simonds <br />
 <br />
 were done by Michael Simonds <br />
    <br />
License:  <br />
 Please do anything you like with the code apart from selling/making clone (unlikely! !) <br />
I have not found any kind of web presence...<br />
    <br />
<b>Code by Ronan Habot</b><br />
-------------------<br />
The assembler sources in directories under:<br />
\programming\...\Ronan Habot <br />
 <br />
 were done by Ronan Habot and are: <br />
 Copyright 2000, 2001, Ronen Habot <br />
    <br />
License:  <br />
 Hm. Didn't find any, but there is that copyright notice. Well than - you just look at the source!   <br />
 <br />
Ronan has a website:<br />
<a target="_blank" href="http://vgcollect.freehosting.net/myvectrex.htm">http://vgcollect.freehosting.net/myvectrex.htm</a><br />
  <br />
<b>Code by Ville Krumlinde</b><br />
-----------------------<br />
The assembler sources in directories under:<br />
\programming\...\Ville Krumlinde <br />
 <br />
 were done by Ville Krumlinde and are: <br />
 Copyright (C) 2004  Ville Krumlinde   <br />
    <br />
License:  <br />
Here is the complete source code for my game Vectrex Thrust. This game would never have been possible to write without all the information people have shared on the web, so releasing this source code is my way of giving something back and hoping that someone will find it useful.   <br />
 <br />
Manu has a website:<br />
<a target="_blank" href="http://www.emix8.org">http://www.emix8.org</a><br />
  <br />
<b>Code by Frog</b><br />
------------<br />
The assembler sources in directories under:<br />
\programming\...\Frog <br />
 <br />
 were done by Frog   <br />
  I have not found any copyright notice or licence file, but the source files are freely available   <br />
 <br />
Frog has a website:<br />
<a target="_blank" href="http://frog.enlight.ru">http://frog.enlight.ru</a><br />
(but you might be more successful if you go: <a target="_blank" href="http://enlight.ru/search/all">http://enlight.ru/search/all</a>?q=vectrex)  <br />
<br />
<b>Code by Jeff Woolsay</b><br />
----------------------<br />
The assembler sources in directories under:<br />
\programming\...\Jeff Woolsay <br />
 <br />
 were done by Jeff Woolsay   <br />
  I have not found any copyright notice or licence file, but the source files are/were freely available.   <br />
 <br />
The sources used to be at:<br />
<a target="_blank" href="ftp://ftp.csus.edu/pub/vectrex">ftp://ftp.csus.edu/pub/vectrex</a><br />
  <br />
<b>Code by Mike Blackwell</b><br />
----------------------<br />
The assembler sources in directories under:<br />
\programming\...\Mike Blackwell <br />
 <br />
 were done by Mike Blackwell   <br />
  I have not found any copyright notice or licence file, but the source files are/were freely available.   <br />
 <br />
The sources used to be at:<br />
<a target="_blank" href="ftp://ftp.csus.edu/pub/vectrex">ftp://ftp.csus.edu/pub/vectrex</a><br />
  <br />
<b>Code by Bruce Tomlin</b><br />
----------------------<br />
The assembler sources in directories under:<br />
\programming\...\Bruce Tomlinl <br />
 <br />
 were done by Bruce Tomlin   <br />
  I have not found any copyright notice or licence file, but the source files are/were freely available.   <br />
 <br />
The sources used to be at:<br />
<a target="_blank" href="ftp://ftp.csus.edu/pub/vectrex">ftp://ftp.csus.edu/pub/vectrex</a><br />
    <br />
<b>Code by Metalvotze/Nitro/Nuance</b><br />
-------------------------------<br />
The assembler sources in directories under:<br />
\programming\...\MV <br />
 <br />
 were done by Metalvotze/Nitro/Nuance   <br />
  I have not found any copyright notice or licence file, but the source files are/were freely available.   <br />
 <br />
The sources can be found at:<br />
<a target="_blank" href="http://metalvotze.de/files/vecsrc">http://metalvotze.de/files/vecsrc</a><br />
      <br />
<b>Code by Orb</b><br />
-----------<br />
The assembler sources in directories under:<br />
\programming\...\Orb <br />
 <br />
 were done by Orb, <br />
(c) 2009 orb   <br />
 <br />
The sources can be found at:<br />
<a target="_blank" href="http://www.ultrafex.de/twistex/">http://www.ultrafex.de/twistex/</a><br />
    <br />
<b>Code by Alex Herbert</b><br />
--------------------<br />
The assembler sources in directories under:<br />
\programming\...\Alex Herbert <br />
 <br />
 were done by Alex Herbert, <br />
Copyright (c) Alex Herbert 2004 <br />
(I hope that copyright does not mean nobody is allowed to use that code, because otherwise the hardware it describes is pretty useless)     <br />
 <br />
The homepage can be found at:<br />
<a target="_blank" href="www.herbs64.com">www.herbs64.com</a><br />
    <br />
<b>Code by C. Malcom aka Binarystar</b><br />
--------------------------------<br />
The assembler sources in directories under:<br />
\programming\...\C. Malcom <br />
 <br />
 were done by C. Malcom <br />
(the sourcecode included was released on a vectrex forum, not on his homepage)   <br />
 <br />
The homepage can be found at:<br />
<a target="_blank" href="http://www.binarystarsoftware.com/">http://www.binarystarsoftware.com/</a><br />
    <br />
<b>Code by Andrew Coleman</b><br />
----------------------<br />
The assembler sources in directories under:<br />
\programming\...\Andrew Coleman <br />
 <br />
 were done by Andrew Coleman <br />
 <br />
Licence:<br />
This source code is copyright Andrew Coleman <br />
This whole thing is Freeware.<br />
<br />
You can play around with it, steal bits of it, do whatever you want with it really, but please DO NOT distribute any modified versions of this source without my permission.<br />
  <br />
  The homepage can be found at:<br />
<a target="_blank" href="http://vectrex.playntradeonline.com/skiing.html">http://vectrex.playntradeonline.com/skiing.html</a><br />
    <br />
<b>Code by Brian Mastrobuono</b><br />
-------------------------<br />
The assembler sources in directories under:<br />
\programming\...\Brian Mastrobuono <br />
 <br />
 were done by Brian Mastrobuono <br />
 Copyright 2001-2014   <br />
 <br />
Licence:<br />
GNU GPL licensed, use as you wish as long as your changes in source form are made public.<br />
    <br />
  The homepage can be found at:<br />
<a target="_blank" href="https://github.com/gauze/spudster">https://github.com/gauze/spudster</a><br />
       <br />
<b>Code by Clay Cowgill</b><br />
--------------------<br />
The assembler sources in directories under:<br />
\programming\...\Clay Cowgill <br />
 <br />
 were done by Clay Cowgill <br />
 <br />
 <br />
I have not found any copyright notice or licence file, but the source files are/were freely available.     <br />
  His homepage can be found at (no vectrex stuff though):<br />
<a target="_blank" href="http://www.multigame.com">http://www.multigame.com</a><br />
    <br />
<b>Code by Garry</b><br />
-------------<br />
The assembler sources in directories under:<br />
\programming\...\Garry <br />
 <br />
 were done by Garry <br />
 <br />
 <br />
 I have not found any copyright notice or licence file, but the source files are/were freely available.   <br />
  The homepage can be found at:<br />
<a target="_blank" href="http://garrysgamingblog.blogspot.de/p/programming-projects.html">http://garrysgamingblog.blogspot.de/p/programming-projects.html</a><br />
  <br />
<b>Code by Tomsoft</b><br />
---------------<br />
The assembler sources in directories under:<br />
\programming\...\Tomsoft <br />
 <br />
 were done by Tomsoft <br />
 <br />
 <br />
 I have not found any copyright notice or licence file, but the source files are/were freely available.   <br />
  The homepage can be found at:<br />
<a target="_blank" href="http://landspurg.net/tomsoft/Vectrex.html">http://landspurg.net/tomsoft/Vectrex.html</a><br />
</tt></p>
<hr />
<h1>Other: Further used code...</h1>

<p><tt> "jetphones.inc"<br />
--------------<br />
Found on the internet, a file consisting of assembler definitions for use with the VecVox+ (AtariVox), done by B. Watson. </tt></p>

<p><tt> NRL Report 7948<br />
---------------<br />
AUTOMATIC TRANSLATION OF ENGLISH TEXT TO PHONETICS<br />
BY MEANS OF LETTER-TO-SOUND RULES<br />
<br />
My implementation is based on the code found in the file: "Avox&nbsp;text2speech2.zip" by a guy called "batari" in the forums of <a target="_blank" href="http://atariage.com/forums/index.php">http://atariage.com/forums/index.php</a>, "Speak To Me".</tt></p>

<p><tt> Book: Computer Graphics for Java Programmers<br />
--------------------------------------------<br />
By Leen Ammeraal and Kan Zhang<br />
<br />
The discussed algorithms were used to implement hidden line removal to vecci.</tt></p>
</body>
</html>
